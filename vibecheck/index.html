<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Check - English For Cool Dudes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #F3F4F6; min-height: 100vh; display: flex; flex-direction: column; align-items: center; margin: 0;
        }
        /* --- HEADER RESTORED --- */
        .site-header {
            width: 100%; background: #FFFFFF; border-bottom: 1px solid #E2E8F0;
            padding: 12px 20px; display: flex; align-items: center; gap: 12px; z-index: 100;
        }
        .logo-box { width: 32px; height: 32px; background: linear-gradient(135deg, #0EA5E9 0%, #8B5CF6 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; }
        
        /* --- PHONE STYLING --- */
        .phone-mockup {
            width: 100%; max-width: 400px; height: 85vh; background: #FFFFFF; 
            display: flex; flex-direction: column; position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2); overflow: hidden; margin: 20px 0; border: 8px solid #1F2937; border-radius: 35px;
        }
        .chat-area {
            flex: 1; background: #E5E5F7; 
            background-image: radial-gradient(#444cf7 0.5px, transparent 0.5px), radial-gradient(#444cf7 0.5px, #e5e5f7 0.5px);
            background-size: 20px 20px; background-position: 0 0, 10px 10px;
            padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px;
        }
        .message { max-width: 80%; padding: 12px 16px; border-radius: 20px; font-size: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); animation: pop 0.3s ease-out; }
        .msg-npc { align-self: flex-start; background: white; color: #1F2937; border-bottom-left-radius: 4px; }
        .msg-user { align-self: flex-end; background: #3B82F6; color: white; border-bottom-right-radius: 4px; }
        
        /* --- TYPING INDICATOR --- */
        .typing { font-style: italic; font-size: 12px; color: #6B7280; margin-bottom: 10px; display: none; }

        .choices-container { padding: 15px; background: white; border-top: 1px solid #E5E7EB; display: flex; flex-direction: column; gap: 8px; }
        .choice-btn { 
            background: #F3F4F6; border: 1px solid #E5E7EB; padding: 12px; border-radius: 12px; 
            font-size: 14px; text-align: left; transition: all 0.2s; cursor: pointer; font-weight: 500;
        }
        .choice-btn:hover { background: #DBEAFE; border-color: #3B82F6; transform: translateX(5px); }

        .vibe-bg { width: 70px; height: 8px; background: #E5E7EB; border-radius: 10px; overflow: hidden; }
        .vibe-fill { height: 100%; background: #10B981; width: 50%; transition: width 0.5s; }

        #menu-overlay, #end-overlay { position: absolute; inset: 0; background: #111827; z-index: 200; color: white; padding: 30px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .start-btn { background: white; color: #111827; width: 100%; padding: 15px; border-radius: 15px; font-weight: 800; margin-top: 10px; }
        
        @keyframes pop { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

    <header class="site-header">
        <div class="logo-box">E</div>
        <span class="font-bold text-slate-800 tracking-tight">English For Cool Dudes</span>
    </header>

    <div class="phone-mockup">
        <div class="p-4 border-b flex items-center justify-between bg-white">
            <div class="flex items-center gap-3">
                <div id="npc-avatar" class="text-2xl bg-gray-100 p-2 rounded-full">üëî</div>
                <div>
                    <div id="npc-name" class="font-bold text-sm">Loading...</div>
                    <div class="text-[10px] text-green-500 font-bold">‚óè Online</div>
                </div>
            </div>
            <div class="flex flex-col items-end">
                <span class="text-[10px] font-bold text-gray-400 mb-1">VIBE</span>
                <div class="vibe-bg"><div id="vibe-fill" class="vibe-fill"></div></div>
            </div>
        </div>

        <div class="chat-area" id="chat-area"></div>
        <div id="typing-indicator" class="px-5 pb-2 text-xs text-gray-400 italic">... is typing</div>
        <div class="choices-container" id="choices-area"></div>

        <div id="menu-overlay">
            <h1 class="text-4xl font-black mb-4 uppercase italic">Vibe Check</h1>
            <p class="text-gray-400 text-sm mb-8 leading-relaxed">
                Master real-world English. Choose the best response to keep the conversation alive. Don't be "mid"!
            </p>
            <button class="start-btn" onclick="init('business')">üëî BUSINESS ENGLISH</button>
            <button class="start-btn" onclick="init('dating')">ü•Ç SOCIAL & DATING</button>
            <button class="start-btn" onclick="init('casual')">üõπ CASUAL VIBES</button>
        </div>

        <div id="end-overlay" style="display:none">
            <div id="end-emoji" class="text-6xl mb-4"></div>
            <h2 id="end-title" class="text-3xl font-black mb-2"></h2>
            <p id="end-body" class="mb-8 text-gray-400"></p>
            <button class="start-btn" onclick="location.reload()">TRY AGAIN</button>
        </div>
    </div>

    <script>
        const scenarios = {
            business: [
                {
                    name: "Mr. Sterling", avatar: "üëî",
                    nodes: {
                        1: { text: "The presentation is in 20 minutes and you haven't sent me the slides. What's going on?", options: [
                            { text: "My apologies. I'm just doing a final proofread. Sending them now.", vibe: 20, next: 2 },
                            { text: "Sorry! I got distracted by a phone call. Sending them in 5 mins.", vibe: 0, next: 2 },
                            { text: "I'm still working on them. Can we push the meeting back?", vibe: -40, next: "fail" }
                        ]},
                        2: { text: "Fine. Make sure there are no typos. Remember the 'hare/hear' disaster last time?", options: [
                            { text: "I've double-checked everything. It won't happen again.", vibe: 20, next: 3 },
                            { text: "Don't worry, I used spell-check this time! lol", vibe: -10, next: 3 },
                            { text: "Mistakes happen. We are only human, right?", vibe: -30, next: 3 }
                        ]},
                        3: { text: "Well, let's hope so. Are you ready to lead the Q&A session?", options: [
                            { text: "I'm fully prepared to handle any questions.", vibe: 20, next: "win" },
                            { text: "I'll give it my best shot!", vibe: 10, next: "win" },
                            { text: "Actually, I'm feeling a bit sick. Can you do it?", vibe: -50, next: "fail" }
                        ]},
                        "win": { text: "Good luck. Don't let me down.", end: true, win: true },
                        "fail": { text: "This is unprofessional. I'll find someone else to take over your accounts.", end: true, win: false }
                    }
                }
            ],
            dating: [
                {
                    name: "Sarah", avatar: "üåπ",
                    nodes: {
                        1: { text: "Hey! I had a great time at the coffee shop today. You're easy to talk to. üòä", options: [
                            { text: "Same here! I really enjoyed our conversation about travel.", vibe: 20, next: 2 },
                            { text: "Thanks! I'm usually the life of the party.", vibe: 5, next: 2 },
                            { text: "Cool. Glad you liked it.", vibe: -20, next: 2 }
                        ]},
                        2: { text: "So... what are your plans for Friday? I heard that new Italian place is amazing.", options: [
                            { text: "I'd love to take you there. Does 7 PM work for you?", vibe: 25, next: "win" },
                            { text: "Italian is okay, but I prefer Sushi. Want to do that instead?", vibe: 10, next: "win" },
                            { text: "I'm actually playing poker with the boys on Friday.", vibe: -40, next: "fail" }
                        ]},
                        "win": { text: "It's a date! Can't wait. ‚ú®", end: true, win: true },
                        "fail": { text: "Oh, okay. Have fun with your friends. See ya.", end: true, win: false }
                    }
                }
            ],
            casual: [
                {
                    name: "Lisa", avatar: "üõπ",
                    nodes: {
                        1: { text: "Yo! This weekend is gonna be boring unless we do something epic.", options: [
                            { text: "For real! I'm down for whatever. What's the plan?", vibe: 20, next: 2 },
                            { text: "I agree. We should definitely go out somewhere.", vibe: 10, next: 2 },
                            { text: "I'm actually quite happy staying at home.", vibe: -30, next: 2 }
                        ]},
                        2: { text: "Should we hit the beach or go for a hike in the mountains?", options: [
                            { text: "Let's go to the beach! I need a tan. üèñÔ∏è", vibe: 15, next: 3 },
                            { text: "Hiking sounds sick. Let's get some fresh air. üèîÔ∏è", vibe: 15, next: "3_mtn" },
                            { text: "I don't mind. Whatever you want to do.", vibe: 0, next: 3 }
                        ]},
                        3: { text: "Beach it is! I'll bring the music. Can you drive?", options: [
                            { text: "Count me in. I'll pick you up at 9!", vibe: 20, next: "win" },
                            { text: "Sure, but you're paying for the snacks!", vibe: 10, next: "win" },
                            { text: "My car is in the shop. Can we take the bus?", vibe: -10, next: "win" }
                        ]},
                        "3_mtn": { text: "Mountains! I'll pack the trail mix. Wear good shoes!", options: [
                            { text: "I'm already wearing my boots. Let's move!", vibe: 20, next: "win" },
                            { text: "I hope it's not too steep, I'm out of shape.", vibe: 5, next: "win" },
                            { text: "Actually, I changed my mind. It looks like rain.", vibe: -40, next: "fail" }
                        ]},
                        "win": { text: "Sick! See you tomorrow! üî•", end: true, win: true },
                        "fail": { text: "You're such a flake. Forget it.", end: true, win: false }
                    }
                }
            ]
        };

        let active = null;
        let nodeKey = 1;
        let vibeVal = 50;

        function init(cat) {
            const list = scenarios[cat];
            active = list[Math.floor(Math.random() * list.length)];
            document.getElementById('menu-overlay').style.display = 'none';
            document.getElementById('npc-name').innerText = active.name;
            document.getElementById('npc-avatar').innerText = active.avatar;
            vibeVal = 50; nodeKey = 1;
            document.getElementById('chat-area').innerHTML = '';
            refresh();
        }

        function refresh() {
            const node = active.nodes[nodeKey];
            const indicator = document.getElementById('typing-indicator');
            const choices = document.getElementById('choices-area');
            
            choices.innerHTML = '';
            indicator.style.display = 'block';

            setTimeout(() => {
                indicator.style.display = 'none';
                post(node.text, 'npc');
                
                if (node.end) {
                    setTimeout(() => finish(node.win), 1200);
                    return;
                }

                node.options.forEach(o => {
                    const btn = document.createElement('button');
                    btn.className = 'choice-btn';
                    btn.innerText = o.text;
                    btn.onclick = () => {
                        choices.innerHTML = '';
                        post(o.text, 'user');
                        vibeVal += o.vibe;
                        if (vibeVal > 100) vibeVal = 100;
                        document.getElementById('vibe-fill').style.width = vibeVal + '%';
                        
                        if (vibeVal <= 0) return finish(false);
                        nodeKey = o.next;
                        setTimeout(refresh, 1000);
                    };
                    choices.appendChild(btn);
                });
            }, 1200);
        }

        function post(t, who) {
            const d = document.createElement('div');
            d.className = `message msg-${who}`;
            d.innerText = t;
            const c = document.getElementById('chat-area');
            c.appendChild(d);
            c.scrollTop = c.scrollHeight;
        }

        function finish(win) {
            const overlay = document.getElementById('end-overlay');
            overlay.style.display = 'flex';
            document.getElementById('end-emoji').innerText = win ? "üî•" : "üíÄ";
            document.getElementById('end-title').innerText = win ? "VIBE PASSED" : "VIBE KILLED";
            document.getElementById('end-body').innerText = win ? "You're a legend. You handled that perfectly." : "Ouch. That was awkward. Better luck next time!";
        }
    </script>
</body>
</html>
