<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dutch Herring: Interactive English Lesson (Cool Dudes Edition)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        /* --- BRANDING & LAYOUT STYLES (From nordictaxv8.html) --- */
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap');
        :root {
            /* Professional Blue/Green palette for Economics/Tax */
            --color-primary: #1A5E7F; /* Deep Blue */
            --color-secondary: #28A745; /* Success Green/Teal */
            --color-accent: #FFC107; /* Amber/Highlight (for selection) */
            --color-background: #F8F9FB; /* Light Gray-Blue */
            --color-text: #2C3E50; /* Dark Blue-Gray */
        }
        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: 1.6;
        }
        /* --- BRANDED HEADER (English For Cool Dudes) --- */
        .header {
            background: #FFFFFF;
            border-bottom: 1px solid #E5E9F2;
            padding: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        }
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            color: #2C3E50;
        }
        .logo {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #FFC107 0%, #FF9800 100%); /* Orange/Amber for 'Cool Dudes' */
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 900;
        }
        .site-title {
            font-size: 20px;
            font-weight: 900;
            color: #1A202C;
            letter-spacing: -0.02em;
        }
        .container-main {
            max-width: 900px;
            margin: 30px auto;
            padding: 30px 20px;
            background-color: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #E5E9F2;
        }
        .lesson-section {
            background-color: #F8F9FB;
            padding: 30px;
            border-radius: 10px;
            border: 1px solid #E5E9F2;
            margin-bottom: 2rem;
        }
        .section-title {
            color: var(--color-primary);
            font-size: 1.8em;
            font-weight: 800;
            margin-bottom: 20px;
            padding-bottom: 5px;
            border-bottom: 2px dashed #E5E9F2;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .section-number {
            background: var(--color-primary);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            font-weight: 900;
        }

        /* --- Content/Activity Styles (Tailwind Adaptations) --- */
        .reading-text, .grammar-box {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #E5E9F2;
        }
        .reading-text p {
            margin-bottom: 15px;
            text-align: justify;
        }
        .discussion-questions li {
            margin: 10px 0;
            font-size: 1.1em;
            line-height: 1.6;
            padding-left: 10px;
            list-style: disc;
            color: var(--color-primary);
        }
        .discussion-questions {
            padding-left: 20px;
        }
        .question-box {
            background: #ffffff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid var(--color-primary);
            transition: all 0.2s;
        }
        .question-box label {
            display: block;
            padding: 8px 0;
            cursor: pointer;
        }
        .question-box.correct {
            background: #e6ffe6;
            border-left-color: var(--color-secondary);
        }
        .question-box.incorrect {
            background: #ffe6e6;
            border-left-color: #E74C3C;
        }
        /* Matching Styles (from nordictaxv8.html) */
        .matching-item, .matching-target {
            padding: 0.75rem 1rem;
            margin: 0.5rem 0;
            cursor: pointer;
            border-radius: 0.375rem;
            transition: all 0.2s;
            border: 2px solid #E0E0E0;
            font-weight: 600;
            user-select: none;
        }
        .matching-item { background-color: #f0f8ff; border-left: 5px solid var(--color-primary); }
        .matching-target { background-color: #f7fff5; border-right: 5px solid var(--color-secondary); text-align: left; }
        .selected-item, .selected-target { 
            box-shadow: 0 0 0 3px var(--color-accent); 
            transform: translateY(-2px); 
            border-color: var(--color-accent) !important; 
        }
        .incorrect-flash {
            animation: flash-red 0.5s;
            background-color: #ffe6e6 !important; 
            border: 2px solid #E74C3C !important; 
            box-shadow: 0 0 0 3px #E74C3C !important; 
            color: #c0392b !important; 
        }
        @keyframes flash-red {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        /* Fixed Matching Colors for correct pairs */
        .matched { pointer-events: none; opacity: 0.8; }
        /* Color Set 0: Purple/Lavender */
        .matched-color-0 { background-color: #e9d5ff !important; color: #5B21B6 !important; border-color: #a855f7 !important; }
        .matched-color-0.matching-item { border-left: 5px solid #a855f7 !important; border-right: 2px solid #a855f7 !important; }
        .matched-color-0.matching-target { border-right: 5px solid #a855f7 !important; border-left: 2px solid #a855f7 !important; }
        /* Color Set 1: Teal/Mint */
        .matched-color-1 { background-color: #ccfbf1 !important; color: #0f766e !important; border-color: #14b8a6 !important; }
        .matched-color-1.matching-item { border-left: 5px solid #14b8a6 !important; border-right: 2px solid #14b8a6 !important; }
        .matched-color-1.matching-target { border-right: 5px solid #14b8a6 !important; border-left: 2px solid #14b8a6 !important; }
        /* Color Set 2: Blue/Indigo */
        .matched-color-2 { background-color: #e0e7ff !important; color: #3730a3 !important; border-color: #4f46e5 !important; }
        .matched-color-2.matching-item { border-left: 5px solid #4f46e5 !important; border-right: 2px solid #4f46e5 !important; }
        .matched-color-2.matching-target { border-right: 5px solid #4f46e5 !important; border-left: 2px solid #4f46e5 !important; }
        /* Color Set 3: Rose/Pink */
        .matched-color-3 { background-color: #fce7f3 !important; color: #9d174d !important; border-color: #ec4899 !important; }
        .matched-color-3.matching-item { border-left: 5px solid #ec4899 !important; border-right: 2px solid #ec4899 !important; }
        .matched-color-3.matching-target { border-right: 5px solid #ec4899 !important; border-left: 2px solid #ec4899 !important; }
        /* Color Set 4: Amber/Yellow */
        .matched-color-4 { background-color: #fffbeb !important; color: #b45309 !important; border-color: #f59e0b !important; }
        .matched-color-4.matching-item { border-left: 5px solid #f59e0b !important; border-right: 2px solid #f59e0b !important; }
        .matched-color-4.matching-target { border-right: 5px solid #f59e0b !important; border-left: 2px solid #f59e0b !important; }

        /* True/False Styles */
        .true-false-item {
            background: #ffffff;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 2px solid #E5E9F2; /* Base border */
            transition: all 0.3s;
        }
        .tf-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .tf-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 700;
        }
        .tf-btn.true-btn { background: #e6ffe6; color: var(--color-secondary); border: 1px solid #d1ffd1; }
        .tf-btn.false-btn { background: #ffe6e6; color: #E74C3C; border: 1px solid #ffd1d1; }
        .tf-btn.selected { box-shadow: 0 0 0 3px var(--color-accent); }
        
        /* UPDATED STYLES FOR GREEN/RED OUTLINE */
        .true-false-item.correct { 
            background: #f0fff0; 
            border: 4px solid var(--color-secondary); /* GREEN OUTLINE */
        }
        .true-false-item.incorrect { 
            background: #fff0f0; 
            border: 4px solid #E74C3C; /* RED OUTLINE */
        }
        /* END UPDATED STYLES */

        /* Gap-Fill Styles */
        .wordbank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: #eef2f5;
            border-radius: 8px;
            border: 1px dashed #ced4da;
        }
        .word-chip {
            padding: 8px 15px;
            background: var(--color-primary);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            user-select: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .word-chip:hover:not(.used) { transform: scale(1.05); }
        .word-chip.used { background: #ccc; cursor: not-allowed; opacity: 0.5; }
        .word-chip.selected-word {
            background: var(--color-accent) !important;
            color: var(--color-text) !important;
            box-shadow: 0 0 0 3px var(--color-primary);
            transform: scale(1.1);
        }
        .gap-fill-text {
            line-height: 2.2;
            font-size: 1.1em;
        }
        .gap {
            display: inline-block;
            min-width: 120px;
            padding: 5px 10px;
            border-bottom: 2px solid var(--color-primary);
            margin: 0 5px;
            cursor: pointer;
            background: #f0f4f7;
            border-radius: 5px;
            transition: all 0.2s;
            user-select: none;
            text-align: center;
            font-weight: 600;
            color: var(--color-text);
        }
        .gap:hover:not(.filled) { background: #e5ebf0; }
        .gap.filled { background: #fffbeb; cursor: pointer; }
        .gap.correct-gap { background: #e6ffe6; border-bottom-color: var(--color-secondary); }
        .gap.incorrect-gap { background: #ffe6e6; border-bottom-color: #E74C3C; }

        /* Grammar & Word Formation Inputs */
        .grammar-box, .word-formation-item { background-color: #f7fff5; border: 1px solid var(--color-secondary); padding: 20px; border-radius: 8px; margin-bottom: 15px; }
        .grammar-box { border-left: 4px solid var(--color-secondary); }
        .word-formation-item input {
            width: 250px;
            padding: 8px;
            border: none;
            border-bottom: 2px solid var(--color-primary);
            background: #f8f9fb;
            border-radius: 4px 4px 0 0;
            font-size: 1em;
            transition: all 0.2s;
            outline: none;
            margin-top: 5px;
        }
        .word-formation-item input:focus { border-bottom-color: var(--color-accent); background: white; }

        /* General UI */
        .btn {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            box-shadow: 0 4px 10px rgba(26, 94, 127, 0.3);
        }
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(26, 94, 127, 0.4);
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .grammar-examples { padding-top: 15px; }
        .grammar-examples .question-box {
            border-left: 4px solid #FFC107;
        }
    </style>
</head>
<body class="p-4">
    <div class="header">
        <a href="advanced.html" class="header-content">
            <div class="logo">ðŸ˜Ž</div>
            <div class="site-title">English For Cool Dudes</div>
        </a>
    </div>
    <div class="container-main">
        <h1 class="text-3xl font-extrabold mb-8 text-center text-gray-800">Dutch Herring: A National Delight</h1>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">1</div><span>Warm-up Discussion</span></h2>
            <div class="discussion-questions">
                <ul>
                    <li>Have you ever tried traditional Dutch herring (haring)? If so, what did you think of the taste?</li>
                    <li>What is a famous or traditional food from your country that might seem unusual to foreigners?</li>
                    <li>Do you think food traditions are an important part of national culture? Why or why why not?</li>
                </ul>
            </div>
        </div>
        
        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">2</div><span>Vocabulary Matching Game</span></h2>
            <p style="margin-bottom: 20px;">Match the words with their definitions by clicking on them:</p>
            <div id="vocab-match-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                <div id="vocab-column-words" class="flex flex-col vocab-column">
                    <h3>Words</h3>
                    <div class="matching-item" data-match-id="1">monger</div>
                    <div class="matching-item" data-match-id="2">dorsal</div>
                    <div class="matching-item" data-match-id="3">buzzing</div>
                    <div class="matching-item" data-match-id="4">squeamish</div>
                    <div class="matching-item" data-match-id="5">cured</div>
                    <div class="matching-item" data-match-id="6">renowned</div>
                    <div class="matching-item" data-match-id="7">hooked</div>
                    <div class="matching-item" data-match-id="8">booze</div>
                </div>
                <div id="vocab-column-meanings" class="flex flex-col vocab-column">
                    <h3>Definitions</h3>
                    <div class="matching-target" data-match-id="7">addicted to something</div>
                    <div class="matching-target" data-match-id="6">famous and respected</div>
                    <div class="matching-target" data-match-id="8">alcoholic drinks (informal)</div>
                    <div class="matching-target" data-match-id="2">relating to the back or upper side</div>
                    <div class="matching-target" data-match-id="1">a person who sells a specific type of goods</div>
                    <div class="matching-target" data-match-id="3">full of activity and excitement</div>
                    <div class="matching-target" data-match-id="5">preserved with salt or smoke</div>
                    <div class="matching-target" data-match-id="4">easily disgusted or nauseated</div>
                </div>
            </div>
            <div id="vocabFeedback" class="mt-4"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">3</div><span>Reading: The Story of Dutch Herring</span></h2>
            <div class="reading-text">
                <p>Herring is not just a fish in the Netherlandsâ€”it's a cultural icon. Every year in mid-June, the Dutch celebrate the arrival of "nieuwe haring" (new herring), marking what locals call the "fifth season." This tradition has been part of Dutch culture for centuries.</p>
                
                <p>Jack, a fishmonger who **has worked** at his father-in-law's fish shop for around 25 years, starts every day with a herring breakfast. "I **have been** everywhere, in the best hotels in the world," he says. "Breakfast is always great, but everywhere I miss my herring!"</p>
                
                <p>The preparation of herring is an art form. After being caught, the fish is **cured** in salt for a few days. Then comes the cleaning process: removing the guts, **dorsal** fins, skin, head, and bones. Jack and his team clean about 500 fish a day. According to Jack, the best way to eat herring is "**fresh from the knife**"â€”**immediately** after it's been cleaned.</p>
                
                <p>The Dutch have strong opinions about how to enjoy their herring. Purists eat the first herrings of the season without pickles or onions because they want to taste the pure flavor. Later in the year, when the fish becomes stronger, people add pickles and onions to enhance the taste. Some fans believe herring has hangover-curing properties and even makes you smarter, though these claims are not scientifically proven!</p>
                
                <p>Herring is traditionally paired with jenever (Dutch gin) or corenwyn, an aged gin stored in oak barrels. Even Queen Beatrix was **renowned** to be a fan. While herring faces **competition** from other Dutch street foods like kip (broiled chicken), frikandel, poffertjes (little pancakes), and stroopwafels, it remains the undisputed champion of Dutch street food culture.</p>
            </div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">4</div><span>Reading Comprehension</span></h2>
            <div class="question-box" data-question="1" data-correct-value="b">
                <strong>1. What is the "fifth season" in the Netherlands?</strong>
                <label><input type="radio" name="q1" value="a"> A. Spring</label>
                <label><input type="radio" name="q1" value="b"> B. The arrival of new herring in mid-June</label>
                <label><input type="radio" name="q1" value="c"> C. Christmas time</label>
                <label><input type="radio" name="q1" value="d"> D. Autumn harvest</label>
            </div>

            <div class="question-box" data-question="2" data-correct-value="a">
                <strong>2. How long has Jack worked at the fish shop?</strong>
                <label><input type="radio" name="q2" value="a"> A. Around 25 years</label>
                <label><input type="radio" name="q2" value="b"> B. Around 15 years</label>
                <label><input type="radio" name="q2" value="c"> C. 10 years</label>
                <label><input type="radio" name="q2" value="d"> D. 30 years</label>
            </div>

            <div class="question-box" data-question="3" data-correct-value="c">
                <strong>3. According to Jack, when is the best time to eat herring?</strong>
                <label><input type="radio" name="q3" value="a"> A. After it's been frozen</label>
                <label><input type="radio" name="q3" value="b"> B. The next day</label>
                <label><input type="radio" name="q3" value="c"> C. Fresh from the knife, right after cleaning</label>
                <label><input type="radio" name="q3" value="d"> D. After marinating overnight</label>
            </div>

            <div class="question-box" data-question="4" data-correct-value="c">
                <strong>4. Why do people add pickles and onions later in the year?</strong>
                <label><input type="radio" name="q4" value="a"> A. Because they're cheaper</label>
                <label><input type="radio" name="q4" value="b"> B. It's a traditional recipe</label>
                <label><input type="radio" name="q4" value="c"> C. To enhance the taste when the fish becomes stronger</label>
                <label><input type="radio" name="q4" value="d"> D. To preserve the fish longer</label>
            </div>
            <button onclick="checkMultipleChoice('comprehension-result', 'q')" class="btn">Check Answers</button>
            <div id="comprehension-result" class="feedback mt-4 hidden"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">5</div><span>Watch the Video</span></h2>
            <div class="video-container">
                <iframe width="560" height="315" src="https://www.youtube.com/embed/amQXvSTtfOo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">6</div><span>Video Comprehension: True or False</span></h2>
            <div id="tf-activity">
                <div id="tf-1" class="true-false-item" data-answer="T">
                    <p><strong>1. Jack's father-in-law started the fish shop.</strong></p>
                    <div class="tf-buttons">
                        <button class="tf-btn true-btn" data-value="T">TRUE</button>
                        <button class="tf-btn false-btn" data-value="F">FALSE</button>
                    </div>
                </div>
                <div id="tf-2" class="true-false-item" data-answer="F">
                    <p><strong>2. Herring season begins in December.</strong></p>
                    <div class="tf-buttons">
                        <button class="tf-btn true-btn" data-value="T">TRUE</button>
                        <button class="tf-btn false-btn" data-value="F">FALSE</button>
                    </div>
                </div>
                <div id="tf-3" class="true-false-item" data-answer="T">
                    <p><strong>3. Jack cleans about 500 fish a day.</strong></p>
                    <div class="tf-buttons">
                        <button class="tf-btn true-btn" data-value="T">TRUE</button>
                        <button class="tf-btn false-btn" data-value="F">FALSE</button>
                    </div>
                </div>
                <div id="tf-4" class="true-false-item" data-answer="F">
                    <p><strong>4. Herring is typically eaten with a fork and knife.</strong></p>
                    <div class="tf-buttons">
                        <button class="tf-btn true-btn" data-value="T">TRUE</button>
                        <button class="tf-btn false-btn" data-value="F">FALSE</button>
                    </div>
                </div>
                <div id="tf-5" class="true-false-item" data-answer="T">
                    <p><strong>5. Queen Beatrix was known to enjoy herring.</strong></p>
                    <div class="tf-buttons">
                        <button class="tf-btn true-btn" data-value="T">TRUE</button>
                        <button class="tf-btn false-btn" data-value="F">FALSE</button>
                    </div>
                </div>
            </div>
            <button onclick="checkTrueFalse()" class="btn">Check Answers</button>
            <div id="tf-result" class="feedback mt-4 hidden"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">7</div><span>Gap Fill Activity</span></h2>
            <p style="margin-bottom: 10px;"><strong>Instructions:</strong> Click on a word from the word bank, then click on a gap to fill it:</p>
            <div id="word-bank" class="wordbank">
                <button class="word-chip" data-word="celebrated">celebrated</button>
                <button class="word-chip" data-word="preparation">preparation</button>
                <button class="word-chip" data-word="traditional">traditional</button>
                <button class="word-chip" data-word="immediately">immediately</button>
                <button class="word-chip" data-word="preserved">preserved</button>
                <button class="word-chip" data-word="competition">competition</button>
                <button class="word-chip" data-word="accompanied">accompanied</button>
                <button class="word-chip" data-word="cultural">cultural</button>
            </div>
            <div class="gap-fill-text">
                This <span class="gap" data-answer="traditional" data-gap-index="0"></span> Dutch food is <span class="gap" data-answer="preserved" data-gap-index="1"></span> in salt and its annual arrival is <span class="gap" data-answer="celebrated" data-gap-index="2"></span> in June. The correct <span class="gap" data-answer="preparation" data-gap-index="3"></span> is done <span class="gap" data-answer="immediately" data-gap-index="4"></span> after the fish is caught. It is a major <span class="gap" data-answer="cultural" data-gap-index="5"></span> event, often <span class="gap" data-answer="accompanied" data-gap-index="6"></span> by gin, despite the <span class="gap" data-answer="competition" data-gap-index="7"></span> from street food like fries.
            </div>
            <button onclick="checkGapFill()" class="btn">Check Answers</button>
            <div id="gap-result" class="feedback mt-4 hidden"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">8</div><span>Grammar: Past Simple vs. Present Perfect</span></h2>
            <div class="grammar-box">
                <h3>ðŸ“š Quick Explanation:</h3>
                <p><strong>Present Perfect:</strong> We use it for experiences, actions that started in the past and continue now, or recent actions with present relevance.</p>
                <p><strong>Formula:</strong> have/has + past participle</p>
                <p><strong>Example from the reading:</strong> "Jack **has worked** at his father-in-law's fish shop for around 25 years."</p>
                
                <p style="margin-top: 15px;"><strong>Past Simple:</strong> We use it for completed actions at a specific time in the past.</p>
                <p><strong>Formula:</strong> verb + -ed (regular) or irregular form</p>
                <p><strong>Example:</strong> "We **ate** six herrings when we visited Amsterdam **last year**."</p>
            </div>

            <div class="grammar-examples">
                <h3>Choose the correct form:</h3>
                
                <div class="question-box" data-question="g1" data-correct-value="b">
                    <p><strong>1. Jack __________ (work) at the fish shop for 25 years.</strong></p>
                    <label><input type="radio" name="g1" value="a"> A. worked</label>
                    <label><input type="radio" name="g1" value="b"> B. has worked</label>
                </div>

                <div class="question-box" data-question="g2" data-correct-value="a">
                    <p><strong>2. We __________ (eat) six herrings when we visited last year.</strong></p>
                    <label><input type="radio" name="g2" value="a"> A. ate</label>
                    <label><input type="radio" name="g2" value="b"> B. have eaten</label>
                </div>

                <div class="question-box" data-question="g3" data-correct-value="b">
                    <p><strong>3. I __________ (never try) raw fish before.</strong></p>
                    <label><input type="radio" name="g3" value="a"> A. never tried</label>
                    <label><input type="radio" name="g3" value="b"> B. have never tried</label>
                </div>

                <div class="question-box" data-question="g4" data-correct-value="a">
                    <p><strong>4. The herring season __________ (begin) in mid-June last year.</strong></p>
                    <label><input type="radio" name="g4" value="a"> A. began</label>
                    <label><input type="radio" name="g4" value="b"> B. has begun</label>
                </div>
            </div>
            <button class="btn" onclick="checkMultipleChoice('grammar-result', 'g')">Check Grammar</button>
            <div id="grammar-result" class="feedback mt-4 hidden"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">9</div><span>Word Formation</span></h2>
            <p>Change the form of the word in brackets where necessary to complete each sentence:</p>
            <div class="word-formation-item">
                <p><strong>1. Herring is a __________ (TRADITION) Dutch street food.</strong></p>
                <input type="text" id="wf1" data-answer="traditional" placeholder="e.g., traditional">
            </div>

            <div class="word-formation-item">
                <p><strong>2. The __________ (PREPARE) of herring requires skill and experience.</strong></p>
                <input type="text" id="wf2" data-answer="preparation" placeholder="e.g., preparation">
            </div>

            <div class="word-formation-item">
                <p><strong>3. Many tourists are __________ (SURPRISE) by the taste of raw herring.</strong></p>
                <input type="text" id="wf3" data-answer="surprised" placeholder="e.g., surprised">
            </div>

            <div class="word-formation-item">
                <p><strong>4. The fish monger works __________ (EFFICIENT) to clean 500 fish daily.</strong></p>
                <input type="text" id="wf4" data-answer="efficiently" placeholder="e.g., efficiently">
            </div>

            <div class="word-formation-item">
                <p><strong>5. Herring is known for its __________ (HEALTH) benefits.</strong></p>
                <input type="text" id="wf5" data-answer="health" placeholder="e.g., health">
            </div>

            <div class="word-formation-item">
                <p><strong>6. The __________ (ARRIVE) of nieuwe haring is celebrated every June.</strong></p>
                <input type="text" id="wf6" data-answer="arrival" placeholder="e.g., arrival">
            </div>
            <button class="btn" onclick="checkWordFormation()">Check Answers</button>
            <div id="wordFormationFeedback" class="feedback mt-4 hidden"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">10</div><span>Food Idioms Match</span></h2>
            <div id="idiom-match-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                <div id="idiom-column-words" class="flex flex-col idiom-column">
                    <h3>Idioms</h3>
                    <div class="matching-item" data-match-id="1">There are plenty more fish in the sea</div>
                    <div class="matching-item" data-match-id="2">A piece of cake</div>
                    <div class="matching-item" data-match-id="3">Take it with a pinch of salt</div>
                    <div class="matching-item" data-match-id="4">In a pickle</div>
                    <div class="matching-item" data-match-id="5">Bread and butter</div>
                </div>
                <div id="idiom-column-meanings" class="flex flex-col idiom-column">
                    <h3>Meanings</h3>
                    <div class="matching-target" data-match-id="2">Something very easy to do</div>
                    <div class="matching-target" data-match-id="5">Basic income or livelihood</div>
                    <div class="matching-target" data-match-id="4">In a difficult situation</div>
                    <div class="matching-target" data-match-id="1">There are other opportunities available</div>
                    <div class="matching-target" data-match-id="3">Don't believe everything completely</div>
                </div>
            </div>
            <div id="idiomFeedback" class="mt-4"></div>
        </div>

        <div class="lesson-section">
            <h2 class="section-title"><div class="section-number">11</div><span>Writing Task (Not Graded)</span></h2>
            <p><strong>[Activity Placeholder]</strong> Write a short paragraph (100-150 words) describing a food tradition from your own country, using at least two of the new vocabulary words from Section 2.</p>
        </div>

    </div>
    
    <script>
        // --- Custom Matching Logic (Vocab and Idiom) ---
        const MATCH_COLORS = [0, 1, 2, 3, 4, 0, 1, 2]; // Color set indices for up to 8 pairs

        function initializeMatching(containerId, wordColumnId, meaningColumnId, feedbackId) {
            const wordElements = document.querySelectorAll(`#${wordColumnId} .matching-item`);
            const meaningElements = document.querySelectorAll(`#${meaningColumnId} .matching-target`);
            const feedbackDiv = document.getElementById(feedbackId);
            
            let selectedWord = null;
            let selectedMeaning = null;
            let matchCounter = 0;

            function updateFeedback(isCorrect, message) {
                feedbackDiv.innerHTML = `<div class="p-3 mt-2 rounded-lg text-sm font-semibold ${isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">${message}</div>`;
            }

            function handleMatchAttempt() {
                if (selectedWord && selectedMeaning) {
                    const wordId = selectedWord.getAttribute('data-match-id');
                    const meaningId = selectedMeaning.getAttribute('data-match-id');
                    
                    // Clear selections
                    selectedWord.classList.remove('selected-item');
                    selectedMeaning.classList.remove('selected-target');

                    if (wordId === meaningId) {
                        // Correct Match
                        const allWords = document.querySelectorAll(`#${wordColumnId} .matching-item`).length;
                        // Use a consistent color index regardless of the total count
                        const colorIndex = (matchCounter % MATCH_COLORS.length); 
                        const colorClass = `matched-color-${MATCH_COLORS[colorIndex]}`;
                        
                        selectedWord.classList.add('matched', colorClass);
                        selectedMeaning.classList.add('matched', colorClass);
                        
                        updateFeedback(true, 'ðŸŽ‰ Correct Match!');
                        matchCounter++;
                        
                        // Check if all matched
                        const matchedCount = document.querySelectorAll(`#${wordColumnId} .matching-item.matched`).length;

                        if (matchedCount === allWords) {
                            updateFeedback(true, 'âœ… Excellent! All pairs matched correctly!');
                        }
                    } else {
                        // Incorrect Match: Flash red and deselect
                        [selectedWord, selectedMeaning].forEach(el => {
                            el.classList.add('incorrect-flash');
                            setTimeout(() => el.classList.remove('incorrect-flash'), 500);
                        });
                        updateFeedback(false, 'âŒ Incorrect pairing. Try again! (The incorrect boxes have deselected)');
                    }
                    
                    selectedWord = null;
                    selectedMeaning = null;
                }
            }

            wordElements.forEach(el => {
                el.addEventListener('click', () => {
                    if (el.classList.contains('matched')) return;

                    if (selectedWord) selectedWord.classList.remove('selected-item');
                    if (selectedWord === el) {
                        selectedWord = null;
                    } else {
                        selectedWord = el;
                        selectedWord.classList.add('selected-item');
                        if (selectedMeaning) {
                            handleMatchAttempt();
                        }
                    }
                });
            });

            meaningElements.forEach(el => {
                el.addEventListener('click', () => {
                    if (el.classList.contains('matched')) return;
                    
                    if (selectedMeaning) selectedMeaning.classList.remove('selected-target');
                    if (selectedMeaning === el) {
                        selectedMeaning = null;
                    } else {
                        selectedMeaning = el;
                        selectedMeaning.classList.add('selected-target');
                        if (selectedWord) {
                            handleMatchAttempt();
                        }
                    }
                });
            });
        }

        // --- Utility Functions (Comprehension/T-F/Gap-Fill/Grammar) ---

        function checkMultipleChoice(resultId, namePrefix) {
            let correctCount = 0;
            // Select questions based on the name prefix (q for reading, g for grammar)
            const questions = document.querySelectorAll(`.question-box[data-question^="${namePrefix}"]`);
            
            questions.forEach(box => {
                box.classList.remove('correct', 'incorrect');
                const correctValue = box.getAttribute('data-correct-value');
                let isCorrect = false;

                // Iterate over radio buttons within the box
                box.querySelectorAll(`input[type="radio"][name^="${namePrefix}"]`).forEach(radio => {
                    const label = radio.parentElement;
                    label.style.backgroundColor = 'transparent'; // Reset option background

                    if (radio.checked) {
                        if (radio.value === correctValue) {
                            isCorrect = true;
                            label.style.backgroundColor = '#d1ffd1'; // Highlight correct selection
                        } else {
                            label.style.backgroundColor = '#ffd1d1'; // Highlight incorrect selection
                        }
                    } else if (radio.value === correctValue) {
                        // Highlight the correct answer if not selected
                        // label.style.backgroundColor = '#e6f0ff'; 
                    }
                });

                if (isCorrect) {
                    box.classList.add('correct');
                    correctCount++;
                } else if (box.querySelector(`input[name^="${namePrefix}"]:checked`)) {
                    box.classList.add('incorrect');
                } else {
                    // If unchecked, mark as incorrect to encourage answering
                    box.classList.add('incorrect');
                }
            });
            showResult(resultId, correctCount, questions.length);
        }

        function checkTrueFalse() {
            let correctCount = 0;
            const items = document.querySelectorAll('#tf-activity .true-false-item');
            items.forEach(item => {
                // Clear any previous correct/incorrect feedback classes
                item.classList.remove('correct', 'incorrect');
                const selected = item.querySelector('.tf-btn.selected');
                
                if (selected) {
                    const selectedValue = selected.getAttribute('data-value');
                    const isCorrect = selectedValue === item.getAttribute('data-answer');
                    if (isCorrect) {
                        item.classList.add('correct');
                        correctCount++;
                    } else {
                        item.classList.add('incorrect');
                    }
                } else {
                    // If no answer is selected, mark as incorrect
                    item.classList.add('incorrect');
                }
            });
            showResult('tf-result', correctCount, items.length);
        }
        
        // Global variable for Gap Fill management
        let currentlySelectedWord = null;

        function handleWordSelection(event) {
            if (event.target.classList.contains('word-chip') && !event.target.classList.contains('used')) {
                // Deselect previously selected word
                if (currentlySelectedWord) {
                    currentlySelectedWord.classList.remove('selected-word');
                }
                
                // Select new word
                currentlySelectedWord = event.target;
                currentlySelectedWord.classList.add('selected-word');
            }
        }

        function handleGapClick(event) {
            const gap = event.target;
            if (gap.classList.contains('gap') && currentlySelectedWord) {
                const word = currentlySelectedWord.getAttribute('data-word');
                
                // If the gap already has a word, return that word to the bank
                if (gap.dataset.selectedWord) {
                    const oldWordElement = document.querySelector(`.word-chip[data-word="${gap.dataset.selectedWord}"]`);
                    if (oldWordElement) {
                        oldWordElement.classList.remove('used');
                    }
                }
                
                // Place the new word
                gap.textContent = word;
                gap.dataset.selectedWord = word;
                gap.classList.add('filled');
                currentlySelectedWord.classList.add('used');
                currentlySelectedWord.classList.remove('selected-word');
                currentlySelectedWord = null;
            } else if (gap.classList.contains('gap') && gap.dataset.selectedWord) {
                // Click to remove word from gap
                const wordToRemove = gap.dataset.selectedWord;
                const wordElement = document.querySelector(`.word-chip[data-word="${wordToRemove}"]`);
                if (wordElement) {
                    wordElement.classList.remove('used');
                }
                gap.textContent = '';
                delete gap.dataset.selectedWord;
                gap.classList.remove('filled', 'correct-gap', 'incorrect-gap');
            }
        }

        function checkGapFill() {
            let correctCount = 0;
            const gaps = document.querySelectorAll('.gap');
            
            // Remove selection from the word bank when checking
            if (currentlySelectedWord) {
                currentlySelectedWord.classList.remove('selected-word');
                currentlySelectedWord = null;
            }
            
            gaps.forEach(gap => {
                gap.classList.remove('correct-gap', 'incorrect-gap');
                const selectedWord = gap.dataset.selectedWord ? gap.dataset.selectedWord.toLowerCase().trim() : '';
                const answer = gap.dataset.answer.toLowerCase().trim();

                if (selectedWord === answer) {
                    correctCount++;
                    gap.classList.add('correct-gap');
                } else if (selectedWord !== '') {
                    // Highlight incorrect answer
                    gap.classList.add('incorrect-gap');
                }
            });

            showResult('gap-result', correctCount, gaps.length);
        }
        
        function checkWordFormation() {
            const answers = [
                {id: 'wf1', correct: 'traditional'}, 
                {id: 'wf2', correct: 'preparation'}, 
                {id: 'wf3', correct: 'surprised'},
                {id: 'wf4', correct: 'efficiently'},
                {id: 'wf5', correct: 'health'},
                {id: 'wf6', correct: 'arrival'}
            ];
            let correct = 0;
            
            answers.forEach(item => {
                const input = document.getElementById(item.id);
                if (input) {
                    input.style.borderBottomColor = '#1A5E7F'; // Reset color to primary
                    input.style.background = '#f8f9fb'; // Reset background

                    const userAnswer = input.value.toLowerCase().trim();
                    const correctAnswer = item.correct.toLowerCase().trim();
                    
                    if (userAnswer === correctAnswer) {
                        input.style.borderBottomColor = '#4caf50';
                        input.style.background = '#e8f5e8';
                        correct++;
                    } else if (userAnswer !== '') {
                        input.style.borderBottomColor = '#f44336';
                        input.style.background = '#ffebee';
                    }
                }
            });

            showResult('wordFormationFeedback', correct, answers.length);
        }

        function showResult(elementId, correct, total) {
            const resultElement = document.getElementById(elementId);
            const isPerfect = correct === total;
            const message = isPerfect ? 
                'ðŸŽ‰ **Spot On!** Perfect score!' : 
                `You got ${correct} out of ${total} correct. Review the questions highlighted in red.`;
            
            resultElement.innerHTML = message;
            resultElement.classList.remove('bg-green-100', 'border-green-500', 'text-gray-700', 'bg-red-100', 'border-red-500', 'text-red-700');
            resultElement.classList.add(isPerfect ? 'bg-green-100' : 'bg-red-100', 'p-4', 'border-l-4', isPerfect ? 'border-green-500' : 'border-red-500', isPerfect ? 'text-gray-700' : 'text-red-700');
            resultElement.classList.remove('hidden');
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Matching Exercises (Vocab and Idioms)
            initializeMatching('vocab-match-grid', 'vocab-column-words', 'vocab-column-meanings', 'vocabFeedback');
            initializeMatching('idiom-match-grid', 'idiom-column-words', 'idiom-column-meanings', 'idiomFeedback');
            
            // Initialize True/False buttons
            document.querySelectorAll('#tf-activity .true-false-item').forEach(item => {
                item.querySelectorAll('.tf-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        // Clear selected from all buttons in the same item
                        item.querySelectorAll('.tf-btn').forEach(b => b.classList.remove('selected'));
                        e.target.classList.add('selected');
                        // Clear result classes on selection change
                        item.classList.remove('correct', 'incorrect');
                    });
                });
            });
            
            // Initialize Gap Fill
            document.getElementById('word-bank').addEventListener('click', handleWordSelection);
            document.querySelectorAll('.gap').forEach(gap => {
                gap.addEventListener('click', handleGapClick);
            });

            // Set correct values for multiple choice (Reading Comp and Grammar)
            document.querySelectorAll('.question-box').forEach(box => {
                const correctValue = box.getAttribute('data-correct-value');
                box.querySelectorAll('input[type="radio"]').forEach(radio => {
                    // Extract the letter A, B, C, D from the label and set it as the radio value.
                    const labelText = radio.parentElement.textContent.trim();
                    if (labelText.length > 0) {
                        radio.value = labelText.substring(0, 1).toLowerCase();
                    }
                });
            });
        });
    </script>
</body>
</html>
