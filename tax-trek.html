<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Trek: Navigating the Financial World</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1C3D5A 0%, #3E798E 50%, #5C94B2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #1C3D5A, #2C5271);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .header::before {
            content: 'üíº';
            position: absolute;
            top: 20px;
            left: 30px;
            font-size: 3em;
            animation: float 3s infinite ease-in-out;
        }
        .header::after {
            content: 'üìä';
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 3em;
            animation: float 3s infinite ease-in-out 1s;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 15px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        .progress-bar {
            width: 100%;
            height: 15px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #2E8B57);
            border-radius: 10px;
            width: 0%;
            transition: width 0.8s ease;
            position: relative;
        }
        .progress::after {
            content: 'üéØ';
            position: absolute;
            right: -10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            animation: float 2s infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(-50%) scale(1); }
            50% { transform: translateY(-60%) scale(1.2); }
        }
        .lesson-content {
            padding: 30px;
        }
        .section {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        .warmup { background: linear-gradient(135deg, #E0F2F1, #80CBC4); }
        .listening { background: linear-gradient(135deg, #E8F5E8, #A5D6A7); }
        .vocab { background: linear-gradient(135deg, #F3E5F5, #CE93D8); }
        .gapfill { background: linear-gradient(135deg, #FFF3E0, #FFCC80); }
        .quiz { background: linear-gradient(135deg, #FFEBEE, #EF9A9A); }
        .grammar { background: linear-gradient(135deg, #E3F2FD, #90CAF9); }
        .new-vocab { background: linear-gradient(135deg, #C5CAE9, #9FA8DA); }
        .reported-speech { background: linear-gradient(135deg, #E0F7FA, #80DEEA); }
        .word-formation { background: linear-gradient(135deg, #FCE4EC, #F48FB1); }

        .section-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }
        .level-badge {
            background: #1C3D5A;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            position: absolute;
            right: 0;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(28, 61, 90, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(28, 61, 90, 0); }
            100% { box-shadow: 0 0 0 0 rgba(28, 61, 90, 0); }
        }
        .story-box {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #4CAF50;
            font-size: 1.1em;
            line-height: 1.8;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .quiz-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .question-counter {
            background: #D32F2F;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        .quiz-question {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #333;
            font-weight: 500;
        }
        .quiz-options {
            display: grid;
            gap: 12px;
        }
        .quiz-option {
            background: #f8f9fa;
            border: 2px solid #ddd;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }
        .quiz-option:hover {
            background: #E1F5FE;
            border-color: #2196F3;
            transform: translateX(5px);
        }
        .quiz-option.correct {
            background: #4CAF50 !important;
            color: white !important;
            border-color: #388E3C !important;
        }
        .quiz-option.incorrect {
            background: #D32F2F !important;
            color: white !important;
            border-color: #C62828 !important;
        }
        .number-input {
            display: inline-block;
            width: 100px;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 0 5px;
            text-align: center;
            font-weight: bold;
            transition: border-color 0.3s ease;
            font-size: 1.1em;
        }
        .number-input:focus {
            outline: none;
            border-color: #2196F3;
        }
        .number-input.correct {
            border-color: #4CAF50;
            background: #E8F5E8;
        }
        .number-input.incorrect {
            border-color: #D32F2F;
            background: #FFEBEE;
        }
        .true-false-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }
        .tf-button {
            background: white;
            border: 3px solid #ddd;
            padding: 20px 40px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        .tf-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        .tf-button.true {
            color: #4CAF50;
            border-color: #4CAF50;
        }
        .tf-button.false {
            color: #D32F2F;
            border-color: #D32F2F;
        }
        .tf-button.selected.true {
            background: #4CAF50;
            color: white;
        }
        .tf-button.selected.false {
            background: #D32F2F;
            color: white;
        }
        .btn {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 15px 10px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }
        .achievement {
            background: linear-gradient(135deg, #FFD700, #FFA000);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            animation: achievementPop 0.6s ease;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            min-width: 300px;
        }
        @keyframes achievementPop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .highlight {
            background: linear-gradient(120deg, #E6EE9C 0%, #DCE775 100%);
            padding: 3px 6px;
            border-radius: 5px;
            font-weight: 500;
        }
        .feedback-box {
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            font-size: 1.1em;
            animation: slideIn 0.5s ease;
        }
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .feedback-box.excellent {
            background: linear-gradient(135deg, #E8F5E8, #C8E6C9);
            border-left: 5px solid #4CAF50;
            color: #2E7D32;
        }
        .feedback-box.needs-improvement {
            background: linear-gradient(135deg, #FFEBEE, #FFCDD2);
            border-left: 5px solid #D32F2F;
            color: #C62828;
        }
        .timer {
            background: #FF5722;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            animation: timerPulse 1s infinite;
            margin: 10px 0;
        }
        @keyframes timerPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Gap Fill Styles */
        .gap-fill-text {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #FFCC80;
            font-size: 1.1em;
            line-height: 1.8;
        }
        .gap-input {
            display: inline-block;
            width: 120px;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 0 5px;
            text-align: center;
            font-weight: bold;
            transition: border-color 0.3s ease;
            background: #FFF8E1;
        }
        .gap-input:focus {
            outline: none;
            border-color: #FFCC80;
        }
        .gap-input.correct {
            border-color: #4CAF50;
            background: #E8F5E8;
        }
        .gap-input.incorrect {
            border-color: #D32F2F;
            background: #FFEBEE;
        }
        .word-bank {
            background: #FFF8E1;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px dashed #FFCC80;
        }
        .word-option {
            display: inline-block;
            background: #FFCC80;
            color: #333;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }
        .word-option:hover {
            background: #FFB74D;
            transform: scale(1.05);
        }
        .word-option.used {
            background: #ccc;
            color: #666;
            cursor: not-allowed;
        }
        .word-option.selected {
            background: #FF9800;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Collocations Matching */
        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        .matching-column {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #8BC34A;
        }
        .matching-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .matching-item:hover {
            background: #E8F5E8;
            border-color: #8BC34A;
        }
        .matching-item.selected {
            background: #8BC34A;
            color: white;
        }
        .matching-item.matched {
            background: #C8E6C9;
            border-color: #4CAF50;
            cursor: default;
        }
        
        .did-you-know {
            background: linear-gradient(135deg, #E0F7FA, #B2EBF2);
            border-left: 5px solid #00BCD4;
            color: #006064;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.1em;
            line-height: 1.6;
        }
        .did-you-know h3 {
            color: #004D40;
            margin-bottom: 15px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .did-you-know ul {
            list-style-type: none;
            padding-left: 20px;
        }
        .did-you-know li {
            margin-bottom: 10px;
            position: relative;
        }
        .did-you-know li::before {
            content: 'üí°';
            position: absolute;
            left: -20px;
            font-size: 1.2em;
        }
        
        /* Sentence Scramble Styles */
        .scramble-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .scramble-words {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            background: #90CAF9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .scramble-word {
            background: #BBDEFB;
            color: #333;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
            font-weight: bold;
        }
        .scramble-word:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .scramble-drop-area {
            min-height: 50px;
            border: 2px dashed #90CAF9;
            border-radius: 10px;
            padding: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }
        .scramble-word.in-area {
            background: #E3F2FD;
            border: 1px solid #90CAF9;
            cursor: move;
        }
        
        .word-formation-input {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            width: 200px;
            transition: border-color 0.3s ease;
        }

        .word-formation-input.correct {
            border-color: #4CAF50;
            background: #E8F5E8;
        }

        .word-formation-input.incorrect {
            border-color: #D32F2F;
            background: #FFEBEE;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .section { margin-bottom: 20px; padding: 20px; }
            .game-stats { flex-direction: column; gap: 15px; }
            .true-false-container { flex-direction: column; align-items: center; }
            .achievement { 
                position: static; 
                margin: 20px auto; 
                min-width: auto; 
                width: 90%; 
            }
            .matching-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body onload="shuffleCollocations(); setupScramble(); displayVocabQuestion(); setupAdvancedGrammar(); setupWordFormation();">
    <div class="container">
        <div class="header">
            <h1>üíº Tax Trek: Navigating the Financial World</h1>
            <p class="subtitle">Professional English for Tax Professionals</p>
            
            <div class="game-stats">
                <div class="stat-item">
                    <span class="stat-number" id="score">0</span>
                    <span class="stat-label">POINTS</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="level">1</span>
                    <span class="stat-label">LEVEL</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="streak">0</span>
                    <span class="stat-label">STREAK</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="achievements">0</span>
                    <span class="stat-label">üèÜ BADGES</span>
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
        </div>

        <div class="lesson-content">
            <div class="section warmup">
                <h2 class="section-title">
                    <span class="emoji">‚ö°</span>Speed Challenge: Tax Basics
                    <span class="level-badge">LEVEL 1</span>
                </h2>
                
                <div class="timer" id="speedTimer" style="display:none;">
                    <span>‚è∞</span>
                    <span id="timeLeft">30</span> seconds
                </div>
                
                <div class="quiz-container" id="speedQuiz" style="display:none;">
                    <div class="question-counter">Speed Round 1/5</div>
                    <div class="quiz-question"></div>
                    <div class="quiz-options">
                        <div class="quiz-option"></div>
                        <div class="quiz-option"></div>
                        <div class="quiz-option"></div>
                        <div class="quiz-option"></div>
                    </div>
                </div>

                <button class="btn" onclick="startSpeedRound()">üèÉ‚Äç‚ôÇÔ∏è Start 30-Second Challenge</button>
            </div>

            <hr>

            <div class="did-you-know">
                <h3>üí° Did you know?</h3>
                <ul>
                    <li>The first income tax was introduced in Britain in 1799 to fund the Napoleonic Wars. It was initially a temporary measure.</li>
                    <li>Many countries have tax treaties with each other to prevent "double taxation," where an individual or company is taxed on the same income by two different countries.</li>
                    <li>The **Alternative Minimum Tax (AMT)** was created in the U.S. to ensure that high-income individuals and corporations with many deductions still pay a minimum amount of tax.</li>
                </ul>
            </div>

            <hr>

            <div class="section listening">
                <h2 class="section-title">
                    <span class="emoji">üìä</span>Reading Comprehension: Global Corporate Tax
                    <span class="level-badge">LEVEL 2</span>
                </h2>

                <div class="story-box">
                    <p><strong>üìà Corporate Tax Trends</strong></p>
                    <p>The global average statutory corporate tax rate has fallen from over <span class="highlight">40%</span> in 1980 to approximately <span class="highlight">23%</span> today. This downward trend is driven by countries seeking to be more competitive and attract foreign investment. The United States, for example, reduced its corporate tax rate from **35%** to **21%** in 2017.</p>
                    
                    <p>However, the actual tax paid, known as the <span class="highlight">effective tax rate</span>, can be much lower due to tax breaks, deductions, and credits. The Organization for Economic Co-operation and Development (**OECD**) has been leading efforts to establish a global minimum corporate tax rate of **15%** to prevent companies from shifting profits to low-tax jurisdictions. This initiative involves over **130** countries.</p>
                </div>

                <div class="quiz-container">
                    <div class="question-counter">Numbers Challenge</div>
                    <div class="quiz-question">Complete the sentences with the correct numbers from the text:</div>
                    
                    <p style="margin: 15px 0;">1. The global average corporate tax rate is currently around <input type="number" class="number-input" id="num1" data-answer="23"> percent.</p>
                    
                    <p style="margin: 15px 0;">2. The US reduced its rate to <input type="number" class="number-input" id="num2" data-answer="21"> percent in 2017.</p>
                    
                    <p style="margin: 15px 0;">3. The OECD proposes a global minimum corporate tax of <input type="number" class="number-input" id="num3" data-answer="15"> percent.</p>
                    
                    <p style="margin: 15px 0;">4. Over <input type="number" class="number-input" id="num4" data-answer="130"> countries are involved in this initiative.</p>
                </div>

                <button class="btn" onclick="checkNumbers()">üìä Check My Numbers</button>
            </div>

            <hr>

            <div class="section quiz">
                <h2 class="section-title">
                    <span class="emoji">‚úÖ</span>True or False?
                    <span class="level-badge">LEVEL 3</span>
                </h2>
                <div class="quiz-container">
                    <div class="quiz-question">The global average corporate tax rate has been steadily increasing since 1980.</div>
                    <div class="true-false-container">
                        <button class="tf-button true" onclick="answerTrueFalse(this, false, true)">TRUE</button>
                        <button class="tf-button false" onclick="answerTrueFalse(this, false, false)">FALSE</button>
                    </div>
                </div>
                 <div class="quiz-container">
                    <div class="quiz-question">The "effective tax rate" is always higher than the "statutory tax rate."</div>
                    <div class="true-false-container">
                        <button class="tf-button true" onclick="answerTrueFalse(this, false, true)">TRUE</button>
                        <button class="tf-button false" onclick="answerTrueFalse(this, false, false)">FALSE</button>
                    </div>
                </div>
            </div>

            <hr>

            <div class="section grammar">
                <h2 class="section-title">
                    <span class="emoji">üìù</span>Grammar Challenge: Sentence Scramble
                    <span class="level-badge">LEVEL 4</span>
                </h2>
                <p><strong>Instructions:</strong> Drag and drop the words to form a grammatically correct sentence. To remove a word from the sentence, simply click on it.</p>
                <div class="scramble-container" id="scrambleContainer">
                    </div>
                <button class="btn" onclick="checkScramble()">‚úÖ Check Sentences</button>
            </div>

            <hr>

            <div class="section gapfill">
                <h2 class="section-title">
                    <span class="emoji">üìù</span>Gap Fill: The Tax System
                    <span class="level-badge">LEVEL 5</span>
                </h2>
                
                <div class="word-bank">
                    <strong>Word Bank:</strong>
                    <span class="word-option" onclick="selectWord(this)" data-word="revenue">revenue</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="deductions">deductions</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="audit">audit</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="filing">filing</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="liability">liability</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="compliance">compliance</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="jurisdiction">jurisdiction</span>
                    <span class="word-option" onclick="selectWord(this)" data-word="incentives">incentives</span>
                </div>

                <div class="gap-fill-text">
                    <p>The primary goal of a tax professional is to ensure client <input type="text" class="gap-input" id="gap1" data-answer="compliance" onclick="fillGap(this)"> with all relevant laws.</p>
                    
                    <p>By using legal <input type="text" class="gap-input" id="gap2" data-answer="deductions" onclick="fillGap(this)">, they can reduce a company's tax <input type="text" class="gap-input" id="gap3" data-answer="liability" onclick="fillGap(this)">. Timely <input type="text" class="gap-input" id="gap4" data-answer="filing" onclick="fillGap(this)"> of returns is critical to avoid penalties.</p>
                    
                    <p>Sometimes, companies are subject to an <input type="text" class="gap-input" id="gap5" data-answer="audit" onclick="fillGap(this)"> by the tax authority to verify their reported <input type="text" class="gap-input" id="gap6" data-answer="revenue" onclick="fillGap(this)">. The tax laws of a specific <input type="text" class="gap-input" id="gap7" data-answer="jurisdiction" onclick="fillGap(this)"> may offer tax <input type="text" class="gap-input" id="gap8" data-answer="incentives" onclick="fillGap(this)"> for new businesses.</p>
                </div>

                <button class="btn" onclick="checkGapFill()">‚úÖ Check Gap Fill</button>
            </div>
            
            <hr>

            <div class="section vocab">
                <h2 class="section-title">
                    <span class="emoji">üîó</span>Tax Collocations Matching
                    <span class="level-badge">LEVEL 6</span>
                </h2>
                
                <p><strong>Instructions:</strong> Match tax verbs with their common noun partners. Click one from each column!</p>
                
                <div class="matching-container">
                    <div class="matching-column" id="verbsColumn">
                        <h3 style="text-align: center; margin-bottom: 15px;">VERBS</h3>
                    </div>
                    <div class="matching-column" id="nounsColumn">
                        <h3 style="text-align: center; margin-bottom: 15px;">NOUNS</h3>
                    </div>
                </div>

                <button class="btn" onclick="checkMatching()">üîó Check Matches</button>
            </div>
            
            <hr>

            <div class="section reported-speech">
                <h2 class="section-title">
                    <span class="emoji">üíº</span>Advanced Grammar: Professional Scenarios
                    <span class="level-badge">LEVEL 7</span>
                </h2>
                <div class="quiz-container" id="advancedGrammarQuiz">
                    </div>
                <button class="btn" onclick="checkAdvancedGrammar()">‚úÖ Check My Answers</button>
            </div>
            
            <hr>

            <div class="section word-formation">
                <h2 class="section-title">
                    <span class="emoji">‚úçÔ∏è</span>Word Formation Challenge
                    <span class="level-badge">LEVEL 8</span>
                </h2>
                <p><strong>Instructions:</strong> Complete the sentences by forming the correct word from the base word in brackets.</p>
                <div id="wordFormationQuiz">
                    </div>
                <button class="btn" onclick="checkWordFormation()">‚úÖ Check Word Formation</button>
            </div>

            <hr>

            <div class="section new-vocab">
                <h2 class="section-title">
                    <span class="emoji">üí¨</span>Contextual Vocabulary Quiz
                    <span class="level-badge">LEVEL 9</span>
                </h2>
                <div class="quiz-container" id="vocabQuiz">
                    <div class="question-counter">Question 1/3</div>
                    <div class="quiz-question"></div>
                    <div class="quiz-options">
                        </div>
                </div>
            </div>
            
        </div>
    </div>

    <script>
        let score = 0;
        let level = 1;
        let streak = 0;
        let achievements = 0;
        let totalSections = 9; // Updated with new section
        let totalQuestionsAnswered = 0;
        let correctAnswersCount = 0;

        function updateStats(points, resetStreak = false) {
            score += points;
            if (resetStreak) {
                streak = 0;
            } else {
                streak++;
            }
            if (score >= 100 * level) {
                level++;
                score = 0;
                showAchievement(`Level Up! You are now Level ${level}! üéâ`);
            }
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
            document.getElementById('streak').textContent = streak;
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = (score / (100 * level)) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function showAchievement(message) {
            const achievementBox = document.createElement('div');
            achievementBox.className = 'achievement';
            achievementBox.textContent = message;
            document.body.appendChild(achievementBox);
            achievements++;
            document.getElementById('achievements').textContent = achievements;
            setTimeout(() => {
                achievementBox.remove();
            }, 3000);
        }

        function showFeedback(element, isCorrect, message) {
            const feedbackBox = document.createElement('div');
            feedbackBox.className = `feedback-box ${isCorrect ? 'excellent' : 'needs-improvement'}`;
            feedbackBox.innerHTML = `${isCorrect ? 'ü•≥ Excellent!' : 'üòü Try again!'} ${message}`;
            element.parentNode.insertBefore(feedbackBox, element.nextSibling);
            setTimeout(() => {
                feedbackBox.remove();
            }, 5000);
        }

        // Speed Challenge
        let speedQuizIndex = 0;
        const speedQuestions = [
            { q: 'What is "VAT"?', a: 'Value Added Tax', options: ['Value Added Transaction', 'Value Added Tax', 'Voluntary Asset Transfer', 'Variable Account Tally'] },
            { q: 'What is a "tax deduction"?', a: 'An amount that can reduce taxable income', options: ['A tax refund', 'An amount that can reduce taxable income', 'A type of tax fraud', 'An additional tax fee'] },
            { q: 'What is "capital gains tax"?', a: 'A tax on profits from the sale of an asset', options: ['A tax on salaries', 'A tax on profits from the sale of an asset', 'A tax on business loans', 'A tax on imports'] },
            { q: 'What does a "tax audit" involve?', a: 'An official examination of tax returns', options: ['A type of tax payment', 'An official examination of tax returns', 'A new tax law', 'A financial market analysis'] },
            { q: 'What is a "tax haven"?', a: 'A country with very low tax rates', options: ['A tax collection office', 'A country with very low tax rates', 'A type of tax deduction', 'A charitable organization'] }
        ];
        let speedTimer;
        let timeLeft = 30;
        let speedQuizCorrect = 0;

        function startSpeedRound() {
            speedQuizIndex = 0;
            speedQuizCorrect = 0;
            timeLeft = 30;
            document.getElementById('speedTimer').style.display = 'inline-flex';
            document.querySelector('.warmup button').style.display = 'none';
            document.getElementById('speedQuiz').style.display = 'block';
            nextSpeedQuestion();
            speedTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timeLeft').textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(speedTimer);
                    endSpeedRound();
                }
            }, 1000);
        }
        
        function nextSpeedQuestion() {
            if (speedQuizIndex >= speedQuestions.length) {
                endSpeedRound();
                return;
            }
            const q = speedQuestions[speedQuizIndex];
            const quizContainer = document.getElementById('speedQuiz');
            quizContainer.querySelector('.question-counter').textContent = `Speed Round ${speedQuizIndex + 1}/5`;
            quizContainer.querySelector('.quiz-question').textContent = q.q;
            
            let options = [...q.options];
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            const optionElements = quizContainer.querySelectorAll('.quiz-option');
            const optionLabels = ['A', 'B', 'C', 'D'];
            for (let i = 0; i < options.length; i++) {
                optionElements[i].textContent = `${optionLabels[i]}) ${options[i]}`;
                const isCorrect = options[i] === q.a;
                optionElements[i].onclick = () => answerSpeed(optionElements[i], isCorrect);
                optionElements[i].classList.remove('correct', 'incorrect');
                optionElements[i].style.pointerEvents = 'auto';
            }
        }

        function answerSpeed(element, isCorrect) {
            const allOptions = element.parentNode.children;
            for (let i = 0; i < allOptions.length; i++) {
                allOptions[i].style.pointerEvents = 'none';
                if (allOptions[i].textContent.includes(speedQuestions[speedQuizIndex].a)) {
                    allOptions[i].classList.add('correct');
                } else if (element === allOptions[i]) {
                    element.classList.add('incorrect');
                }
            }
            if (isCorrect) {
                speedQuizCorrect++;
            }
            setTimeout(() => {
                speedQuizIndex++;
                if (speedQuizIndex < speedQuestions.length) {
                    nextSpeedQuestion();
                } else {
                    endSpeedRound();
                }
            }, 1000);
        }

        function endSpeedRound() {
            clearInterval(speedTimer);
            document.getElementById('speedTimer').style.display = 'none';
            document.querySelector('.warmup button').style.display = 'block';
            document.getElementById('speedQuiz').style.display = 'none';
            let message = `You got ${speedQuizCorrect} out of 5 correct!`;
            if (speedQuizCorrect === 5) {
                showAchievement('Tax Tycoon! 5/5 correct! üèÜ');
                updateStats(50);
            } else {
                updateStats(speedQuizCorrect * 10, true);
            }
            showFeedback(document.querySelector('.warmup'), speedQuizCorrect === 5, message);
        }


        // Numbers Challenge
        function checkNumbers() {
            const inputs = document.querySelectorAll('#num1, #num2, #num3, #num4');
            let correctCount = 0;
            inputs.forEach(input => {
                const isCorrect = input.value == input.getAttribute('data-answer');
                if (isCorrect) {
                    input.classList.remove('incorrect');
                    input.classList.add('correct');
                    correctCount++;
                } else {
                    input.classList.remove('correct');
                    input.classList.add('incorrect');
                }
            });

            if (correctCount === inputs.length) {
                updateStats(50);
                showAchievement('Numbers Genius! All numbers correct! üî¢');
                showFeedback(document.querySelector('.listening'), true, 'You got all the numbers right!');
            } else {
                updateStats(0, true);
                showFeedback(document.querySelector('.listening'), false, `You got ${correctCount} out of ${inputs.length} correct. The correct answers are: 23, 21, 15, 130.`);
            }
        }

        // True/False
        function answerTrueFalse(button, correctAnswer, userChoice) {
            const container = button.closest('.quiz-container');
            const allButtons = container.querySelectorAll('.tf-button');
            allButtons.forEach(btn => btn.style.pointerEvents = 'none');
            
            if (userChoice === correctAnswer) {
                button.classList.add('selected', 'true');
                updateStats(25);
                showFeedback(container, true, 'Great job! That is correct!');
            } else {
                button.classList.add('selected', 'false');
                updateStats(0, true);
                const correctButton = container.querySelector(correctAnswer ? '.tf-button.true' : '.tf-button.false');
                correctButton.classList.add('selected', 'true');
                showFeedback(container, false, 'That is incorrect. The correct answer is ' + (correctAnswer ? 'True' : 'False') + '.');
            }
        }
        
        // New Grammar Activity: Sentence Scramble
        const scrambleSentences = [
            ['The', 'company', 'must', 'comply', 'with', 'all', 'tax', 'regulations.'],
            ['It', 'is', 'important', 'to', 'file', 'your', 'tax', 'returns', 'on', 'time.'],
            ['The', 'auditor', 'found', 'an', 'error', 'in', 'the', 'financial', 'statement.']
        ];
        let dragSource = null;

        function setupScramble() {
            const container = document.getElementById('scrambleContainer');
            container.innerHTML = '';
            
            scrambleSentences.forEach((sentence, index) => {
                const quizBox = document.createElement('div');
                quizBox.className = 'quiz-container';
                quizBox.innerHTML = `
                    <p><strong>Sentence ${index + 1}:</strong></p>
                    <div class="scramble-words" data-correct="${sentence.join(' ')}"></div>
                    <div class="scramble-drop-area"></div>
                `;
                container.appendChild(quizBox);

                const wordsContainer = quizBox.querySelector('.scramble-words');
                const words = [...sentence].sort(() => Math.random() - 0.5);
                words.forEach(word => {
                    const wordSpan = document.createElement('span');
                    wordSpan.className = 'scramble-word';
                    wordSpan.textContent = word;
                    wordSpan.draggable = true;
                    wordSpan.addEventListener('dragstart', handleDragStart);
                    wordSpan.addEventListener('click', handleScrambleClick); // Add click handler
                    wordsContainer.appendChild(wordSpan);
                });

                const dropArea = quizBox.querySelector('.scramble-drop-area');
                dropArea.addEventListener('dragover', handleDragOver);
                dropArea.addEventListener('drop', handleDrop);
            });
        }
        
        function handleDragStart(e) {
            dragSource = e.target;
            e.dataTransfer.effectAllowed = 'move';
        }
        
        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropArea = e.target.closest('.scramble-drop-area');
            if (dropArea) {
                dropArea.appendChild(dragSource);
                dragSource.classList.add('in-area');
            }
        }
        
        function handleScrambleClick(e) {
            const wordElement = e.target;
            if (wordElement.classList.contains('in-area')) {
                const dropArea = wordElement.parentElement;
                const wordsContainer = dropArea.previousElementSibling;
                wordsContainer.appendChild(wordElement);
                wordElement.classList.remove('in-area');
            }
        }

        function checkScramble() {
            let allCorrect = true;
            document.querySelectorAll('.scramble-container .quiz-container').forEach(quizBox => {
                const dropArea = quizBox.querySelector('.scramble-drop-area');
                const correctSentence = quizBox.querySelector('.scramble-words').dataset.correct;
                const userSentence = Array.from(dropArea.children).map(child => child.textContent).join(' ');
                
                if (userSentence === correctSentence) {
                    showFeedback(quizBox, true, 'Correct sentence!');
                } else {
                    allCorrect = false;
                    showFeedback(quizBox, false, `The correct sentence is: "${correctSentence}"`);
                }
            });
            if (allCorrect) {
                updateStats(75);
                showAchievement('Grammar Wizard! All sentences correct! üìñ');
            } else {
                updateStats(0, true);
            }
        }

        // New Advanced Grammar Section
        const advancedGrammarQuestions = [
            {
                type: 'reported-speech',
                q: 'The client said, "I have already paid my taxes for this quarter."',
                a: 'The client said that he had already paid his taxes for that quarter.',
                options: [
                    'The client said that he has already paid his taxes for this quarter.',
                    'The client said that he had already paid his taxes for that quarter.',
                    'The client said that I already paid my taxes for this quarter.',
                    'The client said he already paid his taxes for that quarter.'
                ]
            },
            {
                type: 'conditional',
                q: 'The tax bill will be lower if we claim all our eligible expenses.',
                a: 'If we claim all our eligible expenses, the tax bill will be lower.',
                options: [
                    'If we claim all our eligible expenses, the tax bill will be lower.',
                    'If we had claimed all our eligible expenses, the tax bill would be lower.',
                    'If we claimed all our eligible expenses, the tax bill would have been lower.',
                    'The tax bill would be lower if we have claimed all our eligible expenses.'
                ]
            },
            {
                type: 'reported-speech',
                q: 'The auditor asked, "Did you include all revenue streams in your report?"',
                a: 'The auditor asked if we had included all revenue streams in our report.',
                options: [
                    'The auditor asked if you included all revenue streams in your report.',
                    'The auditor asked if we had included all revenue streams in our report.',
                    'The auditor asked did you include all revenue streams in your report.',
                    'The auditor asked if we included all revenue streams in our report.'
                ]
            }
        ];
        let advancedGrammarQuizIndex = 0;

        function setupAdvancedGrammar() {
            const container = document.getElementById('advancedGrammarQuiz');
            container.innerHTML = '';
            
            advancedGrammarQuestions.forEach((q, index) => {
                const quizBox = document.createElement('div');
                quizBox.className = 'quiz-container';
                quizBox.innerHTML = `
                    <div class="question-counter">Question ${index + 1}/${advancedGrammarQuestions.length}</div>
                    <div class="quiz-question"><strong>Original sentence:</strong> "${q.q}"<br>Choose the correct rephrased sentence:</div>
                    <div class="quiz-options">
                        ${q.options.map((option, i) => `
                            <div class="quiz-option" data-correct="${option === q.a}">${option}</div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(quizBox);
            });
            
            document.querySelectorAll('#advancedGrammarQuiz .quiz-options').forEach(optionsContainer => {
                optionsContainer.addEventListener('click', (e) => {
                    const clickedOption = e.target.closest('.quiz-option');
                    if (!clickedOption) return;
                    checkAdvancedGrammarOption(clickedOption);
                });
            });
        }
        
        function checkAdvancedGrammarOption(element) {
            const quizContainer = element.closest('.quiz-container');
            const allOptions = quizContainer.querySelectorAll('.quiz-option');
            const isCorrect = element.dataset.correct === 'true';

            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.dataset.correct === 'true') {
                    opt.classList.add('correct');
                } else if (opt === element) {
                    opt.classList.add('incorrect');
                }
            });
            
            if (isCorrect) {
                updateStats(30);
                showFeedback(quizContainer, true, 'Correct! Excellent use of grammar.');
            } else {
                updateStats(0, true);
                showFeedback(quizContainer, false, 'Incorrect. Review the rules for reported speech and conditionals.');
            }
        }
        
        function checkAdvancedGrammar() {
            let allCorrect = true;
            document.querySelectorAll('#advancedGrammarQuiz .quiz-container').forEach(quizBox => {
                const selectedCorrect = quizBox.querySelector('.quiz-option.correct');
                if (!selectedCorrect || selectedCorrect.style.pointerEvents !== 'none') {
                    allCorrect = false;
                }
            });
            
            if (allCorrect) {
                 showAchievement('Grammar Pro! All scenarios correct! üèÜ');
            } else {
                showFeedback(document.querySelector('.reported-speech'), false, 'Please complete all questions before checking your final score!');
            }
        }
        
        // Word Formation Challenge
        const wordFormationQuestions = [
            { question: 'The financial records were carefully _________ (AUDIT) by an independent firm.', answer: 'audited' },
            { question: 'The government is considering a new system of income _________ (TAX) to simplify the process.', answer: 'taxation' },
            { question: 'They filed their tax returns in full _________ (comply) with the new laws.', answer: 'compliance' }
        ];

        function setupWordFormation() {
            const container = document.getElementById('wordFormationQuiz');
            container.innerHTML = '';
            wordFormationQuestions.forEach((q, index) => {
                const questionBox = document.createElement('div');
                questionBox.className = 'quiz-container';
                questionBox.innerHTML = `
                    <div class="question-counter">Question ${index + 1}/${wordFormationQuestions.length}</div>
                    <div class="quiz-question">${q.question}</div>
                    <input type="text" class="word-formation-input" data-answer="${q.answer.toLowerCase()}" onchange="checkWordFormationAnswer(this)">
                `;
                container.appendChild(questionBox);
            });
        }
        
        function checkWordFormationAnswer(input) {
            const isCorrect = input.value.trim().toLowerCase() === input.dataset.answer;
            if (isCorrect) {
                input.classList.remove('incorrect');
                input.classList.add('correct');
            } else {
                input.classList.remove('correct');
                input.classList.add('incorrect');
            }
        }
        
        function checkWordFormation() {
            const inputs = document.querySelectorAll('.word-formation-input');
            let correctCount = 0;
            inputs.forEach(input => {
                if (input.value.trim().toLowerCase() === input.dataset.answer) {
                    correctCount++;
                }
            });

            if (correctCount === inputs.length) {
                updateStats(75);
                showAchievement('Word Wizard! All formations correct! ü™Ñ');
                showFeedback(document.querySelector('.word-formation'), true, 'All words were formed correctly!');
            } else {
                updateStats(0, true);
                showFeedback(document.querySelector('.word-formation'), false, `You got ${correctCount} out of ${inputs.length} correct. The correct answers are: ${wordFormationQuestions.map(q => q.answer).join(', ')}.`);
            }
        }

        // Gap Fill
        let selectedWord = null;
        function selectWord(element) {
            if (element.classList.contains('used')) return;

            // Deselect the previously selected word
            const previouslySelected = document.querySelector('.word-option.selected');
            if (previouslySelected) {
                previouslySelected.classList.remove('selected');
            }
            
            // Select the new word
            element.classList.add('selected');
            selectedWord = element;
        }

        function fillGap(input) {
            // Case 1: Gap is empty and a word is selected
            if (selectedWord && !input.value) {
                const wordToFill = selectedWord.dataset.word;
                input.value = wordToFill;
                selectedWord.classList.add('used');
                selectedWord.classList.remove('selected');
                selectedWord = null;
            } 
            // Case 2: Gap is already filled
            else if (input.value) {
                const wordToReturn = input.value;
                const wordOption = document.querySelector(`.word-option[data-word="${wordToReturn}"]`);
                if (wordOption) {
                    wordOption.classList.remove('used');
                }
                input.value = ''; // Clear the input
                input.classList.remove('correct', 'incorrect');
            }
        }

        function checkGapFill() {
            const inputs = document.querySelectorAll('.gap-input');
            let correctCount = 0;
            inputs.forEach(input => {
                const isCorrect = input.value === input.getAttribute('data-answer');
                if (isCorrect) {
                    input.classList.add('correct');
                    correctCount++;
                } else {
                    input.classList.add('incorrect');
                }
            });

            if (correctCount === inputs.length) {
                updateStats(100);
                showAchievement('Fill-in Master! Perfect score! ‚úçÔ∏è');
                showFeedback(document.querySelector('.gapfill'), true, 'All gaps filled correctly!');
            } else {
                updateStats(0, true);
                showFeedback(document.querySelector('.gapfill'), false, `You got ${correctCount} out of ${inputs.length} correct. The correct words are: compliance, deductions, liability, filing, audit, revenue, jurisdiction, incentives.`);
            }
        }
        
        // New Vocabulary Activity: Contextual Vocabulary
        const vocabQuestions = [
            { q: 'The tax **___** for that fiscal year is still under review.', a: 'liability', options: ['incentive', 'revenue', 'liability', 'exemption'] },
            { q: 'The government aims to **___** tax revenue through better enforcement.', a: 'maximize', options: ['abolish', 'minimize', 'maximize', 'reclaim'] },
            { q: 'A tax **___** is a legal method to reduce your tax bill.', a: 'credit', options: ['audit', 'levy', 'credit', 'rebate'] }
        ];
        let vocabQuizIndex = 0;

        function displayVocabQuestion() {
            const container = document.getElementById('vocabQuiz');
            const optionsContainer = container.querySelector('.quiz-options');
            
            if (vocabQuizIndex >= vocabQuestions.length) {
                showFeedback(container, true, 'You have completed the vocabulary quiz!');
                return;
            }

            const q = vocabQuestions[vocabQuizIndex];
            container.querySelector('.question-counter').textContent = `Question ${vocabQuizIndex + 1}/${vocabQuestions.length}`;
            container.querySelector('.quiz-question').innerHTML = q.q;

            optionsContainer.innerHTML = '';
            
            let options = [...q.options];
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }

            options.forEach(optionText => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = optionText;
                
                const isCorrect = optionText === q.a;
                optionElement.onclick = () => checkVocabAnswer(optionElement, isCorrect);
                
                optionsContainer.appendChild(optionElement);
            });
        }

        function checkVocabAnswer(element, isCorrect) {
            const container = element.closest('.quiz-container');
            const allOptions = container.querySelectorAll('.quiz-option');
            allOptions.forEach(opt => opt.style.pointerEvents = 'none');

            if (isCorrect) {
                element.classList.add('correct');
                updateStats(25);
                showFeedback(container, true, 'That is the correct word!');
            } else {
                element.classList.add('incorrect');
                updateStats(0, true);
                const correctElement = Array.from(allOptions).find(opt => opt.textContent === vocabQuestions[vocabQuizIndex].a);
                if (correctElement) {
                    correctElement.classList.add('correct');
                }
                showFeedback(container, false, `Incorrect. The correct answer is "${vocabQuestions[vocabQuizIndex].a}".`);
            }
            
            setTimeout(() => {
                vocabQuizIndex++;
                displayVocabQuestion();
            }, 1500);
        }

        // Collocations Matching
        const collocations = [
            {verb: 'FILE', noun: 'a return'},
            {verb: 'CLAIM', noun: 'an expense'},
            {verb: 'PAY', noun: 'taxes'},
            {verb: 'PREPARE', noun: 'documentation'},
            {verb: 'CONDUCT', noun: 'an audit'}
        ];
        
        let selectedVerb = null;
        let selectedNoun = null;
        let matchedPairs = 0;
        let allItems = new Map();

        function shuffleCollocations() {
            const verbs = collocations.map(c => c.verb);
            const nouns = collocations.map(c => c.noun);
            
            for (let i = nouns.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [nouns[i], nouns[j]] = [nouns[j], nouns[i]];
            }
            
            const verbsColumn = document.getElementById('verbsColumn');
            verbsColumn.innerHTML = '<h3 style="text-align: center; margin-bottom: 15px;">VERBS</h3>';
            verbs.forEach(verb => {
                const verbItem = document.createElement('div');
                verbItem.className = 'matching-item';
                verbItem.textContent = verb;
                verbItem.dataset.match = collocations.find(c => c.verb === verb).noun;
                verbItem.addEventListener('click', () => selectMatching('verb', verbItem));
                verbsColumn.appendChild(verbItem);
                allItems.set(verb, verbItem);
            });
            
            const nounsColumn = document.getElementById('nounsColumn');
            nounsColumn.innerHTML = '<h3 style="text-align: center; margin-bottom: 15px;">NOUNS</h3>';
            nouns.forEach(noun => {
                const nounItem = document.createElement('div');
                nounItem.className = 'matching-item';
                nounItem.textContent = noun;
                nounItem.dataset.match = collocations.find(c => c.noun === noun).verb;
                nounItem.addEventListener('click', () => selectMatching('noun', nounItem));
                nounsColumn.appendChild(nounItem);
                allItems.set(noun, nounItem);
            });
            
            matchedPairs = 0;
        }

        function selectMatching(type, element) {
            if (element.classList.contains('matched')) return;

            if (type === 'verb') {
                if (selectedVerb) {
                    selectedVerb.classList.remove('selected');
                }
                selectedVerb = element;
            } else {
                if (selectedNoun) {
                    selectedNoun.classList.remove('selected');
                }
                selectedNoun = element;
            }

            element.classList.add('selected');
        }

        function checkMatching() {
            if (selectedVerb && selectedNoun) {
                const verbMatch = selectedVerb.dataset.match;
                const nounMatch = selectedNoun.textContent;

                if (verbMatch === nounMatch) {
                    selectedVerb.classList.add('matched');
                    selectedNoun.classList.add('matched');
                    matchedPairs++;
                    updateStats(30);
                    showFeedback(document.querySelector('.matching-container'), true, 'Correct match! Keep going!');
                } else {
                    updateStats(0, true);
                    showFeedback(document.querySelector('.matching-container'), false, 'Incorrect match. Try another pair!');
                }

                selectedVerb.classList.remove('selected');
                selectedNoun.classList.remove('selected');
                selectedVerb = null;
                selectedNoun = null;

                if (matchedPairs === collocations.length) {
                    showAchievement('Collocation Champion! All pairs matched! üèÜ');
                    updateStats(100);
                }
            }
        }

        window.onload = function() {
            shuffleCollocations();
            setupScramble();
            displayVocabQuestion();
            setupAdvancedGrammar();
            setupWordFormation();
        };
    </script>
</body>
</html>
