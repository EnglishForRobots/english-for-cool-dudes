<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Intermediate English Lesson</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            min-height: 100vh;
            color: #333;
        }

        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: rgba(255,255,255,0.9);
            padding: 15px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }

        .lesson-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            transform: translateY(20px);
            opacity: 0;
            animation: slideUp 0.5s forwards;
        }

        @keyframes slideUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff4757;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            display: none;
            animation: pulse 1s infinite;
            z-index: 1000;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .question-container {
            margin: 20px 0;
        }

        .question {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
            font-weight: 600;
        }

        .options {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }

        .option {
            background: #f8f9ff;
            border: 2px solid #e1e8ff;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            user-select: none;
        }

        .option:hover:not(.disabled) {
            background: #e8f0ff;
            border-color: #4CAF50;
            transform: translateX(5px);
        }

        .option.correct {
            background: #d4edda !important;
            border-color: #4CAF50 !important;
            color: #155724;
        }

        .option.incorrect {
            background: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #721c24;
        }
        
        .option.selected {
            background: #e8f0ff;
            border-color: #4CAF50;
            font-weight: bold;
        }

        .option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .btn {
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .reading-text {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #4CAF50;
            line-height: 1.6;
            font-style: italic;
        }

        .reading-text strong {
            font-style: normal;
            color: #4CAF50;
        }

        .achievement {
            background: linear-gradient(135deg, #ffd700, #ffed4a);
            color: #333;
            padding: 15px;
            border-radius: 15px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
            display: none;
            animation: achievementPop 0.5s ease;
        }

        @keyframes achievementPop {
            0% { transform: scale(0.8) rotate(-5deg); opacity: 0; }
            50% { transform: scale(1.1) rotate(2deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        .sticker {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 5rem;
            opacity: 0;
            animation: stickerPop 1s forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes stickerPop {
            0% { transform: translate(-50%, -50%) scale(0.5) rotate(-20deg); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2) rotate(10deg); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); opacity: 0; }
        }

        .gap-fill-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .conversation-container {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border-left: 5px solid #2196f3;
            line-height: 1.6;
        }

        .gap-sentence {
            font-size: 18px;
            line-height: 1.8;
            padding: 10px 0;
        }

        .gap-fill-drop-zone {
            display: inline-block;
            border-bottom: 3px solid #4CAF50;
            min-width: 80px;
            text-align: center;
            padding: 8px 15px;
            font-size: 16px;
            margin: 0 8px;
            transition: all 0.3s ease;
            font-weight: bold;
            color: #4CAF50;
            min-height: 30px;
        }

        .gap-fill-drop-zone.filled {
            background: #e8f0ff;
            border-radius: 5px;
        }
        
        .gap-fill-drop-zone.correct-answer {
            background: #d4edda;
            border-color: #4CAF50;
            color: #155724;
        }

        .gap-fill-drop-zone.incorrect-answer {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .word-bank-drag {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 15px;
            border: 2px dashed #4CAF50;
        }

        .word-bank-title {
            width: 100%;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .word-item-drag {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: grab;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .word-item-drag:hover:not(.used) {
            background: linear-gradient(135deg, #8BC34A, #4CAF50);
            transform: scale(1.05) translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .word-item-drag:active {
            cursor: grabbing;
        }

        .word-item-drag.used {
            background: #ccc;
            cursor: not-allowed;
            transform: scale(0.9);
            opacity: 0.5;
            box-shadow: none;
        }

        .sortable-list {
            list-style: none;
            padding: 0;
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
        }

        .sortable-item {
            background: white;
            border: 2px solid #e1e8ff;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .sortable-item:hover {
            background: #e8f0ff;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
        }
        
        .sortable-item.selected-item {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
            transform: scale(1.02);
        }

        .sortable-list.correct-order .sortable-item {
            background: #d4edda;
            border-color: #4CAF50;
            color: #155724;
            transform: none !important;
        }

        .sortable-list.incorrect-order .sortable-item {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
            animation: shake 0.5s;
            transform: none !important;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .matching-column h4 {
            text-align: center;
            color: #4CAF50;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            font-weight: bold;
        }

        .match-item {
            background: white;
            border: 2px solid #e1e8ff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .match-item:hover:not(.correct):not(.disabled) {
            background: #e8f0ff;
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .match-item.selected {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .match-item.correct {
            background: #4CAF50 !important;
            color: white !important;
            border-color: #4CAF50 !important;
            cursor: not-allowed;
        }

        .match-item.incorrect {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
            animation: shake 0.5s;
        }

        .match-item.disabled {
            pointer-events: none;
            opacity: 0.7;
        }

        .match-score {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            font-weight: bold;
            color: #4CAF50;
        }

        .hidden {
            display: none !important;
        }

        .level-badge {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }

        .points-animation {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #667eea;
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 24px;
            font-weight: bold;
            z-index: 1000;
            animation: pointsFloat 2s ease-out forwards;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        @keyframes pointsFloat {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            30% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -80px) scale(1); }
        }

        .activity-instructions {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            border-left: 4px solid #2196f3;
            font-weight: 500;
        }

        .feedback-message {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            display: none;
            font-size: 16px;
        }

        .feedback-correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #4CAF50;
        }

        .feedback-incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }

        .next-activity-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            margin-top: 20px;
            display: none;
        }

        .try-again-btn {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            margin-top: 20px;
            display: none;
        }

        .check-btn {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }
        
        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            margin: 20px 0;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 15px;
        }

        .video-link {
            text-align: center;
            margin-top: 20px;
        }

        .video-link a {
            display: inline-block;
            background: #ff0000;
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            transition: transform 0.3s ease;
        }
        
        .video-link a:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ü§ù English Adventure: Pre-Intermediate Lesson ü§ù</h1>
            <div class="level-badge">Level <span id="currentLevel">1</span></div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="totalPoints">0</div>
                <div>Points</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streak">0</div>
                <div>Streak</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="timeLeft">--</div>
                <div>Time</div>
            </div>
        </div>

        <div class="timer" id="timer">‚è∞ 30s</div>
        <div class="achievement" id="achievement"></div>

        <div class="lesson-card" id="activity1">
            <h2>üéØ Activity 1: Greetings & Replies</h2>
            <div class="activity-instructions">
                Match the common greeting with the correct reply. Tap on a phrase from the left column, then tap on its matching reply from the right column!
            </div>
            
            <div class="matching-container">
                <div class="matching-column">
                    <h4>üîµ Greetings</h4>
                    <div class="match-item vocabulary" data-match="1">How's it going?</div>
                    <div class="match-item vocabulary" data-match="2">Nice to meet you.</div>
                    <div class="match-item vocabulary" data-match="3">What have you been up to?</div>
                    <div class="match-item vocabulary" data-match="4">Good morning!</div>
                    <div class="match-item vocabulary" data-match="5">I'm so sorry.</div>
                    <div class="match-item vocabulary" data-match="6">Can you help me?</div>
                </div>
                
                <div class="matching-column">
                    <h4>üü° Replies</h4>
                    <div class="match-item definition" data-match="5">That's alright.</div>
                    <div class="match-item definition" data-match="3">Not much, just working a lot.</div>
                    <div class="match-item definition" data-match="1">It's going well, thanks!</div>
                    <div class="match-item definition" data-match="6">Sure, what do you need?</div>
                    <div class="match-item definition" data-match="2">You too.</div>
                    <div class="match-item definition" data-match="4">Morning! How are you?</div>
                </div>
            </div>
            
            <div class="match-score">
                <span id="matchScore">Matches: 0/6</span>
            </div>
            
            <div class="feedback-message" id="matching-feedback"></div>
            <button class="btn next-activity-btn" id="matching-next" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
        </div>

        <div class="lesson-card hidden" id="activity2">
            <h2>üìñ Activity 2: Reading Comprehension</h2>
            <div class="activity-instructions">
                Read the short dialogue, then answer the questions below.
            </div>
            
            <div class="reading-text">
                <strong>Making Plans</strong><br><br>
                **Leo:** Hey Sarah, how's it going? I'm calling to see if you want to hang out this weekend.<br>
                **Sarah:** Hi Leo! It's going well, thanks. I'd love to! I'm a bit busy on Saturday morning, but what about the afternoon?<br>
                **Leo:** That works for me! My brother is in town, so maybe we could all catch a movie? The new superhero film is out.<br>
                **Sarah:** Oh, that sounds fantastic! I've been looking forward to that. We should meet up around 3 PM at the cinema. I can't wait!<br>
                **Leo:** Me too! See you Saturday!
            </div>

            <div class="question-container" id="reading-q1">
                <div class="question">1. Why is Leo calling Sarah?</div>
                <div class="options">
                    <div class="option" data-answer="correct">To make plans for the weekend.</div>
                    <div class="option" data-answer="wrong">To borrow some money.</div>
                    <div class="option" data-answer="wrong">To talk about the weather.</div>
                </div>
            </div>
            
            <div class="question-container" id="reading-q2">
                <div class="question">2. Which part of Saturday is Sarah available?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">The morning.</div>
                    <div class="option" data-answer="correct">The afternoon.</div>
                    <div class="option" data-answer="wrong">All day.</div>
                </div>
            </div>

            <div class="question-container" id="reading-q3">
                <div class="question">3. What does Sarah mean when she says she "can't wait"?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">She is not able to wait.</div>
                    <div class="option" data-answer="correct">She is very excited for the movie.</div>
                    <div class="option" data-answer="wrong">She has to leave soon.</div>
                </div>
            </div>
            
            <div class="feedback-message" id="reading-feedback"></div>
            <button class="btn check-btn" id="reading-check-btn" onclick="checkReadingAnswers()">Check Answers ‚úì</button>
            <button class="btn next-activity-btn" id="reading-next" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
            <button class="btn try-again-btn" id="reading-retry" onclick="retryActivity(2)">Try Again üîÑ</button>
        </div>

        <div class="lesson-card hidden" id="activity3">
            <h2>üí¨ Activity 3: Conversation Gap-Fill</h2>
            <div class="activity-instructions">
                Drag the words from the word bank to the correct empty spaces to complete the conversation.
            </div>
            
            <div class="word-bank-drag" id="wordBankConversation">
                <div class="word-bank-title">üìù Word Bank - Drag these words:</div>
                <span class="word-item-drag" data-word="for ages" draggable="true">for ages</span>
                <span class="word-item-drag" data-word="anything interesting" draggable="true">anything interesting</span>
                <span class="word-item-drag" data-word="just been" draggable="true">just been</span>
                <span class="word-item-drag" data-word="a while" draggable="true">a while</span>
                <span class="word-item-drag" data-word="up to" draggable="true">up to</span>
            </div>
            
            <div class="conversation-container">
                <div class="gap-sentence">**A:** Hey, long time no see! It's been <span class="gap-fill-drop-zone" data-correct="a while"></span>.</div>
                <div class="gap-sentence">**B:** I know! I've been so busy. What have you been <span class="gap-fill-drop-zone" data-correct="up to"></span>?</div>
                <div class="gap-sentence">**A:** Not much, really. I've <span class="gap-fill-drop-zone" data-correct="just been"></span> working a lot. Have you seen <span class="gap-fill-drop-zone" data-correct="anything interesting"></span> lately?</div>
                <div class="gap-sentence">**B:** Oh yes, I went to a great concert! We should catch up properly soon, I haven't seen you <span class="gap-fill-drop-zone" data-correct="for ages"></span>.</div>
            </div>
            
            <button class="btn check-btn" id="conversation-check-btn" onclick="checkConversationFill()">Check Answers ‚úì</button>
            
            <div class="feedback-message" id="conversation-feedback"></div>
            <button class="btn next-activity-btn" id="conversation-next" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
            <button class="btn try-again-btn" id="conversation-retry" onclick="retryActivity(3)">Try Again üîÑ</button>
        </div>

        <div class="lesson-card hidden" id="activity4">
            <h2>‚ñ∂Ô∏è Watch and Learn!</h2>
            <div class="activity-instructions">
                Before the next activity, let's watch a short video to learn new ways to greet people.
            </div>
            <div class="video-container">
                <iframe width="560" height="315" src="https://www.youtube.com/embed/I_tRSrPru94" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            <div class="video-link">
                <a href="https://www.youtube.com/watch?v=I_tRSrPru94" target="_blank">Watch on YouTube ‚ÜóÔ∏è</a>
            </div>
            <button class="btn next-activity-btn" id="video-next" style="display:inline-block;" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
        </div>

        <div class="lesson-card hidden" id="activity5">
            <h2>üí¨ Activity 5: Greetings & Goodbyes</h2>
            <div class="activity-instructions">
                Based on the video, choose the correct option.
            </div>
            <div class="question-container" id="greetings-q1">
                <div class="question">1. Which of these is a casual way to say "hello" from the video?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">"Good day."</div>
                    <div class="option" data-answer="correct">"Hiya."</div>
                    <div class="option" data-answer="wrong">"Greetings."</div>
                </div>
            </div>
            <div class="question-container" id="greetings-q2">
                <div class="question">2. Which of these is not a way to say goodbye?</div>
                <div class="options">
                    <div class="option" data-answer="correct">"Alright!"</div>
                    <div class="option" data-answer="wrong">"See you later!"</div>
                    <div class="option" data-answer="wrong">"Cheerio!"</div>
                </div>
            </div>
            <div class="feedback-message" id="greetings-feedback"></div>
            <button class="btn check-btn" id="greetings-check-btn" onclick="checkGreetingsQuiz()">Check Answers ‚úì</button>
            <button class="btn next-activity-btn" id="greetings-next" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
            <button class="btn try-again-btn" id="greetings-retry" onclick="retryActivity(5)">Try Again üîÑ</button>
        </div>

        <div class="lesson-card hidden" id="activity6">
            <h2>üéØ Activity 6: Drag and Drop - Fill in the Gaps</h2>
            <div class="activity-instructions">
                Drag the words from the word bank to the correct empty spaces to complete the sentences.
            </div>
            
            <div class="word-bank-drag" id="wordBankGap">
                <div class="word-bank-title">üìù Word Bank - Drag these words:</div>
                <span class="word-item-drag" data-word="looking forward to" draggable="true">looking forward to</span>
                <span class="word-item-drag" data-word="this is" draggable="true">this is</span>
                <span class="word-item-drag" data-word="Pleased to meet you" draggable="true">Pleased to meet you</span>
                <span class="word-item-drag" data-word="a bit busy" draggable="true">a bit busy</span>
                <span class="word-item-drag" data-word="can't wait" draggable="true">can't wait</span>
            </div>
            
            <div class="gap-fill-container">
                <div class="gap-sentence">I'm really <span class="gap-fill-drop-zone" data-correct="looking forward to"></span> my vacation next week.</div>
                <div class="gap-sentence">I'm Tim and<span class="gap-fill-drop-zone" data-correct="this is"></span> Georgie.</div>
                <div class="gap-sentence">Hello Sian, my name's Bulli.<span class="gap-fill-drop-zone" data-correct="Pleased to meet you"></span>.</div>
                <div class="gap-sentence">Sorry, I'm <span class="gap-fill-drop-zone" data-correct="a bit busy"></span> at the moment.</div>
                <div class="gap-sentence">I'm so excited about Saturday. I <span class="gap-fill-drop-zone" data-correct="can't wait"></span> to see you.</div>
            </div>
            
            <button class="btn check-btn" id="gap-check-btn" onclick="checkGapFill()">Check Answers ‚úì</button>
            
            <div class="feedback-message" id="gap-feedback"></div>
            <button class="btn next-activity-btn" id="gap-next" onclick="nextActivity()">Continue to Next Activity ‚û°Ô∏è</button>
            <button class="btn try-again-btn" id="gap-retry" onclick="retryActivity(6)">Try Again üîÑ</button>
        </div>

        <div class="lesson-card hidden" id="activity7">
            <h2>üß† Activity 7: Final Quiz</h2>
            <div class="activity-instructions">
                Test your knowledge!
            </div>
            <div class="question-container" id="final-q1">
<div class="question">2. What was the name of the girl wearing a jacket in the video?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">George</div>
                    <div class="option" data-answer="correct">Sian</div>
                    <div class="option" data-answer="wrong">Buli</div>
                </div>
            </div>
            <div class="question-container" id="final-q2">
                <div class="question">3. Which of these is a formal greeting?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">"How's it going?"</div>
                    <div class="option" data-answer="wrong">"What's up?"</div>
                    <div class="option" data-answer="correct">"Pleased to meet you."</div>
                </div>
            </div>
            <div class="question-container" id="final-q3">
                <div class="question">3. What does "Cheerio!" mean?</div>
                <div class="options">
                    <div class="option" data-answer="wrong">I am angry.</div>
                    <div class="option" data-answer="correct">Goodbye.</div>
                    <div class="option" data-answer="wrong">How are you, my friend?</div>
                </div>
            </div>
            <div class="feedback-message" id="final-feedback"></div>
            <button class="btn check-btn" id="final-check-btn" onclick="checkFinalQuiz()">Check Answers ‚úì</button>
            <button class="btn next-activity-btn" id="final-next" onclick="nextActivity()">Show Results ‚û°Ô∏è</button>
            <button class="btn try-again-btn" id="final-retry" onclick="retryActivity(7)">Try Again üîÑ</button>
        </div>

        <div class="lesson-card hidden" id="results">
            <h2>üéâ Congratulations!</h2>
            <div id="finalResults"></div>
            <button class="btn" onclick="restartLesson()">üîÑ Play Again</button>
        </div>
    </div>

    <script>
        // --- Global Variables ---
        let currentActivity = 1;
        let totalPoints = 0;
        let streak = 0;
        let currentLevel = 1;

        const achievements = [
            { points: 100, text: "üåü Getting Started!", unlocked: false },
            { points: 300, text: "üî• On Fire!", unlocked: false },
            { points: 500, text: "üíé Reading Master!", unlocked: false },
            { points: 700, text: "‚ö° Speed Demon!", unlocked: false },
            { points: 1000, text: "üèÜ English Champion!", unlocked: false }
        ];

        // --- Utility Functions ---
        function updateStats() {
            document.getElementById('totalPoints').textContent = totalPoints;
            document.getElementById('streak').textContent = streak;
            document.getElementById('currentLevel').textContent = currentLevel;
            const totalActivities = 7;
            const progress = ((currentActivity - 1) / totalActivities) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            if (totalPoints >= 300 && currentLevel === 1) {
                currentLevel = 2;
                showAchievement("üéä Level Up! Welcome to Level 2!");
            } else if (totalPoints >= 600 && currentLevel === 2) {
                currentLevel = 3;
                showAchievement("üöÄ Level Up! You reached Level 3!");
            }

            achievements.forEach(achievement => {
                if (totalPoints >= achievement.points && !achievement.unlocked) {
                    achievement.unlocked = true;
                    showAchievement(achievement.text);
                }
            });
        }

        function showAchievement(text) {
            const achievement = document.getElementById('achievement');
            achievement.textContent = text;
            achievement.style.display = 'block';
            setTimeout(() => {
                achievement.style.display = 'none';
            }, 3000);
        }

        function showPointsAnimation(points) {
            const animation = document.createElement('div');
            animation.className = 'points-animation';
            animation.textContent = '+' + points + ' points!';
            document.body.appendChild(animation);
            setTimeout(() => {
                animation.remove();
            }, 2000);
        }

        function showSticker(type) {
            const sticker = document.createElement('div');
            sticker.className = 'sticker';
            if (type === 'great') {
                sticker.innerHTML = 'üíØ';
            } else if (type === 'good') {
                sticker.innerHTML = '‚ú®';
            } else {
                sticker.innerHTML = 'ü§î';
            }
            document.body.appendChild(sticker);
            setTimeout(() => {
                sticker.remove();
            }, 1000);
        }

        function showFeedback(activityId, isCorrect, message) {
            const feedbackEl = document.getElementById(activityId + '-feedback');
            feedbackEl.className = 'feedback-message ' + (isCorrect ? 'feedback-correct' : 'feedback-incorrect');
            feedbackEl.textContent = message;
            feedbackEl.style.display = 'block';
            
            const nextBtn = document.getElementById(activityId + '-next');
            const retryBtn = document.getElementById(activityId + '-retry');
            
            if (isCorrect) {
                if (nextBtn) nextBtn.style.display = 'inline-block';
                if (retryBtn) retryBtn.style.display = 'none';
            } else {
                if (nextBtn) nextBtn.style.display = 'none';
                if (retryBtn) retryBtn.style.display = 'inline-block';
            }
        }

        function nextActivity() {
            document.getElementById('activity' + currentActivity).classList.add('hidden');
            currentActivity++;
            if (currentActivity <= 7) {
                setTimeout(() => {
                    const nextActivityEl = document.getElementById('activity' + currentActivity);
                    nextActivityEl.classList.remove('hidden');
                    window.scrollTo({ top: nextActivityEl.offsetTop - 50, behavior: 'smooth' });
                }, 300);
            } else {
                showResults();
            }
        }
        
        function retryActivity(activityNum) {
            if (activityNum === 1) resetMatchingActivity();
            else if (activityNum === 2) resetReadingActivity();
            else if (activityNum === 3) resetConversationFillActivity();
            else if (activityNum === 5) resetGreetingsQuiz();
            else if (activityNum === 6) resetGapFillActivity();
            else if (activityNum === 7) resetFinalQuiz();
        }
        
        function showResults() {
            document.getElementById('results').classList.remove('hidden');
            let grade = 'Good effort!';
            let emoji = 'üòä';
            if (totalPoints >= 800) {
                grade = 'LEGENDARY! üèÜ';
                emoji = 'üèÜ';
            } else if (totalPoints >= 600) {
                grade = 'Excellent! üåü';
                emoji = 'üåü';
            } else if (totalPoints >= 400) {
                grade = 'Very Good! üëç';
                emoji = 'üëç';
            } else if (totalPoints >= 200) {
                grade = 'Good Job! üòä';
                emoji = 'üòä';
            }
            
            const finalResultsText = `${emoji} You completed all activities!\n\nTotal Points: ${totalPoints}\nFinal Level: ${currentLevel}\nGrade: ${grade}\n\nYou've mastered greetings and introductions!`;
            document.getElementById('finalResults').textContent = finalResultsText;
            window.scrollTo({ top: document.getElementById('results').offsetTop - 50, behavior: 'smooth' });
        }

        function restartLesson() {
            currentActivity = 1;
            totalPoints = 0;
            streak = 0;
            currentLevel = 1;
            achievements.forEach(a => a.unlocked = false);
            
            // Reset all activities
            for (let i = 1; i <= 7; i++) {
                if (i !== 4) retryActivity(i);
            }
            
            // Show first activity
            document.querySelectorAll('.lesson-card').forEach(card => card.classList.add('hidden'));
            document.getElementById('activity1').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');
            
            updateStats();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- Activity 1: Matching Game ---
        let selectedVocab = null;
        let selectedDefinition = null;
        let matchesFound = 0;

        function resetMatchingActivity() {
            selectedVocab = null;
            selectedDefinition = null;
            matchesFound = 0;
            document.querySelectorAll('.vocabulary, .definition').forEach(item => {
                item.classList.remove('selected', 'correct', 'incorrect', 'disabled');
            });
            document.getElementById('matchScore').textContent = 'Matches: 0/6';
            document.getElementById('matching-feedback').style.display = 'none';
            document.getElementById('matching-next').style.display = 'none';
        }

        function initializeMatchingGame() {
            document.querySelectorAll('.vocabulary, .definition').forEach(item => {
                item.addEventListener('click', function() {
                    if (this.classList.contains('correct') || this.classList.contains('disabled')) return;
                    
                    if (this.classList.contains('vocabulary')) {
                        if (selectedVocab === this) {
                            selectedVocab.classList.remove('selected');
                            selectedVocab = null;
                        } else {
                            if (selectedVocab) selectedVocab.classList.remove('selected');
                            this.classList.add('selected');
                            selectedVocab = this;
                        }
                    } else if (this.classList.contains('definition')) {
                        if (selectedDefinition === this) {
                            selectedDefinition.classList.remove('selected');
                            selectedDefinition = null;
                        } else {
                            if (selectedDefinition) selectedDefinition.classList.remove('selected');
                            this.classList.add('selected');
                            selectedDefinition = this;
                        }
                    }

                    checkMatch();
                });
            });
        }

        function checkMatch() {
            if (!selectedVocab || !selectedDefinition) return;

            if (selectedVocab.dataset.match === selectedDefinition.dataset.match) {
                // Correct match
                selectedVocab.classList.remove('selected');
                selectedVocab.classList.add('correct');
                selectedDefinition.classList.remove('selected');
                selectedDefinition.classList.add('correct');

                matchesFound++;
                document.getElementById('matchScore').textContent = `Matches: ${matchesFound}/6`;
                totalPoints += 25;
                streak++;
                showPointsAnimation(25);
                showSticker('good');
                updateStats();
                
                if (matchesFound === 6) {
                    totalPoints += 50; // Bonus for completing all
                    showPointsAnimation(50);
                    showFeedback('matching', true, 'Amazing! You matched all the phrases! üéâ');
                }
            } else {
                // Incorrect match
                selectedVocab.classList.remove('selected');
                selectedDefinition.classList.remove('selected');
                selectedVocab.classList.add('incorrect');
                selectedDefinition.classList.add('incorrect');
                
                setTimeout(() => {
                    selectedVocab.classList.remove('incorrect');
                    selectedDefinition.classList.remove('incorrect');
                }, 1000);
                
                streak = 0;
                updateStats();
                showSticker('oops');
            }
            
            selectedVocab = null;
            selectedDefinition = null;
        }

        // --- Activity 2: Reading Comprehension ---
        function initializeReadingActivity() {
            document.querySelectorAll('#activity2 .option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.classList.contains('disabled')) return;
                    
                    const parent = this.closest('.options');
                    parent.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }

        function checkReadingAnswers() {
            let correctAnswers = 0;
            const totalQuestions = 3;
            const answers = [];
            
            // Get all selected answers
            for (let i = 1; i <= 3; i++) {
                const selected = document.querySelector(`#reading-q${i} .option.selected`);
                answers.push(selected);
            }

            // Check if all questions are answered
            if (answers.some(answer => !answer)) {
                showFeedback('reading', false, 'Please answer all three questions before checking.');
                return;
            }

            // Check each answer
            answers.forEach((answer, index) => {
                if (answer.dataset.answer === 'correct') {
                    correctAnswers++;
                    answer.classList.add('correct');
                } else {
                    answer.classList.add('incorrect');
                    // Show correct answer
                    const correctOption = document.querySelector(`#reading-q${index + 1} .option[data-answer="correct"]`);
                    if (correctOption) correctOption.classList.add('correct');
                }
            });
            
            // Disable all options
            document.querySelectorAll('#activity2 .option').forEach(option => option.classList.add('disabled'));
            document.getElementById('reading-check-btn').style.display = 'none';

            if (correctAnswers === totalQuestions) {
                totalPoints += 150;
                streak++;
                updateStats();
                showPointsAnimation(150);
                showSticker('great');
                showFeedback('reading', true, 'Perfect! You answered all the reading comprehension questions correctly! üìö');
            } else {
                totalPoints += correctAnswers * 25; // Partial credit
                streak = 0;
                updateStats();
                showSticker('oops');
                showFeedback('reading', false, `You got ${correctAnswers} out of ${totalQuestions} correct. Keep studying! üìñ`);
            }
        }
        
        function resetReadingActivity() {
            document.querySelectorAll('#activity2 .option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect', 'disabled');
            });
            document.getElementById('reading-check-btn').style.display = 'inline-block';
            document.getElementById('reading-feedback').style.display = 'none';
            document.getElementById('reading-next').style.display = 'none';
            document.getElementById('reading-retry').style.display = 'none';
        }

        // --- Activity 3: Conversation Gap-Fill ---
        let draggedItem = null;

        function initializeConversationFillActivity() {
            const wordBank = document.getElementById('wordBankConversation');
            const words = Array.from(wordBank.children).filter(el => el.classList.contains('word-item-drag'));
            words.sort(() => Math.random() - 0.5);
            words.forEach(word => wordBank.appendChild(word));

            document.querySelectorAll('#activity3 .word-item-drag').forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    if (item.classList.contains('used')) {
                        e.preventDefault();
                        return;
                    }
                    draggedItem = e.target;
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', draggedItem.dataset.word);
                });

                item.addEventListener('dragend', () => {
                    draggedItem = null;
                });
            });

            document.querySelectorAll('#activity3 .gap-fill-drop-zone').forEach(dropZone => {
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                
                dropZone.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    if (!dropZone.textContent.trim()) {
                        dropZone.style.backgroundColor = '#e8f0ff';
                    }
                });
                
                dropZone.addEventListener('dragleave', (e) => {
                    dropZone.style.backgroundColor = '';
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.style.backgroundColor = '';
                    
                    if (!draggedItem) return;
                    
                    const data = e.dataTransfer.getData('text/plain');
                    
                    if (!dropZone.textContent.trim()) {
                        dropZone.textContent = data;
                        dropZone.classList.add('filled');
                        draggedItem.classList.add('used');
                        draggedItem.draggable = false;
                    }
                });

                dropZone.addEventListener('click', () => {
                    if (dropZone.textContent.trim()) {
                        const word = dropZone.textContent.trim();
                        const wordItem = document.querySelector(`#activity3 .word-item-drag[data-word="${word}"]`);
                        if (wordItem) {
                            wordItem.classList.remove('used');
                            wordItem.draggable = true;
                        }
                        dropZone.textContent = '';
                        dropZone.classList.remove('filled');
                    }
                });
            });
        }
        
        function checkConversationFill() {
            const dropZones = document.querySelectorAll('#activity3 .gap-fill-drop-zone');
            let correctCount = 0;
            const totalZones = dropZones.length;

            dropZones.forEach(zone => {
                const userAnswer = zone.textContent.trim().toLowerCase();
                const correctAnswer = zone.dataset.correct.toLowerCase();
                
                if (userAnswer === correctAnswer) {
                    zone.classList.add('correct-answer');
                    correctCount++;
                } else {
                    zone.classList.add('incorrect-answer');
                }
            });

            document.getElementById('conversation-check-btn').style.display = 'none';

            if (correctCount === totalZones) {
                totalPoints += 120;
                streak++;
                updateStats();
                showPointsAnimation(120);
                showSticker('great');
                showFeedback('conversation', true, 'Excellent! You completed the conversation correctly! üéØ');
            } else {
                totalPoints += correctCount * 15;
                streak = 0;
                updateStats();
                showSticker('oops');
                showFeedback('conversation', false, `You got ${correctCount} out of ${totalZones} correct. Try again! üîÑ`);
            }
        }
        
        function resetConversationFillActivity() {
            document.querySelectorAll('#activity3 .gap-fill-drop-zone').forEach(zone => {
                zone.textContent = '';
                zone.classList.remove('filled', 'correct-answer', 'incorrect-answer');
                zone.style.backgroundColor = '';
            });
            
            document.querySelectorAll('#activity3 .word-item-drag').forEach(item => {
                item.classList.remove('used');
                item.draggable = true;
            });
            
            document.getElementById('conversation-check-btn').style.display = 'inline-block';
            document.getElementById('conversation-feedback').style.display = 'none';
            document.getElementById('conversation-next').style.display = 'none';
            document.getElementById('conversation-retry').style.display = 'none';
            
            const wordBank = document.getElementById('wordBankConversation');
            const words = Array.from(wordBank.children).filter(el => el.classList.contains('word-item-drag'));
            words.sort(() => Math.random() - 0.5);
            words.forEach(word => wordBank.appendChild(word));
        }

        // --- Activity 5: Greetings & Goodbyes Quiz ---
        function initializeGreetingsQuiz() {
            document.querySelectorAll('#activity5 .option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.classList.contains('disabled')) return;
                    
                    const parent = this.closest('.options');
                    parent.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }
        
        function checkGreetingsQuiz() {
            let correctAnswers = 0;
            const totalQuestions = 2;
            const answers = [];
            
            for (let i = 1; i <= 2; i++) {
                const selected = document.querySelector(`#greetings-q${i} .option.selected`);
                answers.push(selected);
            }

            if (answers.some(answer => !answer)) {
                showFeedback('greetings', false, 'Please answer both questions before checking.');
                return;
            }

            answers.forEach((answer, index) => {
                if (answer.dataset.answer === 'correct') {
                    correctAnswers++;
                    answer.classList.add('correct');
                } else {
                    answer.classList.add('incorrect');
                    const correctOption = document.querySelector(`#greetings-q${index + 1} .option[data-answer="correct"]`);
                    if (correctOption) correctOption.classList.add('correct');
                }
            });
            
            document.querySelectorAll('#activity5 .option').forEach(option => option.classList.add('disabled'));
            document.getElementById('greetings-check-btn').style.display = 'none';

            if (correctAnswers === totalQuestions) {
                totalPoints += 100;
                streak++;
                updateStats();
                showPointsAnimation(100);
                showSticker('great');
                showFeedback('greetings', true, 'You got them all correct! You\'re a pro at greetings! üëã');
            } else {
                totalPoints += correctAnswers * 25;
                streak = 0;
                updateStats();
                showSticker('oops');
                showFeedback('greetings', false, `You got ${correctAnswers} out of ${totalQuestions} correct. Try again to master the greetings!`);
            }
        }
        
        function resetGreetingsQuiz() {
            document.querySelectorAll('#activity5 .option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect', 'disabled');
            });
            document.getElementById('greetings-check-btn').style.display = 'inline-block';
            document.getElementById('greetings-feedback').style.display = 'none';
            document.getElementById('greetings-next').style.display = 'none';
            document.getElementById('greetings-retry').style.display = 'none';
        }


        // --- Activity 6: Drag and Drop Fill in the Gaps ---
        function initializeGapFillActivity() {
            const wordBank = document.getElementById('wordBankGap');
            const words = Array.from(wordBank.children).filter(el => el.classList.contains('word-item-drag'));
            words.sort(() => Math.random() - 0.5);
            words.forEach(word => wordBank.appendChild(word));

            document.querySelectorAll('#activity6 .word-item-drag').forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    if (item.classList.contains('used')) {
                        e.preventDefault();
                        return;
                    }
                    draggedItem = e.target;
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', draggedItem.dataset.word);
                });

                item.addEventListener('dragend', () => {
                    draggedItem = null;
                });
            });

            document.querySelectorAll('#activity6 .gap-fill-drop-zone').forEach(dropZone => {
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                
                dropZone.addEventListener('dragenter', (e) => {
                    e.preventDefault();
                    if (!dropZone.textContent.trim()) {
                        dropZone.style.backgroundColor = '#e8f0ff';
                    }
                });
                
                dropZone.addEventListener('dragleave', (e) => {
                    dropZone.style.backgroundColor = '';
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.style.backgroundColor = '';
                    
                    if (!draggedItem) return;
                    
                    const data = e.dataTransfer.getData('text/plain');
                    
                    if (!dropZone.textContent.trim()) {
                        dropZone.textContent = data;
                        dropZone.classList.add('filled');
                        draggedItem.classList.add('used');
                        draggedItem.draggable = false;
                    }
                });

                dropZone.addEventListener('click', () => {
                    if (dropZone.textContent.trim()) {
                        const word = dropZone.textContent.trim();
                        const wordItem = document.querySelector(`#activity6 .word-item-drag[data-word="${word}"]`);
                        if (wordItem) {
                            wordItem.classList.remove('used');
                            wordItem.draggable = true;
                        }
                        dropZone.textContent = '';
                        dropZone.classList.remove('filled');
                    }
                });
            });
        }

        function checkGapFill() {
            const dropZones = document.querySelectorAll('#activity6 .gap-fill-drop-zone');
            let correctCount = 0;
            const totalZones = dropZones.length;

            dropZones.forEach(zone => {
                const userAnswer = zone.textContent.trim().toLowerCase();
                const correctAnswer = zone.dataset.correct.toLowerCase();
                
                if (userAnswer === correctAnswer) {
                    zone.classList.add('correct-answer');
                    correctCount++;
                } else {
                    zone.classList.add('incorrect-answer');
                }
            });

            document.getElementById('gap-check-btn').style.display = 'none';

            if (correctCount === totalZones) {
                totalPoints += 120;
                streak++;
                updateStats();
                showPointsAnimation(120);
                showSticker('great');
                showFeedback('gap', true, 'Excellent! You completed the conversation correctly! üéØ');
            } else {
                totalPoints += correctCount * 15;
                streak = 0;
                updateStats();
                showSticker('oops');
                showFeedback('gap', false, `You got ${correctCount} out of ${totalZones} correct. Try again! üîÑ`);
            }
        }

        function resetGapFillActivity() {
            document.querySelectorAll('#activity6 .gap-fill-drop-zone').forEach(zone => {
                zone.textContent = '';
                zone.classList.remove('filled', 'correct-answer', 'incorrect-answer');
                zone.style.backgroundColor = '';
            });
            
            document.querySelectorAll('#activity6 .word-item-drag').forEach(item => {
                item.classList.remove('used');
                item.draggable = true;
            });
            
            document.getElementById('gap-check-btn').style.display = 'inline-block';
            document.getElementById('gap-feedback').style.display = 'none';
            document.getElementById('gap-next').style.display = 'none';
            document.getElementById('gap-retry').style.display = 'none';
            
            const wordBank = document.getElementById('wordBankGap');
            const words = Array.from(wordBank.children).filter(el => el.classList.contains('word-item-drag'));
            words.sort(() => Math.random() - 0.5);
            words.forEach(word => wordBank.appendChild(word));
        }

        // --- Activity 7: Final Quiz ---
        function initializeFinalQuiz() {
            document.querySelectorAll('#activity7 .option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.classList.contains('disabled')) return;
                    
                    const parent = this.closest('.options');
                    parent.querySelectorAll('.option').forEach(o => o.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }
        
        function checkFinalQuiz() {
            let correctAnswers = 0;
            const totalQuestions = 3;
            const answers = [];
            
            for (let i = 1; i <= 3; i++) {
                const selected = document.querySelector(`#final-q${i} .option.selected`);
                answers.push(selected);
            }

            if (answers.some(answer => !answer)) {
                showFeedback('final', false, 'Please answer all three questions before checking.');
                return;
            }

            answers.forEach((answer, index) => {
                if (answer.dataset.answer === 'correct') {
                    correctAnswers++;
                    answer.classList.add('correct');
                } else {
                    answer.classList.add('incorrect');
                    const correctOption = document.querySelector(`#final-q${index + 1} .option[data-answer="correct"]`);
                    if (correctOption) correctOption.classList.add('correct');
                }
            });
            
            document.querySelectorAll('#activity7 .option').forEach(option => option.classList.add('disabled'));
            document.getElementById('final-check-btn').style.display = 'none';

            if (correctAnswers === totalQuestions) {
                totalPoints += 200;
                streak++;
                updateStats();
                showPointsAnimation(200);
                showSticker('great');
                showFeedback('final', true, 'Amazing! You passed the final test with flying colors! üèÜ');
            } else {
                totalPoints += correctAnswers * 30;
                streak = 0;
                updateStats();
                showSticker('oops');
                showFeedback('final', false, `You got ${correctAnswers} out of ${totalQuestions} correct. Time to review! üìù`);
            }
        }
        
        function resetFinalQuiz() {
            document.querySelectorAll('#activity7 .option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect', 'disabled');
            });
            document.getElementById('final-check-btn').style.display = 'inline-block';
            document.getElementById('final-feedback').style.display = 'none';
            document.getElementById('final-next').style.display = 'none';
            document.getElementById('final-retry').style.display = 'none';
        }

        // --- Initialization ---
        function initializeGame() {
            updateStats();
            initializeMatchingGame();
            initializeReadingActivity();
            initializeConversationFillActivity();
            initializeGreetingsQuiz();
            initializeGapFillActivity();
            initializeFinalQuiz();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>
