<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Istanbul's Grand Bazaar - English Lesson</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(45deg, #1A5276, #008080);
            margin: -20px -20px 30px -20px;
            border-radius: 15px 15px 0 0;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .lesson-level {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .exercise, .reading-section, .video-section, .discussion-box, .grammar-section, .idioms-section {
            background: #f8f9fa;
            margin: 25px 0;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .exercise h3, .reading-section h3, .video-section h3, .discussion-box h3, .grammar-section h3, .idioms-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
        }
        
        .exercise-number {
            background: #FFD700;
            color: #333;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }

        .video-section h2 {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .video-link {
            display: inline-block;
            background: #008080;
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 25px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px;
        }
        
        .vocab-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .vocab-words, .vocab-definitions {
            background: #e6f7ff;
            padding: 20px;
            border-radius: 8px;
        }
        
        .vocab-item {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            user-select: none;
        }
        
        .vocab-item:hover:not(.matched) {
            border-color: #008080;
        }
        
        .vocab-item.selected {
            background: #FFD700;
        }
        
        .vocab-item.matched {
            cursor: default;
        }
        
        /* Different colors for each correct match pair */
        .vocab-item.matched-pair-1 { background: #4CAF50; color: white; border-color: #4CAF50; }
        .vocab-item.matched-pair-2 { background: #2196F3; color: white; border-color: #2196F3; }
        .vocab-item.matched-pair-3 { background: #FF9800; color: white; border-color: #FF9800; }
        .vocab-item.matched-pair-4 { background: #9C27B0; color: white; border-color: #9C27B0; }
        .vocab-item.matched-pair-5 { background: #00BCD4; color: white; border-color: #00BCD4; }
        .vocab-item.matched-pair-6 { background: #8BC34A; color: white; border-color: #8BC34A; }
        .vocab-item.matched-pair-7 { background: #FF5722; color: white; border-color: #FF5722; }
        .vocab-item.matched-pair-8 { background: #795548; color: white; border-color: #795548; }
        .vocab-item.matched-pair-9 { background: #607D8B; color: white; border-color: #607D8B; }
        .vocab-item.matched-pair-10 { background: #E91E63; color: white; border-color: #E91E63; }
        
        .vocab-item.incorrect-match {
            background: #F44336;
            color: white;
            border-color: #F44336;
        }
        
        .mc-question, .tf-question {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .mc-option {
            padding: 12px;
            margin: 10px 0;
            background: #f0f0f0;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mc-option:hover {
            border-color: #FFD700;
        }
        
        .mc-option.selected {
            background: #FFD700;
        }
        
        .mc-option.correct {
            background: #4CAF50;
            color: white;
        }
        
        .mc-option.incorrect {
            background: #F44336;
            color: white;
        }

        .tf-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin: 10px 0;
            justify-content: space-between;
        }
        
        .tf-buttons {
            display: flex;
            gap: 10px;
        }
        
        .tf-button {
            padding: 8px 16px;
            border: 2px solid;
            background: #f0f0f0;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .tf-button.selected-true {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .tf-button.selected-false {
            background: #F44336;
            color: white;
            border-color: #F44336;
        }

        .gap-fill-container {
            border: 2px dashed #ccc;
            padding: 10px;
            min-height: 50px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .gap-fill-target {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            width: 120px;
            height: 35px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .gap-fill-target.filled {
            background-color: #e6f7ff;
            cursor: pointer;
        }

        .gap-fill-word {
            background: #1A5276;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
        }

        .gap-fill-word.selected {
            background: #FFD700;
            color: #333;
            border: 2px solid #1A5276;
        }
        
        .gap-fill-word.used {
            text-decoration: line-through;
            cursor: default;
        }

        .gap-fill-word.hidden {
            display: none;
        }
        
        .gap-fill-area input {
            border: none;
            border-bottom: 2px solid #FFD700;
            padding: 8px;
            margin: 0 5px;
            width: 160px;
            text-align: center;
            font-size: 16px;
            background: #f8f9fa;
        }

        .check-button {
            background: linear-gradient(45deg, #1A5276, #008080);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 20px 10px 10px 0;
            transition: all 0.3s ease;
        }
        
        .reset-button {
            background: #6c757d;
        }

        .show-answers-button {
            background: #17a2b8;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            display: none;
        }
        
        .correct {
            background: #d4edda;
            color: #155724;
        }
        
        .incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .reading-text {
            background: white;
            padding: 20px;
            border-left: 5px solid #008080;
            border-radius: 8px;
        }

        .reading-text p {
            margin-bottom: 1em;
            text-align: justify;
        }

        .notes-area {
            background: white;
            padding: 20px;
            border-radius: 8px;
        }

        .notes-area h4 {
            margin-bottom: 10px;
        }

        .notes-area textarea {
            width: 100%;
            height: 120px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            resize: vertical;
        }

        .discussion-box {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #333;
        }

        .discussion-questions {
            list-style: none;
            padding: 0;
        }
        
        .discussion-questions li {
            margin: 10px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .discussion-questions li::before {
            content: "üí≠";
            position: absolute;
            left: 0;
        }

        .word-box-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .word-box-options span {
            background: #fff;
            padding: 5px 10px;
            border: 1px solid #add8e6;
            border-radius: 15px;
            font-weight: bold;
        }

        .gap-fill-word {
            background: #1A5276 !important;
            color: white !important;
            padding: 8px 15px !important;
            border-radius: 20px !important;
            cursor: pointer !important;
            user-select: none !important;
            transition: all 0.2s ease !important;
            display: inline-block !important;
            margin: 5px !important;
            font-weight: bold !important;
            border: 1px solid #1A5276 !important;
            min-width: 80px !important;
            text-align: center !important;
        }

        .idiom-section-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .idiom-list, .idiom-definitions {
            list-style: none;
            padding: 0;
        }

        .idiom-list li, .idiom-definitions li {
            background: #fff;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .idiom-list li:hover:not(.matched), .idiom-definitions li:hover:not(.matched) {
            border-color: #008080;
        }

        .idiom-list li.selected, .idiom-definitions li.selected {
            background: #FFD700;
        }

        /* Different colors for each idiom match pair */
        .idiom-list li.matched-pair-1, .idiom-definitions li.matched-pair-1 { background: #4CAF50; color: white; border-color: #4CAF50; }
        .idiom-list li.matched-pair-2, .idiom-definitions li.matched-pair-2 { background: #2196F3; color: white; border-color: #2196F3; }
        .idiom-list li.matched-pair-3, .idiom-definitions li.matched-pair-3 { background: #FF9800; color: white; border-color: #FF9800; }
        .idiom-list li.matched-pair-4, .idiom-definitions li.matched-pair-4 { background: #9C27B0; color: white; border-color: #9C27B0; }
        .idiom-list li.matched-pair-5, .idiom-definitions li.matched-pair-5 { background: #00BCD4; color: white; border-color: #00BCD4; }

        .idiom-list li.matched, .idiom-definitions li.matched {
            cursor: default;
        }

        .idiom-list li.incorrect-match, .idiom-definitions li.incorrect-match {
            background: #F44336;
            color: white;
            border-color: #F44336;
        }

        .idiom-gap-fill p {
            margin-bottom: 10px;
        }

        .idiom-gap-fill input {
            border: none;
            border-bottom: 2px solid #FFD700;
            padding: 8px;
            margin: 0 5px;
            width: 180px;
            text-align: center;
            font-size: 16px;
            background: #f8f9fa;
        }
        
        .grammar-explanation {
            background: #e6f7ff;
            padding: 15px;
            border-left: 5px solid #008080;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .grammar-explanation p {
            margin-bottom: 5px;
        }
        
        .grammar-explanation em {
            font-style: italic;
            color: #1A5276;
        }

        .grammar-question {
            margin-bottom: 20px;
        }

        .grammar-question p {
            margin-bottom: 5px;
        }

        .grammar-question input {
            border: none;
            border-bottom: 2px solid #FFD700;
            padding: 8px;
            width: 250px;
            font-size: 16px;
            background: #f8f9fa;
        }
        
        @media (max-width: 768px) {
            .vocab-section {
                grid-template-columns: 1fr;
            }
            .idiom-section-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üïå Istanbul's Grand Bazaar</h1>
            <p class="lesson-level">An Interactive English Lesson - Upper-Intermediate/Advanced Level</p>
        </div>
        
        <div class="exercise">
            <h3><span class="exercise-number">1</span>Vocabulary Match üéØ</h3>
            <p>Match the words with their definitions. Click on a word, then click on its matching definition:</p>
            <div class="vocab-section">
                <div class="vocab-words">
                    <h4>üìù Words</h4>
                </div>
                <div class="vocab-definitions">
                    <h4>üìñ Definitions</h4>
                </div>
            </div>
            <button class="check-button reset-button" onclick="resetVocab()">Reset</button>
            <button class="check-button show-answers-button" onclick="showVocabAnswers()">Show Answers</button>
            <div id="vocab-result" class="result"></div>
        </div>

        <div class="reading-section">
            <h3><span class="exercise-number">2</span>Reading Text üìñ</h3>
            <div class="reading-text">
                <h4>The Heart of Istanbul: A Journey Through Time</h4>
                <p>Istanbul's Grand Bazaar, known locally as Kapalƒ± √áar≈üƒ±sƒ±, stands as one of the world's most remarkable commercial centers. This architectural marvel spans over 30,000 square meters and houses approximately 3,600 shops across 60 lanes, making it not just a market, but truly a city within a city.</p>
                <p>The bazaar's roots trace back to the 15th century when Sultan Mehmet II established it following his conquest of Constantinople in 1453. Originally designed for trading textiles and precious jewelry, the market gradually evolved into a global commercial hub that connected European and Asian trade routes. The Ottoman influence is still palpable today, creating a unique atmosphere where East meets West.</p>
                <p>What makes the Grand Bazaar particularly special is its human element. Approximately 25,000 people work within its walls, many of whom have inherited their trades from previous generations. Family businesses passed down through decades create an authentic shopping experience that cannot be replicated in modern malls. The art of carpet weaving, for instance, carries deep cultural significance, with each pattern and color combination telling stories of different Turkish regions.</p>
                <p>The sensory experience is overwhelming yet captivating. The constant buzz of conversation in multiple languages, the aroma of spices and Turkish tea, and the glittering displays of gold, silver, and precious stones create an atmosphere that engages all five senses. With an estimated 400,000 daily visitors, the bazaar remains one of Istanbul's most visited attractions, testament to its enduring appeal in our digital age.</p>
            </div>
        </div>
        
        <div class="exercise">
            <h3><span class="exercise-number">3</span>Reading Comprehension üìù</h3>
            <p>Choose the best answer (A, B, C, or D):</p>
            <div class="mc-question">
                <p><strong>1. The Grand Bazaar is described as "a city within a city" because:</strong></p>
                <div class="mc-option" data-question="1" data-correct="false">A) It has its own government</div>
                <div class="mc-option" data-question="1" data-correct="true">B) It covers a large area with many shops and workers</div>
                <div class="mc-option" data-question="1" data-correct="false">C) It's completely separated from Istanbul</div>
                <div class="mc-option" data-question="1" data-correct="false">D) It has residential areas inside</div>
            </div>
            <div class="mc-question">
                <p><strong>2. The bazaar was originally established:</strong></p>
                <div class="mc-option" data-question="2" data-correct="false">A) In the 14th century for spice trading</div>
                <div class="mc-option" data-question="2" data-correct="false">B) After World War I for tourism</div>
                <div class="mc-option" data-question="2" data-correct="true">C) In the 15th century for textiles and jewelry</div>
                <div class="mc-option" data-question="2" data-correct="false">D) During the Roman Empire</div>
            </div>
            <div class="mc-question">
                <p><strong>3. The human element that makes the bazaar special refers to:</strong></p>
                <div class="mc-option" data-question="3" data-correct="false">A) The large number of tourists</div>
                <div class="mc-option" data-question="3" data-correct="false">B) The modern shopping facilities</div>
                <div class="mc-option" data-question="3" data-correct="true">C) The family businesses passed down through generations</div>
                <div class="mc-option" data-question="3" data-correct="false">D) The international atmosphere</div>
            </div>
            <div class="mc-question">
                <p><strong>4. According to the text, what makes the shopping experience "authentic"?</strong></p>
                <div class="mc-option" data-question="4" data-correct="false">A) The modern payment systems</div>
                <div class="mc-option" data-question="4" data-correct="false">B) The air conditioning</div>
                <div class="mc-option" data-question="4" data-correct="true">C) The inherited family trades and traditions</div>
                <div class="mc-option" data-question="4" data-correct="false">D) The tourist information centers</div>
            </div>
            <div class="mc-question">
                <p><strong>5. The bazaar's daily visitor estimate suggests:</strong></p>
                <div class="mc-option" data-question="5" data-correct="false">A) It's losing popularity</div>
                <div class="mc-option" data-question="5" data-correct="true">B) It remains highly attractive to people</div>
                <div class="mc-option" data-question="5" data-correct="false">C) Only locals shop there</div>
                <div class="mc-option" data-question="5" data-correct="false">D) It's too crowded to enjoy</div>
            </div>
            <button class="check-button" onclick="checkMultipleChoice()">Check Answers</button>
            <div id="mc-result" class="result"></div>
        </div>

        <div class="video-section">
            <h3><span class="exercise-number">4</span>Video Viewing üé¨</h3>
            <h2>Istanbul's Grand Bazaar - What You Need to Know</h2>
            <div class="video-wrapper">
                <iframe src="https://www.youtube.com/embed/QcMdaKKWGwA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
            <p>Watch the video and take notes on the points below.</p>
            <a href="https://www.youtube.com/watch?v=QcMdaKKWGwA" class="video-link" target="_blank">üé¨ Open on YouTube (if embed doesn't work)</a>
            <div class="notes-area">
                <h4>Take notes while watching about:</h4>
                <ul>
                    <li>What people buy at the bazaar</li>
                    <li>The haggling/bargaining process</li>
                    <li>Interesting facts about the market</li>
                    <li>The tea culture connection</li>
                </ul>
                <textarea placeholder="Write your notes here..."></textarea>
            </div>
        </div>

        <div class="exercise">
            <h3><span class="exercise-number">5</span>True/False Statements ‚úÖ‚ùå</h3>
            <p>Based on the video, mark these statements as True (T) or False (F):</p>
            <div class="tf-item" data-answer="true">
                <span>The Grand Bazaar has exactly 21 gates leading into it.</span>
                <div class="tf-buttons">
                    <button class="tf-button tf-true">True</button>
                    <button class="tf-button tf-false">False</button>
                </div>
            </div>
            <div class="tf-item" data-answer="true">
                <span>Each carpet pattern has its own meaning and significance.</span>
                <div class="tf-buttons">
                    <button class="tf-button tf-true">True</button>
                    <button class="tf-button tf-false">False</button>
                </div>
            </div>
            <div class="tf-item" data-answer="false">
                <span>The bazaar was founded by Sultan Mehmet II in the 16th century.</span>
                <div class="tf-buttons">
                    <button class="tf-button tf-true">True</button>
                    <button class="tf-button tf-false">False</button>
                </div>
            </div>
            <div class="tf-item" data-answer="false">
                <span>The cameraman bought more items than the reporter in the challenge.</span>
                <div class="tf-buttons">
                    <button class="tf-button tf-true">True</button>
                    <button class="tf-button tf-false">False</button>
                </div>
            </div>
            <div class="tf-item" data-answer="false">
                <span>On Turkish carpets, running water symbolises life and an eye means wisdom.</span>
                <div class="tf-buttons">
                    <button class="tf-button tf-true">True</button>
                    <button class="tf-button tf-false">False</button>
                </div>
            </div>
            <button class="check-button" onclick="checkTrueFalse()">Check Answers</button>
            <div id="tf-result" class="result"></div>
        </div>

        <div class="exercise">
            <h3><span class="exercise-number">6</span>Gap Fill Exercise üìù</h3>
            <p>Select a word from the bank, then click a gap to fill it. Click a filled gap to put the word back.</p>
            <div id="word-bank" class="word-box-options">
            </div>
            <div class="gap-fill-area">
                <p>1. The sensory experience of the bazaar can be quite <input type="text" data-word="overwhelming" readonly> for first-time visitors.</p>
                <p>2. It's important to <input type="text" data-word="haggle" readonly> prices in Turkish markets - it's expected!</p>
                <p>3. Many families have been running their businesses for several <input type="text" data-word="decades" readonly>.</p>
                <p>4. The bazaar was established after the <input type="text" data-word="conquest" readonly> of Constantinople.</p>
                <p>5. Roving <input type="text" data-word="merchants" readonly> sell tea throughout the market using a phone system.</p>
                <p>6. Some designer brands sold there are <input type="text" data-word="genuine" readonly>, while others are fake.</p>
                <p>7. Bargaining is a cultural <input type="text" data-word="tradition" readonly> that tourists should embrace.</p>
                <p>8. Always do a price <input type="text" data-word="comparison" readonly> before making your final purchase.</p>
                <p>9. The carpet seller learned to <input type="text" data-word="negotiate" readonly> with customers from his father.</p>
                <p>10. The bazaar represents Turkey's rich cultural <input type="text" data-word="heritage" readonly>.</p>
            </div>
            <button class="check-button" onclick="checkGapFill()">Check Answers</button>
            <button class="check-button reset-button" onclick="resetGapFill()">Reset</button>
            <div id="gap-result" class="result"></div>
        </div>

        <div class="idioms-section">
            <h3><span class="exercise-number">7</span>Useful Idioms & Expressions üí¨</h3>
            <p>Market & Shopping Idioms:</p>
            
            <h4>Match the Idiom to the Definition:</h4>
            <div class="idiom-section-content">
                <ul class="idiom-list">
                </ul>
                <ul class="idiom-definitions">
                </ul>
            </div>
            <button class="check-button reset-button" onclick="resetIdiomMatch()">Reset</button>
            <button class="check-button show-answers-button" onclick="showIdiomAnswers()">Show Answers</button>
            <div id="idiom-match-result" class="result"></div>
            
            <h4>Fill in the Gaps with the Correct Idiom:</h4>
            <div class="idiom-gap-fill">
                <p>1. I found this antique vase at a flea market. It was a real <input type="text" id="idiom-gap-1">!</p>
                <p>2. My dad said we can't buy the new car until we <input type="text" id="idiom-gap-2"> with the salesman.</p>
                <p>3. This coffee is ‚Ç¨10! That's <input type="text" id="idiom-gap-3">.</p>
                <p>4. I always <input type="text" id="idiom-gap-4"> before buying a new phone to make sure I get the best deal.</p>
                <p>5. The company's huge advertising budget shows that <input type="text" id="idiom-gap-5"> when it comes to attracting customers.</p>
            </div>
            <button class="check-button" onclick="checkIdiomGapFill()">Check Answers</button>
            <div id="idiom-gap-result" class="result"></div>
        </div>
        
        <div class="grammar-section">
            <h3><span class="exercise-number">8</span>Grammar Focus: Present Perfect Continuous üìö</h3>
            <div class="grammar-explanation">
                <p>We use the <strong>Present Perfect Continuous</strong> to talk about an action that started in the past and is still continuing now, or has just finished and has a visible result. We often use it with <em>'for'</em> and <em>'since'</em> or to explain a current situation.</p>
                <p><em>Example: "The tourists have been waiting in line for hours."</em></p>
                <p>The form is: <strong>have/has + been + verb-ing</strong></p>
            </div>
            <p>Complete the sentences using the Present Perfect Continuous form of the verbs in brackets:</p>
            <div class="grammar-question">
                <p>1. The Grand Bazaar <input type="text" id="g1"> (attract) visitors for centuries.</p>
                <p>2. The merchants <input type="text" id="g2"> (sell) their goods all morning.</p>
                <p>3. How long <input type="text" id="g3"> you <input type="text" id="g4"> (learn) English?</p>
                <p>4. He <input type="text" id="g5"> (haggle) for twenty minutes, but still hasn't got a good price.</p>
                <p>5. The tourists are tired because they <input type="text" id="g6"> (walk) around the market all day.</p>
            </div>
            <button class="check-button" onclick="checkGrammar()">Check Answers</button>
            <div id="grammar-result" class="result"></div>
        </div>

        <div class="discussion-box">
            <h3>üí¨ Discussion Questions üó£Ô∏è</h3>
            <ul class="discussion-questions">
                <li>What's the most interesting market or bazaar you've ever visited? Describe the experience.</li>
                <li>Do you enjoy bargaining/haggling? Why or why not?</li>
                <li>How can traditional markets like the Grand Bazaar balance preserving their cultural heritage with meeting modern consumer expectations?</li>
                <li>What might be the positive and negative effects of such heavy tourism on local culture and business?</li>
                <li>Why do you think people are drawn to traditional markets when they could shop more conveniently online or in modern malls?</li>
                <li>What are the advantages and disadvantages of family businesses compared to modern corporations?</li>
                <li>How can tourists distinguish between genuine and fake products? Is it always important to buy authentic items?</li>
            </ul>
        </div>
        
    </div>
    
    <script>
        // Fisher-Yates shuffle algorithm
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        let vocabData = [
            { word: "haggle", def: "To negotiate the price of something" },
            { word: "bazaar", def: "A large marketplace, especially in Middle Eastern countries" },
            { word: "overwhelming", def: "Very intense or powerful; difficult to deal with" },
            { word: "tourist", def: "A person who travels for pleasure" },
            { word: "souvenirs", def: "Items kept as reminders of a place" },
            { word: "merchant", def: "A person who buys and sells goods" },
            { word: "hub", def: "The center of activity or interest" },
            { word: "genuine", def: "Real, not fake or copied" },
            { word: "conquest", def: "The act of taking control of a place by force" },
            { word: "landmark", def: "A recognizable feature of a landscape or city" }
        ];

        let idiomData = [
            { idiom: "Shop around", def: "Compare prices at different stores" },
            { idiom: "A steal", def: "A very good bargain" },
            { idiom: "Highway robbery", def: "Extremely expensive" },
            { idiom: "To strike a deal", def: "To reach an agreement" },
            { idiom: "Money talks", def: "Money gives you power/influence" }
        ];

        let selectedWord = null;
        let selectedDefinition = null;
        let vocabMatches = 0;
        let vocabPairCounter = 1;

        let selectedIdiom = null;
        let selectedIdiomDef = null;
        let idiomMatches = 0;
        let idiomPairCounter = 1;

        document.addEventListener('DOMContentLoaded', function() {
            initVocabulary();
            initMultipleChoice();
            initTrueFalse();
            initGapFill();
            initIdiomMatch();
        });

        function initVocabulary() {
            const wordsContainer = document.querySelector('.vocab-words');
            const defsContainer = document.querySelector('.vocab-definitions');

            // Shuffle both arrays independently
            shuffleArray(vocabData);
            const defsArray = [...vocabData];
            shuffleArray(defsArray);

            wordsContainer.innerHTML = '<h4>üìù Words</h4>';
            defsContainer.innerHTML = '<h4>üìñ Definitions</h4>';

            vocabData.forEach(item => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'vocab-item';
                wordDiv.dataset.word = item.word;
                wordDiv.textContent = item.word;
                wordDiv.addEventListener('click', () => selectVocabItem(wordDiv, 'word'));
                wordsContainer.appendChild(wordDiv);
            });

            defsArray.forEach(item => {
                const defDiv = document.createElement('div');
                defDiv.className = 'vocab-item';
                defDiv.dataset.def = item.word;
                defDiv.textContent = item.def;
                defDiv.addEventListener('click', () => selectVocabItem(defDiv, 'def'));
                defsContainer.appendChild(defDiv);
            });
        }
        
        function selectVocabItem(element, type) {
            if (element.classList.contains('matched')) return;
            
            if (type === 'word') {
                if (selectedWord) selectedWord.classList.remove('selected');
                selectedWord = element;
            } else {
                if (selectedDefinition) selectedDefinition.classList.remove('selected');
                selectedDefinition = element;
            }
            
            element.classList.add('selected');
            checkVocabMatch();
        }
        
        function checkVocabMatch() {
            if (selectedWord && selectedDefinition) {
                if (selectedWord.dataset.word === selectedDefinition.dataset.def) {
                    // Correct match - assign unique color pair
                    selectedWord.classList.add('matched', `matched-pair-${vocabPairCounter}`);
                    selectedDefinition.classList.add('matched', `matched-pair-${vocabPairCounter}`);
                    
                    // Reset selected variables after a correct match
                    selectedWord.classList.remove('selected');
                    selectedDefinition.classList.remove('selected');
                    selectedWord = null;
                    selectedDefinition = null;

                    vocabMatches++;
                    vocabPairCounter++;
                    
                    if (vocabMatches === 10) {
                        showResult('vocab-result', true, 'Perfect! All vocabulary matches are correct!');
                    }
                } else {
                    // Incorrect match - show red briefly
                    selectedWord.classList.add('incorrect-match');
                    selectedDefinition.classList.add('incorrect-match');
                    setTimeout(() => {
                        selectedWord.classList.remove('selected', 'incorrect-match');
                        selectedDefinition.classList.remove('selected', 'incorrect-match');
                        selectedWord = null;
                        selectedDefinition = null;
                    }, 800);
                }
            }
        }

        function showVocabAnswers() {
            // Clear any existing matches and show all correct pairs
            document.querySelectorAll('.vocab-item').forEach(item => {
                item.classList.remove('selected', 'matched', 'incorrect-match');
                // Remove all pair classes
                for(let i = 1; i <= 10; i++) {
                    item.classList.remove(`matched-pair-${i}`);
                }
            });

            // Show all correct matches with different colors
            vocabData.forEach((item, index) => {
                const wordElement = document.querySelector(`.vocab-words .vocab-item[data-word="${item.word}"]`);
                const defElement = document.querySelector(`.vocab-definitions .vocab-item[data-def="${item.word}"]`);
                
                if (wordElement && defElement) {
                    const pairClass = `matched-pair-${(index % 10) + 1}`;
                    wordElement.classList.add('matched', pairClass);
                    defElement.classList.add('matched', pairClass);
                }
            });

            showResult('vocab-result', true, 'All correct matches are now displayed with matching colors!');
        }
        
        function resetVocab() {
            document.querySelectorAll('.vocab-item').forEach(item => {
                item.classList.remove('selected', 'matched', 'incorrect-match');
                // Remove all pair classes
                for(let i = 1; i <= 10; i++) {
                    item.classList.remove(`matched-pair-${i}`);
                }
            });
            vocabMatches = 0;
            vocabPairCounter = 1;
            selectedWord = null;
            selectedDefinition = null;
            hideResult('vocab-result');
            initVocabulary();
        }
        
        function initMultipleChoice() {
            const options = document.querySelectorAll('.mc-option');
            options.forEach(option => {
                option.addEventListener('click', () => selectMCOption(option));
            });
        }
        
        function selectMCOption(element) {
            const question = element.dataset.question;
            const questionOptions = document.querySelectorAll(`[data-question="${question}"]`);
            
            questionOptions.forEach(option => {
                option.classList.remove('selected');
            });
            element.classList.add('selected');
        }
        
        function checkMultipleChoice() {
            const totalQuestions = 5;
            let correct = 0;
            
            for (let i = 1; i <= totalQuestions; i++) {
                const selected = document.querySelector(`[data-question="${i}"].selected`);
                const allOptions = document.querySelectorAll(`[data-question="${i}"]`);
                
                allOptions.forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                    if (option.dataset.correct === 'true') {
                        option.classList.add('correct');
                    }
                });
                
                if (selected) {
                    selected.classList.add(selected.dataset.correct === 'true' ? 'correct' : 'incorrect');
                    if (selected.dataset.correct === 'true') {
                        correct++;
                    }
                }
            }
            
            const percentage = Math.round((correct / totalQuestions) * 100);
            const message = correct === totalQuestions ? 
                'Excellent! All answers are correct!' : 
                `You got ${correct}/${totalQuestions} correct (${percentage}%)`;
            
            showResult('mc-result', correct === totalQuestions, message);
        }
        
        function initTrueFalse() {
            const buttons = document.querySelectorAll('.tf-button');
            buttons.forEach(button => {
                button.addEventListener('click', () => selectTFOption(button));
            });
        }
        
        function selectTFOption(button) {
            const item = button.closest('.tf-item');
            const buttons = item.querySelectorAll('.tf-button');
            
            buttons.forEach(btn => btn.classList.remove('selected-true', 'selected-false'));
            
            if (button.classList.contains('tf-true')) {
                button.classList.add('selected-true');
                item.dataset.selected = 'true';
            } else {
                button.classList.add('selected-false');
                item.dataset.selected = 'false';
            }
        }
        
        function checkTrueFalse() {
            const items = document.querySelectorAll('.tf-item');
            let correct = 0;
            
            items.forEach(item => {
                const selected = item.dataset.selected;
                const correctAnswer = item.dataset.answer;
                
                item.querySelectorAll('.tf-button').forEach(btn => {
                    btn.classList.remove('selected-true', 'selected-false');
                });
                
                if (selected === correctAnswer) {
                    correct++;
                    item.querySelector(selected === 'true' ? '.tf-true' : '.tf-false').classList.add('selected-true');
                } else {
                    item.querySelector(selected === 'true' ? '.tf-true' : '.tf-false').classList.add('selected-false');
                }
            });
            
            const percentage = Math.round((correct / items.length) * 100);
            const message = correct === items.length ? 
                'Perfect! All answers are correct!' : 
                `You got ${correct}/${items.length} correct (${percentage}%)`;
            
            showResult('tf-result', correct === items.length, message);
        }

        // --- Gap Fill "Click-to-fill" Logic ---
        const gapFillWords = ['overwhelming', 'haggle', 'decades', 'conquest', 'merchants', 'genuine', 'tradition', 'comparison', 'negotiate', 'heritage'];
        let selectedGapWord = null;

        function initGapFill() {
            const wordBank = document.getElementById('word-bank');
            wordBank.innerHTML = '';
            shuffleArray(gapFillWords);
            gapFillWords.forEach(word => {
                const wordSpan = document.createElement('span');
                wordSpan.className = 'gap-fill-word';
                wordSpan.textContent = word;
                wordSpan.dataset.word = word;
                wordSpan.addEventListener('click', selectGapWord);
                wordBank.appendChild(wordSpan);
            });

            document.querySelectorAll('.gap-fill-area input').forEach(input => {
                input.value = "";
                input.classList.remove('correct', 'incorrect');
                input.style.borderBottomColor = '';
                input.style.background = '';
                input.addEventListener('click', fillGap);
            });
            hideResult('gap-result');
        }

        function selectGapWord(e) {
            if (selectedGapWord) {
                selectedGapWord.classList.remove('selected');
            }
            selectedGapWord = e.target;
            selectedGapWord.classList.add('selected');
        }

        function fillGap(e) {
            const input = e.target;
            if (input.value === "" && selectedGapWord) {
                input.value = selectedGapWord.textContent;
                selectedGapWord.classList.add('used');
                selectedGapWord.classList.remove('selected');
                selectedGapWord = null;
            } else if (input.value !== "") {
                const wordToReturn = input.value;
                input.value = "";
                const wordSpan = document.querySelector(`.gap-fill-word[data-word="${wordToReturn}"]`);
                if (wordSpan) {
                    wordSpan.classList.remove('used');
                }
                input.style.borderBottomColor = '#FFD700';
                input.style.background = '#f8f9fa';
            }
        }

        function checkGapFill() {
            const inputs = document.querySelectorAll('.gap-fill-area input');
            let correct = 0;
            inputs.forEach(input => {
                const userAnswer = input.value.toLowerCase().trim();
                const correctAnswer = input.dataset.word.toLowerCase();
                input.classList.remove('correct', 'incorrect');
                if (userAnswer === correctAnswer) {
                    input.style.borderBottomColor = '#4CAF50';
                    input.style.background = '#e8f5e8';
                    correct++;
                } else {
                    input.style.borderBottomColor = '#F44336';
                    input.style.background = '#ffebee';
                }
            });

            const percentage = Math.round((correct / inputs.length) * 100);
            const message = correct === inputs.length ? 
                'Perfect! All answers are correct!' : 
                `You got ${correct}/${inputs.length} correct (${percentage}%)`;
            
            showResult('gap-result', correct === inputs.length, message);
        }

        function resetGapFill() {
            initGapFill();
        }

        // --- Idiom Matching Game ---
        function initIdiomMatch() {
            const idiomList = document.querySelector('.idiom-list');
            const idiomDefs = document.querySelector('.idiom-definitions');

            shuffleArray(idiomData);
            const defsArray = [...idiomData];
            shuffleArray(defsArray);

            idiomList.innerHTML = '';
            idiomDefs.innerHTML = '';

            idiomData.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `"${item.idiom}"`;
                li.dataset.idiom = item.idiom;
                li.addEventListener('click', () => selectIdiom(li, 'idiom'));
                idiomList.appendChild(li);
            });

            defsArray.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item.def;
                li.dataset.def = item.idiom;
                li.addEventListener('click', () => selectIdiom(li, 'def'));
                idiomDefs.appendChild(li);
            });
        }

        function selectIdiom(element, type) {
            if (element.classList.contains('matched')) return;

            if (type === 'idiom') {
                if (selectedIdiom) selectedIdiom.classList.remove('selected');
                selectedIdiom = element;
            } else {
                if (selectedIdiomDef) selectedIdiomDef.classList.remove('selected');
                selectedIdiomDef = element;
            }
            element.classList.add('selected');
            checkIdiomMatch();
        }

        function checkIdiomMatch() {
            if (selectedIdiom && selectedIdiomDef) {
                if (selectedIdiom.dataset.idiom === selectedIdiomDef.dataset.def) {
                    // Correct match - assign unique color pair
                    selectedIdiom.classList.add('matched', `matched-pair-${idiomPairCounter}`);
                    selectedIdiomDef.classList.add('matched', `matched-pair-${idiomPairCounter}`);

                    // Reset selected variables after a correct match
                    selectedIdiom.classList.remove('selected');
                    selectedIdiomDef.classList.remove('selected');
                    selectedIdiom = null;
                    selectedIdiomDef = null;

                    idiomMatches++;
                    idiomPairCounter++;
                    
                    if (idiomMatches === 5) {
                        showResult('idiom-match-result', true, 'Great job! You matched all the idioms.');
                    }
                } else {
                    // Incorrect match - show red briefly
                    selectedIdiom.classList.add('incorrect-match');
                    selectedIdiomDef.classList.add('incorrect-match');
                    setTimeout(() => {
                        selectedIdiom.classList.remove('selected', 'incorrect-match');
                        selectedIdiomDef.classList.remove('selected', 'incorrect-match');
                        selectedIdiom = null;
                        selectedIdiomDef = null;
                    }, 800);
                }
            }
        }

        function showIdiomAnswers() {
            // Clear any existing matches and show all correct pairs
            document.querySelectorAll('.idiom-list li, .idiom-definitions li').forEach(item => {
                item.classList.remove('selected', 'matched', 'incorrect-match');
                // Remove all pair classes
                for(let i = 1; i <= 5; i++) {
                    item.classList.remove(`matched-pair-${i}`);
                }
            });

            // Show all correct matches with different colors
            idiomData.forEach((item, index) => {
                const idiomElement = document.querySelector(`.idiom-list li[data-idiom="${item.idiom}"]`);
                const defElement = document.querySelector(`.idiom-definitions li[data-def="${item.idiom}"]`);
                
                if (idiomElement && defElement) {
                    const pairClass = `matched-pair-${(index % 5) + 1}`;
                    idiomElement.classList.add('matched', pairClass);
                    defElement.classList.add('matched', pairClass);
                }
            });

            showResult('idiom-match-result', true, 'All correct matches are now displayed with matching colors!');
        }
        
        function resetIdiomMatch() {
            document.querySelectorAll('.idiom-list li, .idiom-definitions li').forEach(item => {
                item.classList.remove('selected', 'matched', 'incorrect-match');
                // Remove all pair classes
                for(let i = 1; i <= 5; i++) {
                    item.classList.remove(`matched-pair-${i}`);
                }
            });
            idiomMatches = 0;
            idiomPairCounter = 1;
            selectedIdiom = null;
            selectedIdiomDef = null;
            hideResult('idiom-match-result');
            initIdiomMatch();
        }

        function checkIdiomGapFill() {
            const answers = {
                'idiom-gap-1': 'steal',
                'idiom-gap-2': 'strike a deal',
                'idiom-gap-3': 'highway robbery',
                'idiom-gap-4': 'shop around',
                'idiom-gap-5': 'money talks'
            };
            const inputs = document.querySelectorAll('.idiom-gap-fill input');
            let correct = 0;
            inputs.forEach(input => {
                const userAnswer = input.value.toLowerCase().trim();
                const correctAnswer = answers[input.id].toLowerCase();
                if (userAnswer === correctAnswer) {
                    input.style.borderBottomColor = '#4CAF50';
                    input.style.background = '#e8f5e8';
                    correct++;
                } else {
                    input.style.borderBottomColor = '#F44336';
                    input.style.background = '#ffebee';
                }
            });
            const percentage = Math.round((correct / inputs.length) * 100);
            const message = correct === inputs.length ? 'Perfect! All answers are correct!' : `You got ${correct}/${inputs.length} correct (${percentage}%)`;
            showResult('idiom-gap-result', correct === inputs.length, message);
        }

        // --- Grammar Section ---
        function checkGrammar() {
            const answers = ['has been attracting', 'have been selling', 'have', 'been learning', 'has been haggling', 'have been walking'];
            const inputIds = ['g1', 'g2', 'g3', 'g4', 'g5', 'g6'];
            let correct = 0;
            
            for (let i = 0; i < inputIds.length; i++) {
                const input = document.getElementById(inputIds[i]);
                if (input) {
                    const userAnswer = input.value.toLowerCase().trim();
                    const correctAnswer = answers[i].toLowerCase();
                    if (userAnswer === correctAnswer) {
                        input.style.borderBottomColor = '#4CAF50';
                        input.style.background = '#e8f5e8';
                        correct++;
                    } else {
                        input.style.borderBottomColor = '#F44336';
                        input.style.background = '#ffebee';
                    }
                }
            }

            const totalQuestions = answers.length;
            const percentage = Math.round((correct / totalQuestions) * 100);
            const message = correct === totalQuestions ? 
                'Perfect! All answers are correct!' : 
                `You got ${correct}/${totalQuestions} correct (${percentage}%)`;
            
            showResult('grammar-result', correct === totalQuestions, message);
        }
        
        function showResult(elementId, isCorrect, message) {
            const resultElement = document.getElementById(elementId);
            resultElement.textContent = message;
            resultElement.classList.remove('correct', 'incorrect');
            resultElement.classList.add(isCorrect ? 'correct' : 'incorrect');
            resultElement.style.display = 'block';
        }
        
        function hideResult(elementId) {
            const resultElement = document.getElementById(elementId);
            if (resultElement) {
                resultElement.style.display = 'none';
            }
        }
    </script>
</body>
</html>
