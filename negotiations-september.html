<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business English: The Art of Negotiation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #1a202c; /* Dark background for a gaming feel */
        }
        .container-main {
            background-color: #2d3748; /* Darker main container */
        }
        .lesson-section {
            background-color: #4a5568; /* Even darker section background */
        }
        .game-title {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .progress-bar {
            height: 16px;
            background-color: #4a5568;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4299e1, #667eea);
            transition: width 0.5s ease-in-out;
        }
        .interactive-element {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .interactive-element:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .correct-answer {
            transform: scale(1.05);
            background-color: #48bb78 !important;
            box-shadow: 0 0 10px #48bb78;
        }
        .incorrect-answer {
            transform: scale(0.95);
            background-color: #f56565 !important;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .fill-in-box {
            background-color: #5b6473;
            min-width: 150px;
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
        }
        .conversation-fill-box {
            min-width: 150px;
            display: inline-block;
            text-align: center;
            padding: 8px 12px;
            background-color: #5b6473;
            border-radius: 6px;
            font-style: italic;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <div class="container-main mx-auto max-w-6xl rounded-xl shadow-2xl overflow-hidden my-10 border-4 border-gray-700">

        <header class="bg-gradient-to-br from-blue-700 to-purple-800 text-white p-8 md:p-12 text-center relative overflow-hidden">
            <div class="relative z-10">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-2 tracking-tight game-title">The Art of Negotiation</h1>
                <p class="text-xl md:text-2xl font-light opacity-90">Essential Business English for Getting to "Yes"</p>
            </div>
        </header>

        <main class="p-4 sm:p-6 md:p-10">
            <div class="bg-gray-800 rounded-lg p-4 mb-8 border border-gray-700 shadow-xl">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xl font-bold text-yellow-400">Score: <span id="score">0</span></span>
                    <span id="feedback-message" class="text-lg font-medium text-green-400 hidden"></span>
                    <span class="text-sm text-gray-400" id="progress-text">0/4 activities complete</span>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%;"></div>
                </div>
            </div>
            
            <section id="reading-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üìñ Reading: Strategies for Successful Negotiation</h2>
                <div class="text-gray-300 space-y-4 text-sm md:text-base">
                    <p>Successful negotiation is more than just haggling over price; it's about finding a mutually beneficial solution. One of the most effective strategies is to focus on interests, not just positions. A "position" is what you want (e.g., "I want to pay $50"), while an "interest" is why you want it (e.g., "I need to stay within a strict budget"). By understanding the underlying interests of the other party, you can brainstorm creative solutions that might satisfy both sides and lead to a win-win outcome.</p>
                    <p>Another key principle is to prepare a BATNA, or "Best Alternative To a Negotiated Agreement." Your BATNA is your plan B‚Äîwhat you will do if the negotiation fails. Having a strong BATNA gives you power and confidence. It allows you to walk away from a deal that is not in your best interest. Always enter a negotiation with a clear understanding of your own interests and a well-defined BATNA. Remember, a good deal for you is better than a perfect deal for them, but a good deal for both of you is a great outcome.</p>
                </div>
                <div class="mt-6">
                    <h3 class="text-xl font-bold text-gray-100 mb-4">Quiz: Reading Check</h3>
                    <p class="text-gray-300 mb-4">According to the text, what is a "position" in negotiation?</p>
                    <div id="reading-quiz" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button onclick="checkReadingQuiz('A')" class="quiz-option interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold text-left">A) Your underlying reason for a request.</button>
                        <button onclick="checkReadingQuiz('B')" class="quiz-option interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold text-left">B) The specific request or demand you make.</button>
                    </div>
                    <p id="reading-feedback" class="mt-4 text-sm font-medium"></p>
                </div>
            </section>

            <section id="true-false-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">‚öñÔ∏è True or False?</h2>
                <div class="space-y-4">
                    <p class="text-lg font-medium" id="tf-question">1. A strong BATNA makes you less powerful in a negotiation.</p>
                    <div class="flex gap-4">
                        <button onclick="checkTrueFalse(true)" class="tf-btn interactive-element bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-6 rounded-full shadow-md">True</button>
                        <button onclick="checkTrueFalse(false)" class="tf-btn interactive-element bg-red-600 hover:bg-red-500 text-white font-bold py-3 px-6 rounded-full shadow-md">False</button>
                    </div>
                    <p id="tf-feedback" class="text-sm italic text-gray-400"></p>
                </div>
            </section>
            
            <section id="idioms-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üîó Negotiation Idioms</h2>
                <p class="text-gray-400 text-center mb-6">Click an idiom, then click its meaning to make a match!</p>
                <div class="flex flex-col md:flex-row justify-center items-center gap-6">
                    <div id="idioms-container" class="grid grid-cols-1 md:grid-cols-1 gap-4 w-full md:w-1/2">
                        </div>
                    <div id="meanings-container" class="grid grid-cols-1 md:grid-cols-1 gap-4 w-full md:w-1/2">
                        </div>
                </div>
                <div class="text-center mt-6">
                    <span id="idiom-progress" class="text-lg font-medium text-gray-400">0/5 matched</span>
                </div>
            </section>

            <section id="conversation-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üó£Ô∏è Negotiation Speak</h2>
                <p class="text-gray-300 mb-4">Fill in the blanks in the conversation below using the words from the bank.</p>
                <div id="conversation-word-bank" class="flex flex-wrap gap-2 justify-center bg-gray-700 p-4 rounded-lg mb-6">
                    </div>
                <div id="conversation-text" class="text-lg text-gray-300 leading-relaxed space-y-4">
                    <p><span class="font-bold text-yellow-400">Sarah:</span> Thanks for meeting. Before we get into the details, I want to confirm we are on the <span class="conversation-fill-box interactive-element" data-word-index="0"></span>. We're looking for a long-term partnership.</p>
                    <p><span class="font-bold text-yellow-400">James:</span> We are. We are very interested in working together. What would you say is your <span class="conversation-fill-box interactive-element" data-word-index="1"></span> for this deal?</p>
                    <p><span class="font-bold text-yellow-400">Sarah:</span> Well, we've done our research and we have a very strong <span class="conversation-fill-box interactive-element" data-word-index="2"></span>. We can always seek another supplier if we can't reach a mutual agreement.</p>
                    <p><span class="font-bold text-yellow-400">James:</span> I see. I don't think we'll need that. Our team is flexible. Perhaps we can meet in the middle and <span class="conversation-fill-box interactive-element" data-word-index="3"></span> a good compromise.</p>
                </div>
                <button onclick="checkConversationBlanks()" class="mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-transform transform hover:scale-105">Check Answers</button>
                <div id="conversation-feedback" class="mt-4 text-sm font-medium"></div>
            </section>
        </main>
        
        <footer class="bg-gray-900 text-center text-gray-500 p-6 md:p-8">
            <p>&copy; 2025 Culture Quest. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Global state variables for all activities
        let score = 0;
        let matchedIdioms = 0;
        let selectedIdiom = null;
        let selectedMeaning = null;
        let activitiesCompleted = 0;
        let readingQuizDone = false;
        let tfQuizDone = false;
        let idiomsDone = false;
        let conversationDone = false;
        
        const idioms = [
            { id: 1, idiom: 'Win-win situation', meaning: 'An outcome where both parties benefit.' },
            { id: 2, idiom: 'On the table', meaning: 'Ready for consideration or discussion.' },
            { id: 3, idiom: 'Meet halfway', meaning: 'To find a compromise by accepting some of the other side\'s terms.' },
            { id: 4, idiom: 'Zero-sum game', meaning: 'A situation where one person\'s gain is equivalent to another\'s loss.' },
            { id: 5, idiom: 'Get down to business', meaning: 'To start focusing on the main task or topic.' }
        ];

        const conversationBlanksData = ['same page', 'bottom line', 'BATNA', 'hammer out'];
        let userConversationWords = new Array(conversationBlanksData.length).fill(null);
        let selectedBlankIndex = null;
        
        const totalActivities = 4; // Reading Quiz, T/F, Idioms, Conversation

        /**
         * Utility function to update the score, progress bar, and provide feedback.
         * @param {number} points - The points to add to the score.
         * @param {string} message - The feedback message to display.
         * @param {string} type - 'correct' or 'incorrect'.
         */
        function updateScore(points, message, type) {
            score += points;
            document.getElementById('score').textContent = score;

            const feedbackEl = document.getElementById('feedback-message');
            feedbackEl.textContent = message;
            feedbackEl.classList.remove('text-green-400', 'text-red-400', 'hidden');
            if (type === 'correct') {
                feedbackEl.classList.add('text-green-400');
            } else {
                feedbackEl.classList.add('text-red-400');
            }
            setTimeout(() => {
                feedbackEl.classList.add('hidden');
            }, 3000);
        }

        /**
         * Updates the overall progress bar.
         */
        function updateProgress() {
            activitiesCompleted = [readingQuizDone, tfQuizDone, idiomsDone, conversationDone].filter(Boolean).length;
            const percentage = (activitiesCompleted / totalActivities) * 100;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = `${activitiesCompleted}/${totalActivities} activities complete`;

            if (activitiesCompleted === totalActivities) {
                updateScore(100, 'All activities completed! You are a Negotiation Pro! üëë', 'correct');
            }
        }
        
        /**
         * Checks the reading comprehension multiple-choice quiz answer.
         * @param {string} selectedOption - The option selected by the user.
         */
        function checkReadingQuiz(selectedOption) {
            if (readingQuizDone) return;
            const feedbackEl = document.getElementById('reading-feedback');
            const quizOptions = document.querySelectorAll('#reading-quiz button');
            
            quizOptions.forEach(btn => btn.classList.remove('correct-answer', 'incorrect-answer'));

            if (selectedOption === 'B') {
                feedbackEl.textContent = 'Correct! A position is your specific demand, while an interest is the reason behind it.';
                feedbackEl.className = 'mt-4 text-sm font-medium text-green-400';
                document.querySelector(`[onclick="checkReadingQuiz('${selectedOption}')"]`).classList.add('correct-answer');
                updateScore(20, 'Reading quiz correct!', 'correct');
                readingQuizDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = 'Incorrect. Try again. A position is what you want, not why you want it.';
                feedbackEl.className = 'mt-4 text-sm font-medium text-red-400';
                document.querySelector(`[onclick="checkReadingQuiz('${selectedOption}')"]`).classList.add('incorrect-answer');
                updateScore(-5, 'Reading quiz incorrect.', 'incorrect');
            }
        }

        /**
         * Checks the answer for the True/False question.
         * @param {boolean} answer - The correct answer to check against.
         */
        function checkTrueFalse(answer) {
            if (tfQuizDone) return;
            const feedbackEl = document.getElementById('tf-feedback');
            
            if (!answer) { // The statement is False
                feedbackEl.textContent = 'Correct! A strong BATNA actually increases your power and confidence.';
                feedbackEl.className = 'text-sm italic text-green-400';
                document.querySelector('.tf-btn.bg-red-600').classList.add('correct-answer');
                updateScore(15, 'True/False question correct!', 'correct');
                tfQuizDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = 'Incorrect. That statement is false.';
                feedbackEl.className = 'text-sm italic text-red-400';
                document.querySelector('.tf-btn.bg-green-600').classList.add('incorrect-answer');
                updateScore(-5, 'True/False question incorrect.', 'incorrect');
            }
        }

        /**
         * Initializes the idioms matching game by shuffling and displaying pairs.
         */
        function setupIdioms() {
            const idiomsShuffled = [...idioms].sort(() => Math.random() - 0.5);
            const meaningsShuffled = [...idioms].sort(() => Math.random() - 0.5);

            const idiomsContainer = document.getElementById('idioms-container');
            const meaningsContainer = document.getElementById('meanings-container');
            
            idiomsContainer.innerHTML = '';
            meaningsContainer.innerHTML = '';

            idiomsShuffled.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item.idiom;
                button.className = 'idiom-btn interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold shadow-md';
                button.dataset.id = item.id;
                button.onclick = () => selectIdiom(button);
                idiomsContainer.appendChild(button);
            });

            meaningsShuffled.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item.meaning;
                button.className = 'meaning-btn interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold shadow-md';
                button.dataset.id = item.id;
                button.onclick = () => selectMeaning(button);
                meaningsContainer.appendChild(button);
            });
        }

        /**
         * Handles the selection of an idiom button.
         * @param {HTMLElement} button - The button element that was clicked.
         */
        function selectIdiom(button) {
            if (button.disabled) return;
            document.querySelectorAll('.idiom-btn').forEach(btn => btn.classList.remove('bg-yellow-600'));
            button.classList.add('bg-yellow-600');
            selectedIdiom = button;
            checkMatch();
        }

        /**
         * Handles the selection of a meaning button.
         * @param {HTMLElement} button - The button element that was clicked.
         */
        function selectMeaning(button) {
            if (button.disabled) return;
            document.querySelectorAll('.meaning-btn').forEach(btn => btn.classList.remove('bg-yellow-600'));
            button.classList.add('bg-yellow-600');
            selectedMeaning = button;
            checkMatch();
        }

        /**
         * Checks if the selected idiom and meaning match.
         */
        function checkMatch() {
            if (selectedIdiom && selectedMeaning) {
                if (selectedIdiom.dataset.id === selectedMeaning.dataset.id) {
                    selectedIdiom.classList.remove('bg-yellow-600', 'hover:bg-gray-500');
                    selectedMeaning.classList.remove('bg-yellow-600', 'hover:bg-gray-500');
                    selectedIdiom.classList.add('correct-answer');
                    selectedMeaning.classList.add('correct-answer');
                    selectedIdiom.disabled = true;
                    selectedMeaning.disabled = true;
                    selectedIdiom = null;
                    selectedMeaning = null;
                    matchedIdioms++;
                    document.getElementById('idiom-progress').textContent = `${matchedIdioms}/${idioms.length} matched`;
                    updateScore(15, 'Correct! Great match.', 'correct');
                    if (matchedIdioms === idioms.length) {
                        updateScore(50, 'Section complete! All idioms matched! üèÜ', 'correct');
                        idiomsDone = true;
                        updateProgress();
                    }
                } else {
                    updateScore(-5, 'Incorrect match. Try again.', 'incorrect');
                    selectedIdiom.classList.add('incorrect-answer');
                    selectedMeaning.classList.add('incorrect-answer');
                    setTimeout(() => {
                        selectedIdiom.classList.remove('bg-yellow-600', 'incorrect-answer');
                        selectedMeaning.classList.remove('bg-yellow-600', 'incorrect-answer');
                        selectedIdiom = null;
                        selectedMeaning = null;
                    }, 500);
                }
            }
        }
        
        /**
         * Sets up the conversation fill-in-the-blanks section.
         */
        function setupConversationBlanks() {
            const wordBankEl = document.getElementById('conversation-word-bank');
            const words = [...conversationBlanksData].sort(() => Math.random() - 0.5);
            
            wordBankEl.innerHTML = '';
            words.forEach(word => {
                const button = document.createElement('button');
                button.textContent = word;
                button.className = 'fill-in-box interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-2 font-semibold shadow-md';
                button.onclick = () => handleWordBankClick(button, word);
                wordBankEl.appendChild(button);
            });
            
            userConversationWords = new Array(conversationBlanksData.length).fill(null);

            const textEl = document.getElementById('conversation-text');
            textEl.innerHTML = `
                <p><span class="font-bold text-yellow-400">Sarah:</span> Thanks for meeting. Before we get into the details, I want to confirm we are on the <span class="conversation-fill-box interactive-element" data-word-index="0"></span>. We're looking for a long-term partnership.</p>
                <p><span class="font-bold text-yellow-400">James:</span> We are. We are very interested in working together. What would you say is your <span class="conversation-fill-box interactive-element" data-word-index="1"></span> for this deal?</p>
                <p><span class="font-bold text-yellow-400">Sarah:</span> Well, we've done our research and we have a very strong <span class="conversation-fill-box interactive-element" data-word-index="2"></span>. We can always seek another supplier if we can't reach a mutual agreement.</p>
                <p><span class="font-bold text-yellow-400">James:</span> I see. I don't think we'll need that. Our team is flexible. Perhaps we can meet in the middle and <span class="conversation-fill-box interactive-element" data-word-index="3"></span> a good compromise.</p>
            `;
            
            // Add click handlers for the blank boxes
            document.querySelectorAll('.conversation-fill-box').forEach(blank => {
                blank.onclick = () => handleBlankClick(blank);
            });
        }
        
        /**
         * Handles clicks on the word bank buttons.
         * @param {HTMLElement} button - The button element that was clicked.
         * @param {string} word - The word on the button.
         */
        function handleWordBankClick(button, word) {
            if (selectedBlankIndex !== null) {
                userConversationWords[selectedBlankIndex] = word;
                const blankEl = document.querySelector(`#conversation-text [data-word-index="${selectedBlankIndex}"]`);
                blankEl.textContent = word;
                blankEl.classList.add('bg-gray-500');
                button.disabled = true;
                selectedBlankIndex = null; // Deselect the blank
                document.querySelectorAll('.conversation-fill-box').forEach(b => b.classList.remove('bg-blue-600'));
            }
        }

        /**
         * Handles clicks on the blank boxes.
         * @param {HTMLElement} blank - The blank element that was clicked.
         */
        function handleBlankClick(blank) {
            const word = blank.textContent;
            if (word && word !== '') {
                const wordIndex = parseInt(blank.dataset.wordIndex);
                userConversationWords[wordIndex] = null;
                blank.textContent = '';
                blank.classList.remove('bg-gray-500');

                // Re-enable the corresponding button in the word bank
                const wordBankButtons = document.querySelectorAll('#conversation-word-bank button');
                const correspondingButton = Array.from(wordBankButtons).find(btn => btn.textContent === word);
                if (correspondingButton) {
                    correspondingButton.disabled = false;
                }
            } else {
                // Deselect any currently selected blank
                document.querySelectorAll('.conversation-fill-box').forEach(b => b.classList.remove('bg-blue-600'));

                // Select this blank
                selectedBlankIndex = parseInt(blank.dataset.wordIndex);
                blank.classList.add('bg-blue-600');
            }
        }

        /**
         * Checks the user's answers for the conversation activity.
         */
        function checkConversationBlanks() {
            if (conversationDone) return;
            const feedbackEl = document.getElementById('conversation-feedback');
            const blanks = document.querySelectorAll('#conversation-text span.conversation-fill-box');
            let allCorrect = true;
            
            const correctOrder = ['same page', 'bottom line', 'BATNA', 'hammer out'];

            blanks.forEach((blank, index) => {
                const isCorrect = userConversationWords[index] === correctOrder[index];
                if (isCorrect) {
                    blank.classList.remove('bg-gray-500');
                    blank.classList.add('correct-answer');
                } else {
                    blank.classList.remove('bg-gray-500');
                    blank.classList.add('incorrect-answer');
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                feedbackEl.textContent = "Excellent! You've used all the negotiation phrases correctly.";
                feedbackEl.className = 'mt-4 text-sm font-medium text-green-400';
                updateScore(30, 'Conversation correct!', 'correct');
                conversationDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = "Some answers are incorrect. Take another shot!";
                feedbackEl.className = 'mt-4 text-sm font-medium text-red-400';
                updateScore(-15, 'Conversation incorrect.', 'incorrect');
                setTimeout(() => {
                    setupConversationBlanks();
                }, 2000);
            }
        }
        
        // Initialize all activities on window load
        window.onload = function() {
            setupIdioms();
            setupConversationBlanks();
        };

    </script>
</body>
</html>
