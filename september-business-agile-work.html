<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business English: The Agile Workplace</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #1a202c; /* Dark background */
        }
        .container-main {
            background-color: #2d3748; /* Darker main container */
        }
        .lesson-section {
            background-color: #4a5568; /* Even darker section background */
        }
        .game-title {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .progress-bar {
            height: 16px;
            background-color: #4a5568;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4299e1, #667eea);
            transition: width 0.5s ease-in-out;
        }
        .interactive-element {
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .interactive-element:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .correct-answer {
            transform: scale(1.05);
            background-color: #48bb78 !important;
            box-shadow: 0 0 10px #48bb78;
        }
        .incorrect-answer {
            transform: scale(0.95);
            background-color: #f56565 !important;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
        .fill-in-box {
            background-color: #5b6473;
            min-width: 150px;
            padding: 8px 12px;
            border-radius: 6px;
            text-align: center;
        }
        .conversation-fill-box {
            min-width: 150px;
            display: inline-block;
            text-align: center;
            padding: 8px 12px;
            background-color: #5b6473;
            border-radius: 6px;
            font-style: italic;
        }
        /* Custom styles for the new lesson theme */
        .header-agile {
            background-color: #48bb78;
            background-image: linear-gradient(135deg, #48bb78, #38a169);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <div class="container-main mx-auto max-w-6xl rounded-xl shadow-2xl overflow-hidden my-10 border-4 border-gray-700">

        <header class="header-agile text-white p-8 md:p-12 text-center relative overflow-hidden">
            <div class="relative z-10">
                <h1 class="text-4xl md:text-6xl font-extrabold mb-2 tracking-tight game-title">The Agile Workplace</h1>
                <p class="text-xl md:text-2xl font-light opacity-90">Essential Business English for Modern Teams</p>
            </div>
        </header>

        <main class="p-4 sm:p-6 md:p-10">
            <div class="bg-gray-800 rounded-lg p-4 mb-8 border border-gray-700 shadow-xl">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xl font-bold text-yellow-400">Score: <span id="score">0</span></span>
                    <span id="feedback-message" class="text-lg font-medium text-green-400 hidden"></span>
                    <span class="text-sm text-gray-400" id="progress-text">0/4 activities complete</span>
                </div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill" style="width: 0%;"></div>
                </div>
            </div>
            
            <section id="reading-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üìñ Reading: The Rise of Agile Work</h2>
                <div class="text-gray-300 space-y-4 text-sm md:text-base">
                    <p>In today's fast-paced world, many companies are moving away from traditional, rigid work structures and embracing an **agile** approach. This means prioritizing **flexibility**, **collaboration**, and **adaptability**. Instead of long-term, fixed plans, agile teams work in short cycles called **sprints**, typically lasting two to four weeks. At the end of each sprint, the team delivers a finished piece of work, gets feedback, and adjusts their plan for the next cycle.</p>
                    <p>A key aspect of agile is constant communication. Teams hold daily **stand-up meetings** (or **scrums**) to quickly share what they've done, what they'll do next, and any obstacles they're facing. This transparency helps everyone stay on track and allows for problems to be solved quickly. The focus is on **continuous improvement** and responding to change, rather than following a strict, pre-determined path. This is particularly important for remote or hybrid teams that need to stay connected.</p>
                </div>
                <div class="mt-6">
                    <h3 class="text-xl font-bold text-gray-100 mb-4">Quiz: Reading Check</h3>
                    <p class="text-gray-300 mb-4">What is the main purpose of a daily stand-up meeting?</p>
                    <div id="reading-quiz" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button onclick="checkReadingQuiz('A')" class="quiz-option interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold text-left">A) To give a full presentation on a new project.</button>
                        <button onclick="checkReadingQuiz('B')" class="quiz-option interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold text-left">B) To quickly share progress and identify challenges.</button>
                    </div>
                    <p id="reading-feedback" class="mt-4 text-sm font-medium"></p>
                </div>
            </section>
            
            <section id="true-false-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">‚öñÔ∏è True or False?</h2>
                <div class="space-y-4">
                    <p class="text-lg font-medium" id="tf-question">1. An agile team works on a project for months before delivering any results.</p>
                    <div class="flex gap-4">
                        <button onclick="checkTrueFalse(true)" class="tf-btn interactive-element bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-6 rounded-full shadow-md">True</button>
                        <button onclick="checkTrueFalse(false)" class="tf-btn interactive-element bg-red-600 hover:bg-red-500 text-white font-bold py-3 px-6 rounded-full shadow-md">False</button>
                    </div>
                    <p id="tf-feedback" class="text-sm italic text-gray-400"></p>
                </div>
            </section>
            
            <section id="terms-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üîó Agile Terms & Concepts</h2>
                <p class="text-gray-400 text-center mb-6">Click a term, then click its meaning to make a match!</p>
                <div class="flex flex-col md:flex-row justify-center items-center gap-6">
                    <div id="terms-container" class="grid grid-cols-1 md:grid-cols-1 gap-4 w-full md:w-1/2">
                    </div>
                    <div id="meanings-container" class="grid grid-cols-1 md:grid-cols-1 gap-4 w-full md:w-1/2">
                    </div>
                </div>
                <div class="text-center mt-6">
                    <span id="terms-progress" class="text-lg font-medium text-gray-400">0/5 matched</span>
                </div>
            </section>

            <section id="conversation-section" class="lesson-section p-6 md:p-8 rounded-xl shadow-lg mb-8 border border-gray-700">
                <h2 class="text-2xl md:text-3xl font-bold text-yellow-400 mb-4">üó£Ô∏è Team Talk</h2>
                <p class="text-gray-300 mb-4">Fill in the blanks in the conversation below using the words from the bank. Click a gap, then select a word from the wordbank. Click the word again to deselect.</p>
                <div id="conversation-word-bank" class="flex flex-wrap gap-2 justify-center bg-gray-700 p-4 rounded-lg mb-6">
                </div>
                <div id="conversation-text" class="text-lg text-gray-300 leading-relaxed space-y-4">
                    <p><span class="font-bold text-yellow-400">Liam:</span> Hey team, let's have a quick <span class="conversation-fill-box interactive-element" data-word-index="0"></span> to sync up on our progress.</p>
                    <p><span class="font-bold text-yellow-400">Maria:</span> Sounds good. We're on track to complete all our tasks by the end of this <span class="conversation-fill-box interactive-element" data-word-index="1"></span>. The new feature is almost ready for testing.</p>
                    <p><span class="font-bold text-yellow-400">Liam:</span> Great. I'll get back to you with some feedback. We need to be **flexible** and make changes as needed. What's the biggest <span class="conversation-fill-box interactive-element" data-word-index="2"></span> you're facing?</p>
                    <p><span class="font-bold text-yellow-400">Maria:</span> We're having some trouble with the API. It's a bit of a <span class="conversation-fill-box interactive-element" data-word-index="3"></span>, but we should have it solved soon. I'll keep you updated.</p>
                </div>
                <button onclick="checkConversationBlanks()" class="mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-transform transform hover:scale-105">Check Answers</button>
                <div id="conversation-feedback" class="mt-4 text-sm font-medium"></div>
            </section>
        </main>
        
        <footer class="bg-gray-900 text-center text-gray-500 p-6 md:p-8">
            <p>&copy; 2025 Culture Quest. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Global state variables for all activities
        let score = 0;
        let matchedTerms = 0;
        let selectedTerm = null;
        let selectedMeaning = null;
        let activitiesCompleted = 0;
        let readingQuizDone = false;
        let tfQuizDone = false;
        let termsDone = false;
        let conversationDone = false;

        const terms = [
            { id: 1, term: 'Sprint', meaning: 'A short, time-boxed period to complete a specific set of tasks.' },
            { id: 2, term: 'Stand-up', meaning: 'A brief daily meeting to share progress and challenges.' },
            { id: 3, term: 'Agile', meaning: 'A project approach that prioritizes flexibility and collaboration.' },
            { id: 4, term: 'Roadblock', meaning: 'An obstacle or problem that prevents progress.' },
            { id: 5, term: 'Backlog', meaning: 'A list of tasks, features, or issues to be completed.' }
        ];

        const conversationBlanksData = ['stand-up', 'sprint', 'roadblock', 'headache'];
        let userConversationWords = new Array(conversationBlanksData.length).fill(null);
        let selectedBlankIndex = null;
        
        const totalActivities = 4; // Reading Quiz, T/F, Terms, Conversation

        /**
         * Utility function to update the score, progress bar, and provide feedback.
         * @param {number} points - The points to add to the score.
         * @param {string} message - The feedback message to display.
         * @param {string} type - 'correct' or 'incorrect'.
         */
        function updateScore(points, message, type) {
            score += points;
            document.getElementById('score').textContent = score;

            const feedbackEl = document.getElementById('feedback-message');
            feedbackEl.textContent = message;
            feedbackEl.classList.remove('text-green-400', 'text-red-400', 'hidden');
            if (type === 'correct') {
                feedbackEl.classList.add('text-green-400');
            } else {
                feedbackEl.classList.add('text-red-400');
            }
            setTimeout(() => {
                feedbackEl.classList.add('hidden');
            }, 3000);
        }

        /**
         * Updates the overall progress bar.
         */
        function updateProgress() {
            activitiesCompleted = [readingQuizDone, tfQuizDone, termsDone, conversationDone].filter(Boolean).length;
            const percentage = (activitiesCompleted / totalActivities) * 100;
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-text').textContent = `${activitiesCompleted}/${totalActivities} activities complete`;

            if (activitiesCompleted === totalActivities) {
                updateScore(100, 'All activities completed! You are an Agile Pro! üèÜ', 'correct');
            }
        }
        
        /**
         * Checks the reading comprehension multiple-choice quiz answer.
         * @param {string} selectedOption - The option selected by the user.
         */
        function checkReadingQuiz(selectedOption) {
            if (readingQuizDone) return;
            const feedbackEl = document.getElementById('reading-feedback');
            const quizOptions = document.querySelectorAll('#reading-quiz button');
            
            quizOptions.forEach(btn => btn.classList.remove('correct-answer', 'incorrect-answer'));

            if (selectedOption === 'B') {
                feedbackEl.textContent = 'Correct! The goal is a quick sync, not a full presentation.';
                feedbackEl.className = 'mt-4 text-sm font-medium text-green-400';
                document.querySelector(`[onclick="checkReadingQuiz('${selectedOption}')"]`).classList.add('correct-answer');
                updateScore(20, 'Reading quiz correct!', 'correct');
                readingQuizDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = 'Incorrect. Stand-ups are for quick updates, not long presentations.';
                feedbackEl.className = 'mt-4 text-sm font-medium text-red-400';
                document.querySelector(`[onclick="checkReadingQuiz('${selectedOption}')"]`).classList.add('incorrect-answer');
                updateScore(-5, 'Reading quiz incorrect.', 'incorrect');
            }
        }

        /**
         * Checks the answer for the True/False question.
         * @param {boolean} answer - The correct answer to check against.
         */
        function checkTrueFalse(answer) {
            if (tfQuizDone) return;
            const feedbackEl = document.getElementById('tf-feedback');
            
            if (!answer) { // The statement is False
                feedbackEl.textContent = 'Correct! Agile teams work in short sprints, not long, fixed periods.';
                feedbackEl.className = 'text-sm italic text-green-400';
                document.querySelector('.tf-btn.bg-red-600').classList.add('correct-answer');
                updateScore(15, 'True/False question correct!', 'correct');
                tfQuizDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = 'Incorrect. That statement is false.';
                feedbackEl.className = 'text-sm italic text-red-400';
                document.querySelector('.tf-btn.bg-green-600').classList.add('incorrect-answer');
                updateScore(-5, 'True/False question incorrect.', 'incorrect');
            }
        }

        /**
         * Initializes the terms matching game by shuffling and displaying pairs.
         */
        function setupTerms() {
            const termsShuffled = [...terms].sort(() => Math.random() - 0.5);
            const meaningsShuffled = [...terms].sort(() => Math.random() - 0.5);

            const termsContainer = document.getElementById('terms-container');
            const meaningsContainer = document.getElementById('meanings-container');
            
            termsContainer.innerHTML = '';
            meaningsContainer.innerHTML = '';

            termsShuffled.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item.term;
                button.className = 'term-btn interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold shadow-md';
                button.dataset.id = item.id;
                button.onclick = () => selectTerm(button);
                termsContainer.appendChild(button);
            });

            meaningsShuffled.forEach(item => {
                const button = document.createElement('button');
                button.textContent = item.meaning;
                button.className = 'meaning-btn interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-4 font-semibold shadow-md';
                button.dataset.id = item.id;
                button.onclick = () => selectMeaning(button);
                meaningsContainer.appendChild(button);
            });
        }

        /**
         * Handles the selection of an idiom button.
         * @param {HTMLElement} button - The button element that was clicked.
         */
        function selectTerm(button) {
            if (button.disabled) return;
            document.querySelectorAll('.term-btn').forEach(btn => btn.classList.remove('bg-yellow-600'));
            button.classList.add('bg-yellow-600');
            selectedTerm = button;
            checkMatch();
        }

        /**
         * Handles the selection of a meaning button.
         * @param {HTMLElement} button - The button element that was clicked.
         */
        function selectMeaning(button) {
            if (button.disabled) return;
            document.querySelectorAll('.meaning-btn').forEach(btn => btn.classList.remove('bg-yellow-600'));
            button.classList.add('bg-yellow-600');
            selectedMeaning = button;
            checkMatch();
        }

        /**
         * Checks if the selected idiom and meaning match.
         */
        function checkMatch() {
            if (selectedTerm && selectedMeaning) {
                if (selectedTerm.dataset.id === selectedMeaning.dataset.id) {
                    selectedTerm.classList.remove('bg-yellow-600', 'hover:bg-gray-500');
                    selectedMeaning.classList.remove('bg-yellow-600', 'hover:bg-gray-500');
                    selectedTerm.classList.add('correct-answer');
                    selectedMeaning.classList.add('correct-answer');
                    selectedTerm.disabled = true;
                    selectedMeaning.disabled = true;
                    selectedTerm = null;
                    selectedMeaning = null;
                    matchedTerms++;
                    document.getElementById('terms-progress').textContent = `${matchedTerms}/${terms.length} matched`;
                    updateScore(15, 'Correct! Great match.', 'correct');
                    if (matchedTerms === terms.length) {
                        updateScore(50, 'Section complete! All terms matched! üèÜ', 'correct');
                        termsDone = true;
                        updateProgress();
                    }
                } else {
                    updateScore(-5, 'Incorrect match. Try again.', 'incorrect');
                    selectedTerm.classList.add('incorrect-answer');
                    selectedMeaning.classList.add('incorrect-answer');
                    setTimeout(() => {
                        selectedTerm.classList.remove('bg-yellow-600', 'incorrect-answer');
                        selectedMeaning.classList.remove('bg-yellow-600', 'incorrect-answer');
                        selectedTerm = null;
                        selectedMeaning = null;
                    }, 500);
                }
            }
        }
        
        /**
         * Sets up the conversation fill-in-the-blanks section.
         */
        function setupConversationBlanks() {
            const wordBankEl = document.getElementById('conversation-word-bank');
            const words = [...conversationBlanksData].sort(() => Math.random() - 0.5);
            
            wordBankEl.innerHTML = '';
            words.forEach(word => {
                const button = document.createElement('button');
                button.textContent = word;
                button.className = 'fill-in-box interactive-element bg-gray-600 hover:bg-gray-500 rounded-lg p-2 font-semibold shadow-md';
                button.onclick = () => handleWordBankClick(button, word);
                wordBankEl.appendChild(button);
            });
            
            userConversationWords = new Array(conversationBlanksData.length).fill(null);

            const textEl = document.getElementById('conversation-text');
            textEl.innerHTML = `
                <p><span class="font-bold text-yellow-400">Liam:</span> Hey team, let's have a quick <span class="conversation-fill-box interactive-element" data-word-index="0"></span> to sync up on our progress.</p>
                <p><span class="font-bold text-yellow-400">Maria:</span> Sounds good. We're on track to complete all our tasks by the end of this <span class="conversation-fill-box interactive-element" data-word-index="1"></span>. The new feature is almost ready for testing.</p>
                <p><span class="font-bold text-yellow-400">Liam:</span> Great. I'll get back to you with some feedback. We need to be **flexible** and make changes as needed. What's the biggest <span class="conversation-fill-box interactive-element" data-word-index="2"></span> you're facing?</p>
                <p><span class="font-bold text-yellow-400">Maria:</span> We're having some trouble with the API. It's a bit of a <span class="conversation-fill-box interactive-element" data-word-index="3"></span>, but we should have it solved soon. I'll keep you updated.</p>
            `;
            
            // Add click handlers for the blank boxes
            document.querySelectorAll('.conversation-fill-box').forEach(blank => {
                blank.onclick = () => handleBlankClick(blank);
            });
        }
        
        /**
         * Handles clicks on the word bank buttons.
         * @param {HTMLElement} button - The button element that was clicked.
         * @param {string} word - The word on the button.
         */
        function handleWordBankClick(button, word) {
            if (selectedBlankIndex !== null) {
                userConversationWords[selectedBlankIndex] = word;
                const blankEl = document.querySelector(`#conversation-text [data-word-index="${selectedBlankIndex}"]`);
                blankEl.textContent = word;
                blankEl.classList.add('bg-gray-500');
                button.disabled = true;
                selectedBlankIndex = null; // Deselect the blank
                document.querySelectorAll('.conversation-fill-box').forEach(b => b.classList.remove('bg-blue-600'));
            }
        }

        /**
         * Handles clicks on the blank boxes.
         * @param {HTMLElement} blank - The blank element that was clicked.
         */
        function handleBlankClick(blank) {
            const word = blank.textContent;
            if (word && word !== '') {
                const wordIndex = parseInt(blank.dataset.wordIndex);
                userConversationWords[wordIndex] = null;
                blank.textContent = '';
                blank.classList.remove('bg-gray-500');

                // Re-enable the corresponding button in the word bank
                const wordBankButtons = document.querySelectorAll('#conversation-word-bank button');
                const correspondingButton = Array.from(wordBankButtons).find(btn => btn.textContent === word);
                if (correspondingButton) {
                    correspondingButton.disabled = false;
                }
            } else {
                // Deselect any currently selected blank
                document.querySelectorAll('.conversation-fill-box').forEach(b => b.classList.remove('bg-blue-600'));

                // Select this blank
                selectedBlankIndex = parseInt(blank.dataset.wordIndex);
                blank.classList.add('bg-blue-600');
            }
        }

        /**
         * Checks the user's answers for the conversation activity.
         */
        function checkConversationBlanks() {
            if (conversationDone) return;
            const feedbackEl = document.getElementById('conversation-feedback');
            const blanks = document.querySelectorAll('#conversation-text span.conversation-fill-box');
            let allCorrect = true;
            
            const correctOrder = ['stand-up', 'sprint', 'roadblock', 'headache'];

            blanks.forEach((blank, index) => {
                const isCorrect = userConversationWords[index] === correctOrder[index];
                if (isCorrect) {
                    blank.classList.remove('bg-gray-500');
                    blank.classList.add('correct-answer');
                } else {
                    blank.classList.remove('bg-gray-500');
                    blank.classList.add('incorrect-answer');
                    allCorrect = false;
                }
            });

            if (allCorrect) {
                feedbackEl.textContent = "Excellent! You've used all the agile phrases correctly.";
                feedbackEl.className = 'mt-4 text-sm font-medium text-green-400';
                updateScore(30, 'Conversation correct!', 'correct');
                conversationDone = true;
                updateProgress();
            } else {
                feedbackEl.textContent = "Some answers are incorrect. Take another shot!";
                feedbackEl.className = 'mt-4 text-sm font-medium text-red-400';
                updateScore(-15, 'Conversation incorrect.', 'incorrect');
                setTimeout(() => {
                    setupConversationBlanks();
                }, 2000);
            }
        }
        
        // Initialize all activities on window load
        window.onload = function() {
            setupTerms();
            setupConversationBlanks();
        };

    </script>
</body>
</html>
