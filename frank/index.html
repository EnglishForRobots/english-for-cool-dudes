
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="apple-touch-icon" href="/images/icon-180.png" sizes="180x180">
    <link rel="icon" type="image/png" href="/images/icon-192.png" sizes="192x192">
    <link rel="manifest" href="/manifest.json">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Creation's Ruin - Advanced English Lesson (C1/C2)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Metal+Mania&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- BRANDING & LAYOUT STYLES (Ghostly Purple/Orange Scheme) --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: #F8F9FB; /* Light background */
            color: #2C3E50;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* Define the Theme Colors (Ghostly Purple/Orange Scheme) */
        :root {
            --color-primary-theme: #8E44AD; /* Deep Purple for Main Theme */
            --color-secondary-dark: #2C3E50; /* Dark Blue/Grey for contrast */
            --color-light-theme: #F4ECF7; /* Very Light Purple for backgrounds */
            --color-dark-accent: #E67E22; /* Halloween Orange for Border/Accent */
            --color-light-red: #FADBD8; 
            --color-dark-red: #721C24; 
            --color-default-bg: #FFFFFF;
            --color-panel-bg: #F8F9FB;
            --color-green-correct: #27AE60;
        }

        /* Header (Global Nav Bar) */
        .header {
            background: var(--color-default-bg);
            border-bottom: 1px solid #E5E9F2;
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.04);
        }
        .header-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-link {
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            color: #2C3E50;
        }
        .logo {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--color-primary-theme) 0%, #76418E 100%); 
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        .site-title {
            font-size: 20px;
            font-weight: 800;
            color: #1A202C;
            letter-spacing: -0.02em;
        }


        /* Main Container for Lesson */
        .container-main {
            max-width: 1000px; 
            margin: 30px auto;
            padding: 30px 20px;
            background-color: var(--color-default-bg);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid #E5E9F2;
        }

        /* Lesson Specific Styles */
        .lesson-main-title {
            font-size: 2.5em;
            font-weight: 800;
            color: var(--color-dark-accent); /* Use Orange for Halloween Title */
            margin-bottom: 10px;
            letter-spacing: -0.02em;
        }

        .lesson-section {
            background-color: var(--color-panel-bg); 
            padding: 30px;
            border-radius: 10px;
            border: 1px solid #E5E9F2;
        }

        .section-title {
            color: var(--color-primary-theme);
            font-size: 1.8em;
            font-weight: 800;
            margin-bottom: 20px;
            padding-bottom: 5px;
            border-bottom: 2px dashed #E5E9F2;
        }
        
        /* --- GOTHIC FONT FOR READING EXCERPT (New Addition) --- */
        .gothic-excerpt {
            font-family: 'Metal Mania', cursive; 
            line-height: 2.2; /* A bit more line-height for better readability with this font */
            font-size: 1.2rem !important;
            font-weight: 500;
        }
        .gothic-excerpt .dict-word {
            font-weight: 700 !important; 
        }
        
        /* Dictionary Styling (Intermediate/Advanced Feature) */
        .dict-word {
            color: var(--color-primary-theme); 
            font-weight: 700;
            text-decoration: underline dashed;
            cursor: pointer;
            position: relative;
        }

        .dict-popup {
            position: absolute;
            z-index: 50;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            padding: 15px;
            background: var(--color-secondary-dark); 
            color: #F8F9FB;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: none;
            text-align: left;
            font-size: 0.9em;
            border: 3px solid var(--color-dark-accent);
        }
        .dict-popup::before {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            margin-left: -10px;
            border-width: 10px;
            border-style: solid;
            border-color: transparent transparent var(--color-dark-accent) transparent;
        }

        /* Grammar Explanation Styles */
        .grammar-box {
            background-color: #f7f3fb; /* Lighter Purple */
            border-left: 5px solid var(--color-primary-theme);
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 5px;
        }
        .grammar-box h4 {
            color: var(--color-secondary-dark);
            font-size: 1.1em;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .grammar-box p, .grammar-box ul {
            font-size: 0.95em;
            margin-bottom: 5px;
        }
        
        /* --- INTERACTIVE ELEMENT STYLES (Match Cards, Buttons, Gap Fill) --- */
        
        /* Match Card Styles - Adjusted for Theme */
        .match-card {
            border: 2px solid transparent; 
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
            border-radius: 0.75rem; 
            padding: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            font-weight: 600;
        }

        /* Group 1: Terms - PURPLE BORDER */
        .match-card.term {
            background-color: var(--color-light-theme); 
            font-size: 1.125rem;
            border: 2px solid var(--color-primary-theme); 
            text-align: center;
        }
        .match-card.term:hover {
             border-color: var(--color-secondary-dark);
        }

        /* Group 2: Definitions/Explanation - ORANGE BORDER */
        .match-card.definition {
            background-color: #F8F9FB; 
            text-align: left;
            border: 2px solid var(--color-dark-accent); 
        }
        .match-card.definition:hover {
             border-color: var(--color-primary-theme);
        }

        /* Selection State (Same for both groups) */
        .match-card.selected {
            border-color: var(--color-secondary-dark);
            background-color: var(--color-light-theme); 
            box-shadow: 0 0 0 4px var(--color-secondary-dark);
        }

        /* Matched State */
        .match-card.matched {
            pointer-events: none;
            opacity: 1; 
            transform: none;
        }
        /* Custom colors for matched items */
        .match-card.matched-color-A { background-color: #E8F5E9 !important; border-color: #27AE60 !important; box-shadow: 0 0 0 4px #27AE60 !important; } /* Green */
        .match-card.matched-color-B { background-color: #FFF3E0 !important; border-color: #FF9800 !important; box-shadow: 0 0 0 4px #FF9800 !important; } /* Orange */
        .match-card.matched-color-C { background-color: #F4ECF7 !important; border-color: #8E44AD !important; box-shadow: 0 0 0 4px #8E44AD !important; } /* Purple */
        .match-card.matched-color-D { background-color: #D4E6F1 !important; border-color: #3498DB !important; box-shadow: 0 0 0 4px #3498DB !important; } /* Light Blue */ 
        .match-card.matched-color-F { background-color: #FFFDE7 !important; border-color: #FFEB3B !important; box-shadow: 0 0 0 4px #FFEB3B !important; } /* Yellow */
        
        /* Multiple Choice Styles */
        .comp-btn-group .option-button {
            transition: all 0.2s;
            background-color: var(--color-default-bg);
            color: #2C3E50;
            font-weight: 600;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid #AAB8C2;
            text-align: left;
            width: 100%;
            cursor: pointer;
        }
        .comp-btn-group .option-button.selected { 
            background-color: var(--color-light-theme);
            color: #1A202C !important; 
            border-color: var(--color-primary-theme);
            box-shadow: 0 0 0 4px var(--color-primary-theme); 
        }
        .comp-btn-group.checked .option-button {
            pointer-events: none; 
        }
        .comp-btn-group .option-button.correct { background-color: var(--color-green-correct) !important; color: white !important; border-color: var(--color-green-correct) !important; box-shadow: 0 0 0 4px var(--color-green-correct) !important; }
        .comp-btn-group .option-button.incorrect { background-color: #E74C3C !important; color: white !important; border-color: #E74C3C !important; box-shadow: 0 0 0 4px #E74C3C !important; }

        /* Gap-Fill specific styles */
        .word-bank { background: var(--color-light-theme); border: 2px solid var(--color-primary-theme); border-radius: 10px; }
        .word-options { display: flex; flex-wrap: wrap; gap: 10px; }
        .word-option { background-color: var(--color-primary-theme); color: white; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: 600; }
        .word-option.selected { background-color: var(--color-dark-accent) !important; transform: scale(1.05); box-shadow: 0 0 0 4px var(--color-dark-accent) !important; }
        .word-option.used { opacity: 0.4; pointer-events: none; background-color: #AAB8C2; transform: none; }
        .gap-fill-text { line-height: 2.5; padding: 20px 0; }
        .gap-input {
            display: inline-block; text-align: center; padding: 6px 10px; min-width: 150px; height: 38px;
            background-color: #E5E9F2; border: 1px dashed var(--color-secondary-dark); border-radius: 4px;
            color: #2C3E50; font-style: italic; cursor: pointer; line-height: 24px; vertical-align: middle;
            font-weight: 600; margin: 0 4px; transition: all 0.2s ease;
        }
        .gap-input.correct { background-color: #D4EDDA !important; border-color: var(--color-green-correct) !important; color: #155724 !important; font-style: normal; }
        .gap-input.incorrect { background-color: var(--color-light-red) !important; border-color: #E74C3C !important; color: var(--color-dark-red) !important; font-style: normal; }
        
        /* General & Pop-up Styles */
        .result-message { margin-top: 15px; padding: 15px; border-radius: 8px; font-weight: 700; display: none; text-align: center; }
        .result-message.correct { background-color: #D4EDDA; color: #155724; }
        .result-message.incorrect { background-color: var(--color-light-red); color: var(--color-dark-red); }
        .check-button { background: var(--color-secondary-dark); color: white; border: none; padding: 12px 25px; border-radius: 9999px; cursor: pointer; font-weight: 700; }
        .fixed-popup {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9);
            padding: 20px 40px; border-radius: 12px; font-size: 1.5em; font-weight: 800; color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); opacity: 0; visibility: hidden; z-index: 1000;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .fixed-popup.show { opacity: 1; visibility: visible; transform: translate(-50%, -50%) scale(1); }
        /* Custom Pop-up Styles */
        .fixed-popup.success { 
            background-color: var(--color-dark-accent); /* Orange/Accent */
            color: white; 
            border: 4px solid #D35400; 
        }
        .fixed-popup.error { 
            background-color: var(--color-primary-theme); /* Purple/Theme */
            color: white; 
            border: 4px solid #7D3C98; 
        }
    </style>
</head>
<body>
    <header class="header">
    <div class="header-wrapper">
        <a href="/advanced/" class="header-link">
            <div class="logo">üßü‚Äç‚ôÇÔ∏è</div> 
            <span class="site-title">English For Cool Dudes</span> 
        </a>
    </div>
</header>
    <div class="container-main">
        <h1 class="lesson-main-title">üß¨ The Creation's Ruin (C1/C2 Advanced Level)</h1>
        <p class="text-lg text-gray-500 mb-8">An advanced lesson exploring Mary Shelley's gothic masterpiece, Frankenstein.</p>

        <main class="space-y-8">
            
            <section id="exercise-2" class="lesson-section shadow-lg">
                <h2 class="section-title">üîÆ 1. Advanced Vocabulary Match</h2>
                <p class="text-gray-600 mb-6">Match the **Low-Frequency Word** from the text (Purple border) to its **Formal Definition** (Orange border). **(Immediate Feedback)**</p>
                <div id="vocab-match-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    </div>
                <div class="button-group mt-6">
                    <button class="check-button reset-button" onclick="resetVocab()">Reset Exercise</button>
                </div>
                <div id="vocab-result" class="result-message"></div>
            </section>
            
            <section id="exercise-1-bio" class="lesson-section shadow-lg">
                <h2 class="section-title">üßü‚Äç‚ôÇÔ∏è 2. Cultural Context: Mary Shelley's Frankenstein</h2>
                <div class="p-4 border border-gray-300 rounded-lg bg-white text-gray-700">
                    <p class="mb-3">Mary Shelley began writing Frankenstein in 1816 when she was just 18 years old. The novel was published anonymously in 1818.</p>
                    <p class="mb-3">Cultural Importance: The book is considered the birth of the Science Fiction genre. It explores profound cultural questions about scientific hubris, moral responsibility, and the consequences of unchecked ambition. Its influence on literature, film, and popular culture is immense, making it a foundational text for any serious student of English.</p>
                </div>
            </section>

            <section id="exercise-3-reading" class="lesson-section shadow-lg">
                <h2 class="section-title">üìú 3. Reading: The Moment of Creation</h2>
                <p class="text-gray-600 mb-6">Read the authentic excerpt. Click the underlined words to view their formal definitions.</p>
                <div class="gothic-excerpt text-lg text-gray-700 leading-relaxed italic border-l-4 border-gray-400 pl-4 py-2">
                    <p>
                        I - It was on a <span class="dict-word" data-definition="Gloomy, dismal, or depressing; causing strong feelings of sadness or foreboding. (German: D√ºster / Trostlos)">dreary</span> night of November that I beheld the <span class="dict-word" data-definition="The act of finishing or achieving something that was worked towards.">accomplishment</span> of my toils. With an anxiety that almost amounted to <span class="dict-word" data-definition="Extreme physical or mental suffering.">agony</span>, I collected the instruments of life around me, that I might <span class="dict-word" data-definition="To instill (a quality) in someone or something; to inject a spark of being.">infuse</span> a spark of being into the lifeless thing that lay at my feet. It was already one in the morning; the rain <span class="dict-word" data-definition="To strike with a rapid succession of light blows, typically producing a light, soft, continuous sound.">pattered</span> dismally against the panes, and my candle was nearly burnt out, when, by the glimmer of the half-extinguished light, I saw the dull yellow eye of the creature open; it breathed hard, and a convulsive motion <span class="dict-word" data-definition="To make someone feel troubled or nervous, often with sudden movements.">agitated</span> its limbs.
                        <br><br>
                        II - How can I describe my emotions at this <span class="dict-word" data-definition="An event causing great and often sudden damage or suffering; a disaster.">catastrophe</span>, or how <span class="dict-word" data-definition="To describe or portray (something) precisely and in detail.">delineate</span> the <span class="dict-word" data-definition="An unfortunate or unhappy person (used dramatically or rhetorically).">wretch</span> whom with such infinite pains and care I had endeavoured to form? His yellow skin scarcely covered the work of muscles and arteries beneath; his hair was of a lustrous black, and flowing; his teeth were of a pearly whiteness; but these luxuries only formed a more horrid contrast with his watery eyes, that seemed almost of the same <span class="dict-word" data-definition="A colour or shade. (A formal word for colour/tone, often used poetically).">hue</span> as the dull white sockets in which they were set, his <span class="dict-word" data-definition="Wrinkled and contracted, especially due to cold or age.">shrivelled</span> complexion and straight black lips.
                        <br><br>
                        III - The different accidents of life are not so changeable as the feelings of human nature. I had worked hard for nearly two years, for the sole purpose of <span class="dict-word" data-definition="To put a liquid into something or soak it in a liquid; to instill.">infusing</span> life into an <span class="dict-word" data-definition="Not alive; showing no sign of life.">inanimate</span> body. For this I had deprived myself of rest and health. I had desired it with an <span class="dict-word" data-definition="Great enthusiasm or passion.">ardour</span> that far exceeded moderation; but now that I had finished, the beauty of the dream <span class="dict-word" data-definition="Disappeared suddenly and completely.">vanished</span>, and breathless horror and <span class="dict-word" data-definition="A feeling of revulsion or strong disapproval aroused by something unpleasant or offensive. (German: Ekel)">disgust</span> filled my heart. Unable to <span class="dict-word" data-definition="To suffer (something painful or difficult) patiently.">endure</span> the <span class="dict-word" data-definition="A particular appearance or quality; the visual appearance of something.">aspect</span> of the being I had created, I rushed out of the room and continued a long time <span class="dict-word" data-definition="Moving across or passing over (literally or figuratively).">traversing</span> my bedchamber, unable to compose my mind to sleep.
                    </p>
                </div>
            </section> 

            <section id="exercise-4-comprehension" class="lesson-section shadow-lg">
                <h2 class="section-title">üí° 4. Reading Comprehension (Inference)</h2>
                <p class="text-gray-600 mb-6">Choose the most appropriate inference based on the passage. **(Immediate Feedback)**</p>

                <div class="question" data-question="1">
                    <p class="font-semibold text-lg text-gray-800 mb-3">1. The phrase "the rain pattered dismally against the panes" (Paragraph 1) primarily serves to:</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="1" data-exercise="comprehension">
                        <li class="option-button" data-correct="false">A. Contrast the peaceful external atmosphere with Frankenstein's inner anxiety.</li>
                        <li class="option-button" data-correct="true">B. Reinforce the unsettling, depressing, and Gothic mood of the creation scene.</li>
                        <li class="option-button" data-correct="false">C. Provide a scientific observation that grounds the fantastical event in reality.</li>
                        <li class="option-button" data-correct="false">D. Suggest that the creature is afraid of water.</li>
                    </ul>
                </div>
                
                <div class="question" data-question="2">
                    <p class="font-semibold text-lg text-gray-800 mb-3">2. The "horrid contrast" described in Paragraph 2 is created by:</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="2" data-exercise="comprehension">
                        <li class="option-button" data-correct="true">A. The juxtaposition of the creature's few beautiful features (hair, teeth) with its overwhelmingly repulsive features (eyes, skin).</li>
                        <li class="option-button" data-correct="false">B. The difference in size between the creature's limbs and its yellow eyes.</li>
                        <li class="option-button" data-correct="false">C. The conflict between Victor's initial desire and his subsequent flight.</li>
                        <li class="option-button" data-correct="false">D. The comparison between the creature and the inanimate materials used to create it.</li>
                    </ul>
                </div>
                
                <div class="question" data-question="3">
                    <p class="font-semibold text-lg text-gray-800 mb-3">3. Victor's emotional shift from "ardour" to "breathless horror and disgust" (Paragraph 3) is best described as:</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="3" data-exercise="comprehension">
                        <li class="option-button" data-correct="false">A. A gradual disappointment that the creature did not immediately speak.</li>
                        <li class="option-button" data-correct="false">B. A rational decision based on the creature's immediate aggressive actions.</li>
                        <li class="option-button" data-correct="true">C. A sudden and total psychological rejection of the being he had obsessively worked for two years to create.</li>
                        <li class="option-button" data-correct="false">D. The expected consequence of two years of sleep deprivation and poor health.</li>
                    </ul>
                </div>
                
                <div class="question" data-question="4">
                    <p class="font-semibold text-lg text-gray-800 mb-3">4. The line "The different accidents of life are not so changeable as the feelings of human nature" (Paragraph 3) functions as:</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="4" data-exercise="comprehension">
                        <li class="option-button" data-correct="false">A. A statement meant to reassure the reader that Victor will soon feel pride again.</li>
                        <li class="option-button" data-correct="false">B. A literary apology to the reader for Victor's sudden and illogical behaviour.</li>
                        <li class="option-button" data-correct="false">C. A scientific maxim that explains the biological process of creating life.</li>
                        <li class="option-button" data-correct="true">D. A thematic generalization about the inherent volatility and rapid changes in human emotional states.</li>
                    </ul>
                </div>

                <div id="comprehension-result" class="result-message"></div>
            </section>
            
            <section id="exercise-5-gapfill" class="lesson-section shadow-lg">
                <h2 class="section-title">üîó 5. C1/C2 Word Formation</h2>
                <p class="text-gray-600 mb-6">Use the correct word (derived from a word in the text) to fill the gaps in the sentences below. (Check at the end)</p>
                
                <div class="word-bank p-4 mb-6">
                    <h4 class="font-bold text-gray-700 mb-3">Word Bank:</h4>
                    <div class="word-options" id="vocab-gap-options">
                        <span class="word-option" id="vword-1" data-word-answer="INANIMATE">INANIMATE</span>
                        <span class="word-option" id="vword-2" data-word-answer="ENDURANCE">ENDURANCE</span>
                        <span class="word-option" id="vword-3" data-word-answer="DISGUSTING">DISGUSTING</span>
                        <span class="word-option" id="vword-4" data-word-answer="ACCOMPLISHMENT">ACCOMPLISHMENT</span>
                        <span class="word-option" id="vword-5" data-word-answer="INFUSION">INFUSION</span>
                    </div>
                </div>
                
                <div class="gap-fill-text text-lg text-gray-700">
                    <p>1. Bringing the long-term project to completion felt like a monumental <span class="gap-input" data-index="0" data-exercise="vocab" data-correct="ACCOMPLISHMENT" title=""></span>.</p>
                    <p>2. The terrible smell of the laboratory was genuinely <span class="gap-input" data-index="1" data-exercise="vocab" data-correct="DISGUSTING" title=""></span>.</p>
                    <p>3. Victor lacked the emotional <span class="gap-input" data-index="2" data-exercise="vocab" data-correct="ENDURANCE" title=""></span> required to face the consequences of his actions.</p>
                    <p>4. The doctor hoped a massive <span class="gap-input" data-index="3" data-exercise="vocab" data-correct="INFUSION" title=""></span> of energy would revive the body.</p>
                    <p>5. He had created something both living and yet horrifyingly <span class="gap-input" data-index="4" data-exercise="vocab" data-correct="INANIMATE" title=""></span> at the same time.</p>
                </div>
                
                <div class="button-group">
                    <button class="check-button" onclick="checkGaps('vocab')">Check Answers</button>
                    <button class="check-button reset-button" onclick="resetGaps('vocab')">Reset Exercise</button>
                </div>
                <div id="vocab-gap-result" class="result-message"></div>
            </section>
            
            <section id="exercise-6-grammar" class="lesson-section shadow-lg">
                <h2 class="section-title">‚öôÔ∏è 6. Advanced Grammar: Negative Conditionals and Inversion</h2>
                
                <div class="grammar-box">
                    <h4>Grammar Point: Formal Inversion</h4>
                    <p>In formal English (C1/C2), especially in writing, we use Inversion when a sentence begins with a negative or restrictive adverbial (like *No sooner*, *Hardly*, or *Only when*). The structure is similar to a question:</p>
                    <p>
                        **Adverbial** + **Auxiliary Verb** + **Subject** + **Main Verb**
                    </p>
                    <p>Example: No sooner + had + I + finished the dream **than** it vanished.</p>
                    
                    <h4>Grammar Point: Negative Conditionals (Omission of 'If')</h4>
                    <p>To make a third or mixed conditional sentence more formal, we can remove the word 'if' and use Inversion on the verb 'had' or 'were'.</p>
                    <p>Example: **Had** the creature **not been** so hideous, Victor would not have fled. (Formal for: *If the creature had not been so hideous...*)</p>
                </div>
                
                <p class="text-gray-600 mb-6">Choose the grammatically correct, most formal or stylistically advanced inversion structure. **(Immediate Feedback)**</p>

                <div class="question" data-question="1">
                    <p class="font-semibold text-lg text-gray-800 mb-3">1. (Inversion with 'No sooner') - Choose the correct formal structure.</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="1" data-exercise="grammar">
                        <li class="option-button" data-correct="false">No sooner he had completed the work than he fled the room.</li>
                        <li class="option-button" data-correct="false">No sooner he completed the work, then he fled the room.</li>
                        <li class="option-button" data-correct="true">No sooner had he completed the work than he fled the room.</li>
                    </ul>
                </div>

                <div class="question" data-question="2">
                    <p class="font-semibold text-lg text-gray-800 mb-3">2. (Negative Conditional Inversion) - This is an alternative to 'If the obsession had not been so strong...'</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="2" data-exercise="grammar">
                        <li class="option-button" data-correct="false">If obsession was not so strong, he would not have finished.</li>
                        <li class="option-button" data-correct="true">Had the obsession not been so strong, he would not have finished his toil.</li>
                        <li class="option-button" data-correct="false">The obsession had not been so strong, he would not finish.</li>
                    </ul>
                </div>

                <div class="question" data-question="3">
                    <p class="font-semibold text-lg text-gray-800 mb-3">3. (Fronting Adverbial Phrase) - The error was only clear *after* the eyes opened.</p>
                    <ul class="options-list space-y-3 comp-btn-group" data-question="3" data-exercise="grammar">
                        <li class="option-button" data-correct="true">Only when the eyes opened did Victor realize his error.</li>
                        <li class="option-button" data-correct="false">Only when the eyes opened, Victor realized his error.</li>
                        <li class="option-button" data-correct="false">Victor only realized his error when did the eyes open.</li>
                    </ul>
                </div>

                <div id="grammar-result" class="result-message"></div>
            </section>

            <section id="exercise-7-discussion" class="lesson-section">
                <h2 class="section-title">üó£Ô∏è 7. Discuss and Synthesise</h2>
                <p class="mb-4 text-lg font-semibold text-gray-800">Use this final question for speaking or high-level written practice, applying the vocabulary and grammar learned:</p>
                <div class="p-4 border border-gray-300 rounded-lg bg-white">
                    <p class="mb-2">üßü‚Äç‚ôÇÔ∏è **Thematic Analysis:** The passage describes Victor's desire for his creation with an "ardour that far exceeded moderation." Discuss the relationship between **intellectual obsession** and **moral responsibility**. What does Victor's immediate flight suggest about his fitness to handle the "accomplishment" of his toils?</p>
                </div>
            </section>

        </main>
    </div>
    
    <div id="feedback-popup" class="fixed-popup"></div>
    <div id="dictionary-popup" class="dict-popup"></div>

    <script>
        // --- DATA FOR ALL EXERCISES (C1/C2 LEVEL) --- 
        const vocabPairs = [
            { term: 'Agony', definition: 'Extreme physical or mental suffering.' },
            { term: 'Infuse', definition: 'To instill (a quality) in someone; to inject a spark of being.' },
            { term: 'Delineate', definition: 'To describe or portray (something) precisely.' },
            { term: 'Wretch', definition: 'An unfortunate or unhappy person (often used dramatically).' },
            { term: 'Ardour', definition: 'Great enthusiasm or passion.' },
            { term: 'Traversing', definition: 'Moving across or passing over.' },
        ];
        
        // Match color classes (reused from template)
        const colorClasses = [
            'matched-color-A', 'matched-color-B', 'matched-color-C', 
            'matched-color-D', 'matched-color-F', 'matched-color-A'
        ];

        // Global state for Match Exercise
        let selectedVocabTerm = null;
        let selectedVocabDefinition = null;
        let matchedVocabPairs = 0;
        
        // Global state for Gap Fill Exercise
        let selectedGapWord = null;

        // --- UTILITY (Reused) --- 
        function shuffleArray(array) { 
            for (let i = array.length - 1; i > 0; i--) { 
                const j = Math.floor(Math.random() * (i + 1)); 
                [array[i], array[j]] = [array[j], array[i]]; 
            } 
        } 

        // --- FEEDBACK POPUP FUNCTIONS ---
        function showFeedback(message, type) {
            const popup = document.getElementById('feedback-popup');
            popup.textContent = message;
            popup.className = `fixed-popup show ${type}`;
            setTimeout(() => {
                popup.classList.remove('show');
            }, 1500);
        }

        function showCustomFeedback(isCorrect) {
            if (isCorrect) {
                showFeedback('üßü‚Äç‚ôÇÔ∏è You're Alive, You're Alive! Correct.‚úÖ', 'success');
            } else {
                showFeedback('‚ö∞Ô∏è Monster Error. Incorrect.‚ùå', 'error');
            }
        }
        
        // --- EXERCISE 1: MATCH FUNCTIONS (Immediate Check) --- 
        function createMatchCards(pairs, containerId, type) { 
            const container = document.getElementById(containerId); 
            container.innerHTML = ''; 
            const cards = []; 
            pairs.forEach((pair, index) => { 
                const color = colorClasses[index % colorClasses.length]; 
                cards.push({ text: pair.term, type: 'term', index: index, color: color, exercise: type }); 
                cards.push({ text: pair.definition, type: 'definition', index: index, color: color, exercise: type }); 
            }); 
            shuffleArray(cards); 
            cards.forEach(cardData => { 
                const card = document.createElement('div'); 
                card.textContent = cardData.text; 
                card.className = `match-card ${cardData.type} p-4 rounded-lg shadow-md transition-all duration-200`; 
                card.dataset.index = cardData.index; 
                card.dataset.type = cardData.type; 
                card.dataset.color = cardData.color; 
                card.dataset.exercise = cardData.exercise; 
                card.addEventListener('click', handleMatchClick); 
                container.appendChild(card); 
            }); 
            container.className = 'grid grid-cols-1 md:grid-cols-2 gap-4'; 
        } 

        function handleMatchClick(event) { 
            const clickedCard = event.target; 
            const exercise = clickedCard.dataset.exercise; 
            if (clickedCard.classList.contains('matched')) return; 

            const isTerm = clickedCard.dataset.type === 'term'; 
            let term, definition;
            
            // 1. Deselect if clicking the same card 
            if (clickedCard.classList.contains('selected')) { 
                clickedCard.classList.remove('selected'); 
                if (isTerm) {
                    selectedVocabTerm = null;
                } else {
                    selectedVocabDefinition = null;
                }
                return; // Stop here if deselecting
            } 
            
            // 2. Manage selection
            if (isTerm) { 
                if (selectedVocabTerm) selectedVocabTerm.classList.remove('selected');
                selectedVocabTerm = clickedCard;
            } else { 
                if (selectedVocabDefinition) selectedVocabDefinition.classList.remove('selected');
                selectedVocabDefinition = clickedCard;
            } 
            clickedCard.classList.add('selected');

            term = selectedVocabTerm;
            definition = selectedVocabDefinition;

            const pairsData = vocabPairs; 
            const resultDivId = 'vocab-result'; 

            if (term && definition) { 
                const termIndex = term.dataset.index; 
                const definitionIndex = definition.dataset.index; 
                const colorClass = term.dataset.color; 
                
                if (termIndex === definitionIndex) { 
                    // Match found! 
                    matchedVocabPairs++; 
                    showCustomFeedback(true); 
                    [term, definition].forEach(card => { 
                        card.classList.remove('selected'); 
                        card.classList.add('matched', colorClass); 
                        card.removeEventListener('click', handleMatchClick); 
                    }); 
                    
                    // Clear selections 
                    selectedVocabTerm = null; 
                    selectedVocabDefinition = null; 
                    
                    // Check for Completion 
                    const resultDiv = document.getElementById(resultDivId); 
                    if (matchedVocabPairs === pairsData.length) { 
                        resultDiv.textContent = 'üßü‚Äç‚ôÇÔ∏è All pairs mastered! Excellent command of C1/C2 vocabulary!'; 
                        resultDiv.classList.remove('incorrect'); 
                        resultDiv.classList.add('correct'); 
                        resultDiv.style.display = 'block'; 
                    } 
                } else { 
                    // Mismatch found! 
                    showCustomFeedback(false); 
                    
                    // Deselect incorrect cards immediately (User Fix applied) 
                    term.classList.remove('selected'); 
                    definition.classList.remove('selected'); 
                    selectedVocabTerm = null; 
                    selectedVocabDefinition = null; 
                } 
            } 
        } 
        
        function resetVocab() { 
            selectedVocabTerm = null; 
            selectedVocabDefinition = null; 
            matchedVocabPairs = 0; 
            document.getElementById('vocab-result').style.display = 'none'; 
            createMatchCards(vocabPairs, 'vocab-match-container', 'vocab'); 
        } 

        // --- EXERCISE 4 & 6: MULTIPLE CHOICE FUNCTIONS (Immediate Check) --- 
        function checkMultipleChoiceCompletion(exercise) { 
            let resultId, sectionSelector, message; 
            if (exercise === 'grammar') { 
                resultId = 'grammar-result'; 
                sectionSelector = '#exercise-6-grammar'; 
                message = 'üßü‚Äç‚ôÇÔ∏è Grammar Mastery! Flawless use of advanced structures.‚úÖ'; 
            } else if (exercise === 'comprehension') { 
                resultId = 'comprehension-result'; 
                sectionSelector = '#exercise-4-comprehension'; 
                message = 'üßü‚Äç‚ôÇÔ∏è Reading Mastery! Nuance and inference understood.‚úÖ'; 
            } else return; 
            
            const questions = document.querySelectorAll(`${sectionSelector} .question`); 
            let allCompletedAndCorrect = true; 
            let allAnswered = true; 

            questions.forEach(q => { 
                const optionsList = q.querySelector('.options-list'); 
                if (!optionsList.classList.contains('checked')) { 
                    allAnswered = false; 
                } 
                if (optionsList.querySelector('.option-button.incorrect')) {
                    allCompletedAndCorrect = false;
                }
            }); 

            const resultEl = document.getElementById(resultId); 
            if (allCompletedAndCorrect && allAnswered) { 
                resultEl.textContent = message; 
                resultEl.classList.remove('incorrect'); 
                resultEl.classList.add('correct'); 
                resultEl.style.display = 'block'; 
            } else { 
                resultEl.style.display = 'none'; 
            } 
        } 

        function handleMultipleChoiceClick(event) { 
            const clickedOption = event.target; 
            const questionElement = clickedOption.closest('.question'); 
            const optionsList = questionElement.querySelector('.options-list'); 
            const exercise = optionsList.dataset.exercise; 
            if (optionsList.classList.contains('checked')) return; 
            
            optionsList.querySelectorAll('.option-button').forEach(option => { 
                option.classList.remove('selected'); 
            }); 
            clickedOption.classList.add('selected'); 

            const isCorrect = clickedOption.dataset.correct === 'true'; 
            showCustomFeedback(isCorrect); 
            
            if (isCorrect) { 
                clickedOption.classList.add('correct'); 
            } else { 
                clickedOption.classList.add('incorrect'); 
                optionsList.querySelector('[data-correct="true"]').classList.add('correct'); 
            } 
            optionsList.classList.add('checked'); 
            clickedOption.classList.remove('selected'); 
            
            // Check for overall completion 
            checkMultipleChoiceCompletion(exercise); 
        } 
        
        function resetMultipleChoice(exercise) { 
            let sectionId, resultId; 
            if (exercise === 'grammar') { 
                sectionId = 'exercise-6-grammar'; 
                resultId = 'grammar-result'; 
            } else if (exercise === 'comprehension') { 
                sectionId = 'exercise-4-comprehension'; 
                resultId = 'comprehension-result'; 
            } else return; 
            
            document.querySelectorAll(`#${sectionId} .options-list`).forEach(optionsList => { 
                optionsList.classList.remove('checked'); 
                optionsList.querySelectorAll('.option-button').forEach(option => { 
                    option.classList.remove('selected', 'correct', 'incorrect'); 
                }); 
            }); 
            document.getElementById(resultId).style.display = 'none'; 
        } 

        // --- EXERCISE 5: GAP-FILL FUNCTIONS (Retained Check button) --- 
        function handleWordClick(event) { 
            const clickedWord = event.target; 
            if (clickedWord.classList.contains('used')) return; 

            if (clickedWord.classList.contains('selected')) { 
                clickedWord.classList.remove('selected'); 
                selectedGapWord = null; 
            } else { 
                if (selectedGapWord) { 
                    selectedGapWord.classList.remove('selected'); 
                } 
                clickedWord.classList.add('selected'); 
                selectedGapWord = clickedWord; 
            } 
            document.getElementById('vocab-gap-result').style.display = 'none'; 
        } 

        function handleGapClick(event) { 
            const clickedGap = event.target; 
            const exercise = clickedGap.dataset.exercise; 
            
            // 1. Fill the gap
            if (selectedGapWord && clickedGap.textContent.trim() === '') { 
                const wordElementId = selectedGapWord.id; 
                clickedGap.textContent = selectedGapWord.textContent; 
                clickedGap.setAttribute('data-word-id', wordElementId); 
                
                selectedGapWord.classList.add('used'); 
                selectedGapWord.classList.remove('selected'); 
                selectedGapWord = null; 
            } 
            // 2. Clear the gap
            else if (clickedGap.textContent.trim() !== '') { 
                const wordElementId = clickedGap.dataset.wordId; 
                const originalWordElement = document.getElementById(wordElementId); 
                clickedGap.textContent = ''; 
                clickedGap.removeAttribute('data-word-id'); 
                clickedGap.classList.remove('correct', 'incorrect'); 
                if (originalWordElement) { 
                    originalWordElement.classList.remove('used', 'selected'); 
                } 
                selectedGapWord = null; 
            }
            document.getElementById('vocab-gap-result').style.display = 'none'; 
        } 

        function checkGaps(exercise) { 
            if (exercise !== 'vocab') return; 

            const blanks = document.querySelectorAll(`.gap-input[data-exercise="${exercise}"]`); 
            let correctCount = 0; 
            
            blanks.forEach(blank => { 
                const correctWord = blank.dataset.correct; 
                const submittedWord = blank.textContent.trim(); 
                
                blank.classList.remove('correct', 'incorrect'); 
                
                if (submittedWord.toUpperCase() === correctWord.toUpperCase()) { 
                    blank.classList.add('correct'); 
                    correctCount++; 
                } else if (submittedWord !== '') { 
                    blank.classList.add('incorrect'); 
                } 
            }); 

            const resultDiv = document.getElementById(`${exercise}-gap-result`); 
            resultDiv.style.display = 'block'; 
            resultDiv.classList.remove('correct', 'incorrect'); 

            if (correctCount === blanks.length) { 
                resultDiv.textContent = `Excellent! All ${blanks.length} answers are correct!`; 
                resultDiv.classList.add('correct'); 
            } else { 
                resultDiv.textContent = `You got ${correctCount} out of ${blanks.length} correct. Review the highlighted answers.`; 
                resultDiv.classList.add('incorrect'); 
            } 
        } 

        function resetGaps(exercise) { 
            if (exercise !== 'vocab') return; 
            const blanks = document.querySelectorAll(`.gap-input[data-exercise="${exercise}"]`); 
            const words = document.querySelectorAll(`#vocab-gap-options .word-option`); 
            const resultDiv = document.getElementById(`${exercise}-gap-result`); 
            blanks.forEach(blank => { 
                blank.textContent = ''; 
                blank.classList.remove('correct', 'incorrect'); 
                blank.removeAttribute('data-word-id'); 
            }); 
            words.forEach(word => { 
                word.classList.remove('used', 'selected'); 
            }); 
            selectedGapWord = null; 
            resultDiv.style.display = 'none'; 
        } 

        // --- DICTIONARY POPUP FUNCTIONS (C1 Feature) --- 
        let currentDictionaryPopup = null; 
        
        function handleDictWordClick(event) { 
            event.stopPropagation(); 
            // Close existing popup if it's not the one we are about to open 
            if (currentDictionaryPopup && currentDictionaryPopup !== event.target.nextElementSibling) { 
                currentDictionaryPopup.style.display = 'none'; 
            } 
            
            const wordElement = event.target; 
            const definition = wordElement.dataset.definition; 
            const popup = document.getElementById('dictionary-popup'); 
            
            popup.innerHTML = `<strong>${wordElement.textContent}:</strong> ${definition}`; 
            
            const rect = wordElement.getBoundingClientRect(); 
            const containerRect = document.querySelector('.container-main').getBoundingClientRect();
            
            popup.style.top = `${rect.top - containerRect.top + rect.height + 10}px`; 
            popup.style.left = `${rect.left - containerRect.left + rect.width / 2}px`;
            popup.style.display = 'block'; 
            currentDictionaryPopup = popup; 
        } 

        function closeDictionaryPopup(event) { 
            const popup = document.getElementById('dictionary-popup');
            if (popup && popup.style.display === 'block') {
                // Check if the click was inside the popup
                if (!popup.contains(event.target) && !event.target.classList.contains('dict-word')) {
                    popup.style.display = 'none';
                    currentDictionaryPopup = null;
                }
            }
        } 

        function initDictionary() { 
            document.querySelectorAll('.dict-word').forEach(word => { 
                word.removeEventListener('click', handleDictWordClick);
                word.addEventListener('click', handleDictWordClick); 
            }); 
            document.body.removeEventListener('click', closeDictionaryPopup); 
            document.body.addEventListener('click', closeDictionaryPopup); 
        } 

        // Initialise all exercises
        document.addEventListener('DOMContentLoaded', () => {
            // Activity 1 Match
            resetVocab();

            // Activity 4 & 6 Multiple Choice (Checked per click)
            document.querySelectorAll('.comp-btn-group .option-button').forEach(option => {
                option.removeEventListener('click', handleMultipleChoiceClick);
                option.addEventListener('click', handleMultipleChoiceClick);
            });
            resetMultipleChoice('grammar');
            resetMultipleChoice('comprehension');
            
            // Activity 5 Gap Fill 
            document.querySelectorAll('#vocab-gap-options .word-option').forEach(word => {
                word.removeEventListener('click', handleWordClick); 
                word.addEventListener('click', handleWordClick);
            });
            document.querySelectorAll('.gap-input[data-exercise="vocab"]').forEach(gap => {
                gap.removeEventListener('click', handleGapClick);
                gap.addEventListener('click', handleGapClick);
            });
            resetGaps('vocab'); 
            
            // Activity 3 Dictionary
            initDictionary();
        });
    </script>
</body>
</html>
